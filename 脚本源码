Randomize
PutAttachment "","*.luae"
Dim 临时目录=GetTempDir()
TracePrint 临时目录
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次
Import "TURING.luae"
//需要把“识别库UTF8.lib”字库文件添加到附件中
PutAttachment "", "*.lib"
SetScreenScale 1080, 1920, 0
SetControlBarPos 0.3,0,0
dim 包名 = Sys.GetFront()
Dim 宽=GetScreenX()
Dim 高=GetScreenY()
If ReadUIConfig("开日志") = true Then 
    Log.Open
End If
TracePrint 包名
TracePrint 宽,高
//ShowMessage 包名
Dim IntX,IntY


Dim 星期= DateTime.WeekDay()
Dim 轮次,目前账号
轮次=0
Dim 模式=cint(readuiconfig("模式"))
Dim 自动选择模式=readuiconfig("自动选择模式")
Dim 碎石=readuiconfig("碎石")
Dim 嗑药=readuiconfig("嗑药")
Dim 每局时间=cint(readuiconfig("每局时间"))
Dim 自动换岗=readuiconfig("自动换岗")
Dim 开始账号数=cint(readuiconfig("几号"))
Dim 打剿灭=readuiconfig("打剿灭")
Dim 好友页=cint(readuiconfig("好友数"))\4+1
Dim 自公招=ReadUIConfig("自动公招")
Dim 点潜能=ReadUIConfig("点潜能")
Dim 刷保全=ReadUIConfig("刷保全")
Dim 刷联锁=ReadUIConfig("刷联锁竞赛")
Dim 刷肉鸽=ReadUIConfig("刷肉鸽")                                    
Dim 延时=cint(readuiconfig("延时"))
Dim 出击检测=ReadUIConfig("出击检测")
Dim 进第二层=ReadUIConfig("进第二层")
Dim 精二棘刺=ReadUIConfig("精二棘刺")
Dim 第三层boss=ReadUIConfig("第三层boss")
Dim 大锁开局=ReadUIConfig("大锁开局")
Dim 喉舌开局=ReadUIConfig("喉舌开局")
Dim 剧作家开局=ReadUIConfig("剧作家开局")
Dim 攻速开局=ReadUIConfig("攻速开局")

Dim 作业路径=1
Dim 识别方式=cint(readuiconfig("识别方式"))
Dim 肉鸽小队=cint(readuiconfig("肉鸽小队"))
Dim 肉鸽分队=cint(readuiconfig("肉鸽分队"))
Dim 支援处理=cint(readuiconfig("支援处理"))
Dim 肉鸽推图=cint(readuiconfig("肉鸽推图"))
Dim 非战斗选项=cint(readuiconfig("非战斗选项"))
Dim 肉鸽初始队员(2)
Dim 招募棘刺=0
Dim 保全作战

Dim QQ通知=ReadUIConfig("QQ通知")
Dim QQ通知QQ=ReadUIConfig("QQ通知QQ")
Dim QQ通知服务器=cstr(ReadUIConfig("QQ通知服务器"))

Dim 在线下载活动地图数据=ReadUIConfig("在线下载活动地图数据")
Dim 版本号=1

Call 检测更新()

If 肉鸽小队 = 0 Then 
    肉鸽初始队员 = Array("棘刺", "梓兰", "安赛尔")
ElseIf 肉鸽小队 = 1 Then 
    肉鸽初始队员 = Array("泥岩", "华法琳", "红豆")
ElseIf 肉鸽小队 = 2 Then 
    肉鸽初始队员 = Array(2, "梓兰", "安赛尔")
ElseIf 肉鸽小队 = 3 Then 
    肉鸽初始队员 = Array( "令","月见夜", "安赛尔")
End If
Dim 节点=array("BOSS","紧急","不期而遇/古堡馈赠","普通作战","安全的角落","诡异行商")

Dim 图
Dim 识别
Dim 卷2,白票
Dim 等待错误=0
Dim 等待数组=-1
If 自公招 = true Then 
    TracePrint "识别方式",识别方式
    Dim 公招信息
    Dim ret,tags,tag(),t,tag位置()
    Dim ub=0
    识别方式 = 1
    PutAttachment "/sdcard/","tags.txt"
    Dim 保底=Encode.JsonToTable(zm.FileRead ("/sdcard/tags.txt"))
    Dim 标签={"新手","资深干员","高级资深干员","近战位","远程位","近卫干员","狙击干员","重装干员","医疗干员","辅助干员","术师干员","特种干员","先锋干员","控场","爆发","治疗","支援","费用回复","输出","生存","群攻","防护","减速","削弱","快速复活","位移","召唤","支援机械"}
    //        TracePrint UBound(标签)	
End If

Dim 换建造站干员=ReadUIConfig("换建造站干员")
Dim 换贸易站干员=ReadUIConfig("换贸易站干员")
Dim 换发电站干员=ReadUIConfig("换发电站干员")
Dim 换中枢干员=ReadUIConfig("控制中枢")
Dim 自动送线索=ReadUIConfig("自动送线索")
Dim 买信用商店=ReadUIConfig("买信用商店")

Dim 建造站数量
Dim 建造站
//Dim 建造站=3*cint(readuiconfig("建造站楼层"))+cint(readuiconfig("建造站房间号"))
Dim 贸易站数量
Dim 贸易站
//Dim 贸易站=3*cint(readuiconfig("贸易站楼层"))+cint(readuiconfig("贸易站房间号"))
//Dim 剿灭上限=cint(readuiconfig("剿灭上限"))
Dim 剿灭图=cint(readuiconfig("剿灭图"))
Dim 每轮一次=readuiconfig("每轮一次")
Dim 间隔=readuiconfig("间隔")
Dim 间隔时间=int(readuiconfig("间隔时间"))

Dim 主题曲数量=4
Dim 发电站数量
dim 发电站()
Dim 森蚺中枢=false
Dim 夕中枢=false
Dim 迷迭香=false


Dim 开始游戏=array(63,956,"63|956|02D4FA,67|961|02D8FF,74|938|02D8FF","开始游戏")
Dim 登录界面1=array(157,859,"157|859|E9E9E9,46|895|3F3F3F","登录界面1")
Dim 主页=array(1019,50,"1001|75|FFFFFF,658|1406|1F62FE,373|1309|E5BE4A,213|478|414141","主页")
Dim 行动结束=array(558,1771,"308|499|FFF53F,348|1275|0098F2,124|531|FFFFFF","行动结束")
Dim 行动结束2=array(558,1771,"870|1518|FFDE3C,473|1554|0098F2,185|1073|02C8FF","行动结束2")
//Dim 行动结束=array(40,1819,"308|499|FFF53F,124|531|FFFFFF","")
Dim 剿灭结束=array(558,1771,"278|90|FFFFFF,120|530|FFFFFF,340|1267|0032A1","剿灭结束")
Dim 剿灭未打完=array(821,1854,"821|1854|65657F,904|1448|180073,871|1567|362AC8","剿灭未打完")
//Dim 开始1=array(123,1738,"129|1761|D79500,50|1780|232323,55|1428|373737","")
Dim 开始1=array(123,1738,"35|1794|232323,55|1428|323232,98|1856|BB8201","蓝色开始")
dim 开始11=array(132,1706,"132|1706|7B9CB5,99|1607|495A6B,81|1732|C4C4C4","金色开始")
Dim 红色开始=array(122,1741,"122|1741|0046C1,501|1577|0046C1,437|1658|FFFFFF,1020|162|313131","红色开始")
Dim 开始3=array(122,1741,"174|1659|02098D,265|1633|FFFFFF,482|1633|030B4D")
Dim 开始4=array(122,1741,"122|1741|0046C1,501|1557|ABABAE,437|1658|002075,1020|162|313131","红色开始")
Dim 演习开始行动=array(122,1741,"473|1626|6A4907,381|1671|FFFFFF,409|1662|453412","演习开始行动")
Dim 理智用完=array(217,1183,"198|1169|313131,224|1631|313131,539|544|FAFBFB,211|1737|FCFCFC","理智用完")
Dim 源石用完=array(217,1183,"245|1543|02D8FF,613|1465|898989,921|1454|FFFFFF")
Dim 有药=array(217,1625,"887|1056|FFFFFF,232|1631|313131,646|977|E9AB1F","有药")
Dim 换工作=array(321,1364,"338|1263|FFFFFF,338|1384|141477,295|1278|FFFFFF,579|1340|333333","换工作")
Dim 基建=array(1031,1094,"1016|96|313131,769|235|FFFFFF,926|268|FFFFFF,1035|1098|FF92DC","基建",115,1488)
Dim 宿舍进驻=array(1040,1855,"1040|1855|313131,844|1259|FFFFFF,677|173|D5D5D5","宿舍进驻")
Dim 好友界面=array(1031,1094,"839|56|CACACA,882|230|313131,878|1095|2FEEFB,889|390|DC9800","好友界面",221,538)
Dim 升级=array(402,249,"402|249|FFFFFF,645|245|FFFFFF,553|1019|FFFFFF,361|238|131313","升级")
Dim 返回=array(1012,194,"1012|194|313131,1024|405|D8D8D8,1002|551|313131","返回")
Dim 确认使用剿灭券=array(91,1635,"91|1635|FFFFFF,94|1835|AA7809,121|1485|353535","确认使用剿灭券")
Dim 剿灭全权委托=array(189,1364,"190|1368|363636,191|1497|FEC546,186|1401|FFC642","剿灭全权委托")
Dim 剿灭打完=array(614,1419,"614|1419|FFFFFF,508|1399|0154AD,547|238|DC9800","剿灭打完")
Dim 剿灭保存=array(92,1316,"97|958|FFFFFF,84|1234|8A6207,85|1562|705310","剿灭保存")
Dim 剿灭情报=array(208,1852,"860|195|1A1A87,962|1693|FFFFFF,986|1790|E0E0E0","剿灭信息")
Dim 获得物资=array(114,958,"958|961|969796,992|1030|9B9C9C,105|953|76868A,143|968|292929","获得物资")
Dim 开始唤醒=array(58,1389,"49|1307|585858,308|729|E8E8E8,541|1069|181821","开始唤醒")
Dim 账号登录=array(321,773,"313|661|565656,53|1175|3F3F3F,313|842|FFFFFF","账号登录")
Dim 输账号界面=array(210,785,"213|1172|363636,437|1173|3B3B3B,56|1291|7C6024","输账号界面")
Dim 公告=array(994,1858,"994|1858|C8C8C8,893|1846|191919,929|92|070707,252|1852|604D15","公告")
Dim 开采许可=array(248,1581,"241|1609|1D2590,531|1709|C1C2DA,512|365|1F27CC,987|1841|595959","开采许可")
Dim 签到=array(956,1804,"956|1804|595959,103|1776|00B8F4,95|1245|313131,976|98|00B8F4","签到")
Dim 活动签到=array(957,1851,"986|1574|9CD1E0,949|1826|595959,958|993|DFBA60,992|1262|A9B0D8","活动签到")
//Dim 活动收集=array(929,1849,"929|1849|BFBFBF,956|1854|595959,89|1835|242424","活动收集")
Dim 活动收集=array(922,1843,"181|118|000000,196|556|000000,939|1838|C5C5C5,962|1849|595959","横版签到")
Dim 交流结束=array(1014,85,"930|46|0062CE,903|542|0062CE,821|81|FFFFFF","交流结束")
Dim 刷新标签=array(467,1458,"467|1458|DC9800,206|1526|DC9800,349|313|E8E8E8","刷新标签")
Dim 任务界面=array(1020,1022,"1023|401|D8D8D8,1019|82|313131,953|37|FFFFFF,1038|624|FFFFFF","任务界面",166,1136)
Dim 采购中心=array(913,1692,"903|38|01019A,886|264|FFFFFF,927|1415|898989","采购中心",364,1249)
Dim 公开招募=array(911,268,"911|268|0197F2,912|1064|0795F0,963|1281|DC9800,861|226|FFFFFF","公开招募")
Dim 公招界面=array(97,1554,"191|1394|DC9800,848|611|313131,869|486|FFFFFF","公招界面")
Dim 公招skip=array(1028,1833,"1028|1833|FFFFFF,1032|1796|2C2A2A,998|1826|FFFFFF,998|1852|FFFFFF","公招skip")
Dim 领红包=array(956,1849,"956|1849|C1C1C1,969|1846|595959,170|141|4A5DD6","领红包")
//Dim 惊奇墙=array(956,1849,"930|1847|595959,129|1822|4A08F7,333|911|CA1C00","惊奇墙")
Dim 惊奇墙=array(956,1849,"248|230|12BFFC,122|1452|0728C5,171|658|4A5DD6")
Dim 制造站界面=array(760,126,"760|126|00D8FF,1024|604|02D8FF,1042|1669|FFBB22","制造站")
Dim 制造赤金=array(760,126,"611|1670|60BFFF,561|1677|0E1F3D","制造赤金")
Dim 贸易站界面=array(760,126,"760|126|FFB100,1010|601|FFBB22,1042|1669|FFBB22","贸易站")
Dim 会客厅界面=array(760,126,"1025|608|FFFFFF,97|1804|FFFFFF,1042|1669|FFBB22","会客厅")
Dim 退出基建=array(312,1263,"594|1228|F8F8F8,595|959|F9F9F9,314|1474|101073","退出基建")
Dim 十连=array(320,449,"616|750|00CAFD,594|1228|3A32F0,595|959|898989,314|1474|FFFFFF","十连")
Dim 作战界面=array(828,1425,"111|887|AEC7D4,103|556|72653C,88|375|597985,92|79|372F2F","作战选图",828,1425)
Dim 招募作战=array(316,1505,"1864C9","47|-348|25618A,391|-290|FFFFFF")

Dim 等级降序=array(1017,1126,"1013|1267|CC8E06,1003|1280|E9A101") 
Dim 子弹时间=array(1000,1800,"583|31|FF9E02,993|99|8C8C8C,1000|117|242323","子弹时间")
Dim 暂停中=array(1000,1800,"998|1786|F5F5F5,1012|1813|393B3C,998|1798|F5F5F5","暂停中")
Dim 战斗中=array(1000,1800,"998|1786|F5F5F5,1012|1813|F5F5F5","战斗中")
Dim 单倍速=array(1003,1646,"1015|1629|F5F5F5,976|1657|FFFFFF,1026|1624|FDFDFD","单倍速")
Dim 双倍速=array(1003,1646,"1027|1614|FFFFFF,1002|1617|FFFFFF,976|1657|FFFFFF,1026|1624|23262E","双倍速")
Dim 跳过剧情=array(997,1775,"999|1822|FFFFFF,1007|1598|FEFEFE,1008|1631|ADACAC","跳过")
Dim 跳过剧情确定=array(381,1200)
dim 加速波数=0
Dim 技能就绪=array(280,1200,396,1306,"47ECCB","-3|32|47ECCB","技能就绪")
Dim 开始模拟=array(120,887,"120|887|FFFFFF,106|1103|3C34A8,96|822|3E2FA2","开始模拟")


Dim 成功通过=array(282,108,"256|57|FFFFFF,412|47|FFFFFF,203|72|090909","成功通过")
Dim 联系中断=array(153,966,"153|966|C5C5C5,599|866|FFFFFF,706|1438|1C1C58","联系中断")
Dim 战斗奖励=array(465,128,"465|128|3C3C3C,465|545|3B3B3B,428|231|070707","战斗奖励")
Dim 奖励全部领完=array(275,955,"275|955|464646,573|729|515150,594|947|EEEEED","领完奖励")
Dim 肉鸽招募界面=array(72,1642,"76|1657|FFFFFF,55|1657|A87500,81|1412|FFFFFF","肉鸽招募界面")
Dim 肉鸽先锋招募=array(72,1642,"765|556|1E1E19,509|453|FFFFFF,517|1317|FFFFFF","肉鸽招募先锋")
Dim 肉鸽战斗进入=array(388,1704,"406|1702|D6D8D9,309|1615|076890,732|1260|0DB8FF","进入战斗")
Dim 肉鸽非战斗进入=array(388,1704,"388|1704|C0C0B8,312|1606|848300,734|1276|E4E200","进入非战斗")
Dim 肉鸽商店进入=array(388,1704,"410|1701|DFDFDE,305|1616|516508,731|1268|8DB20D","进入商店")
Dim 肉鸽紧急作战进入=array(388,1704,"358|1700|DFE0E1,254|1617|00488B,790|1278|007EF3","进入紧急作战")
Dim 肉鸽boss作战进入=array(388,1704,"857|1242|000817,312|1613|012F90,734|1268|0152FF","进入boss作战")
Dim 肉鸽安全角落进入=array(388,1704,"410|1701|E0DFDE,303|1619|8F6400,735|1277|FFB400","肉鸽安全角落进入")
Dim 存钱按钮=array(723,744,"777|727|AED302,653|662|687722,761|713|AED302","存钱按钮")
Dim 肉鸽开始行动=array(71,1666,"22|1682|0C47C7,76|1594|FFFFFF,125|1537|31343A","肉鸽开始行动")
Dim 肉鸽界面=array(75,1412,"75|1412|CECECE,84|1658|CECECE,1028|1646|ABD400","肉鸽界面")
Dim 肉鸽主页1=array(213,1733,"237|1724|D7D7D7,915|1853|287EBB,1023|652|E1E1E1","肉鸽傀影主页")
Dim 肉鸽返回=array(1019,93,"1025|59|FFFFFF,1022|203|313131,50|1638|A87500,1041|1788|C8C8C8")
Dim 没有生效=array(213,1733,"812|1438|C5C5C5,812|1443|434343,814|1448|C6C6C6,811|1545|C7C7C7,826|1674|444441")
Dim 凋零残响=array(540,1842,"953|271|414244,939|970|15157D,923|793|B2B2B2","凋零残响")
Dim 选择分队=array(194,261,"710|255|ECECEC,986|891|2093CE,416|188|FFFFFF","选择分队")
Dim 选择指挥分队=array(194,261,"175|255|4A7297,428|140|343434,134|106|224B62","指挥分队")
Dim 后勤分队=array(283,1109,"652|1099|FEFEFE,424|1039|FFFFFF,362|1083|343434","后勤分队")
Dim 选择招募组合=array(208,1154,"348|666|353535,987|1055|2093CE,631|1537|E2DECD","选择招募组合")
Dim 初始招募=array(281,384,"281|384|9F967F,987|1185|2093CE,713|954|DED9C3","第一招募")
Dim 第二招募=array(259,853,"374|854|0C0C0C,373|420|FFFFFF,273|819|9F967F","第二招募")
Dim 第三招募=array(254,1319,"374|854|FFFFFF,373|420|FFFFFF,282|1265|9F967F","第三招募")
Dim 进入古堡=array(529,1761,"524|1775|DBDCDC,372|1103|FFFFFF,374|668|FFFFFF,498|1772|0D1215","进入古堡")
Dim 选择支援=array(991,998,"993|998|2093CE,992|937|0B0B0B,348|515|363636","选择支援")
Dim 开始探索=array(242,1733,"237|1724|D7D7D7,1009|1680|C6C6C6,1023|652|E1E1E1","开始探索")
Dim 小队干员=array(90,959,"90|959|5C7286,987|874|2093CE,372|477|FFFFFF","小队干员")
Dim 跳过=array(1026,1840,"1026|1840|C6C6C6,1024|1810|C6C6C6,796|832|7F7F7C","跳过")
Dim 跳过确认=array(348,1267,"348|1267|FFFFFF,330|1264|30308A,801|1064|E5E5E5","跳过确认")

Dim 肉鸽钟=array(422,1615,"254|592|606060,632|1130|B6B6B6,254|1391|606061","新地图")

Dim 鸭爵=array(752,970,"752|970|C1DAB1,676|1169|6068D4,375|1552|000000","鸭爵")
Dim 受缚之血=array(422,1615,"504|867|AEAEC6,767|1010|626A72,804|1232|A1A198","受缚之血")
Dim 密室=array(422,1615,"611|636|C1F5FF,839|1025|D7F7FE,824|879|3F4F68","密室")
Dim 暗门=array(422,1615,"856|1024|C6D0D0,700|890|709099,531|887|0E2E4F","暗门")
Dim 解脱=array(422,1615,"508|745|F7F7F7,664|1223|23334C,305|252|5A6A81","解脱")
Dim 保护玩偶=array(422,1615,"328|182|5A6A81,703|1097|A2BBFF,441|634|6778FF,868|317|FFFFFF","保护玩偶")
Dim 赴宴=array(422,1615,"430|627|2A2A5B,343|196|5A6A81,587|1156|18206A,874|1121|83939C","赴宴")
Dim 暴殄天物=array(422,1615,"937|736|222230,872|726|DCDCFD,316|262|5A6A81","暴殄天物")
Dim 佝偻怪客=array(656,1636,"904|821|4C4444,420|632|35468A,343|178|5A6A81","佝偻怪客")
Dim 微型舞台=array(656,1636,"706|1230|F5FDFD,731|628|1F1F27,309|226|5A6A81","微型舞台")
Dim 珍品处理者=array(656,1636,"831|925|F7C642,623|555|9BCDEF,340|251|5A6A81","珍品处理者")
Dim 复仇剧=array(656,1636,"883|1210|BF5825,377|592|BAC1C9,302|253|5A6A81","复仇剧")
Dim 有关那位乌萨斯人=array(656,1636,"772|1235|9FB0C0,577|920|A9A9A9,343|442|5A6A81","有关那位乌萨斯人")
Dim 被困的人=array(656,1636,"306|197|5A6A81,604|1082|D7DFF8,700|772|191519,955|1081|F5EFF9","被困的人")
Dim 幽影狂言=array(656,1636,"339|256|5A6A81,878|958|2E5FB5,586|549|BAD3F4,407|1010|62A4E5")

Dim 招募助战=Array(306,1188,"303|1190|F9FDFE,707|1213|FFFFFF,531|1367|DC9800","招募助战")
Dim 招募选择=array(337,843,"336|574|9E967F,520|592|3C3C3C,343|1061|9E967F","选择招募")
Dim 选择第二近卫招募=array(325,1152,"788|1244|22221A,549|1130|DDDDDD,866|1232|191919","选择第二近卫招募")
Dim 选择第二狙击招募=array(325,1152,"857|1242|37372F,852|1258|3F3F2E,559|1131|DDDDDD","选择第二狙击招募")
Dim 房间=array(597,95,603,419,607,727,436,31,431,257,427,569,260,93,260,425,271,729)

Dim 先锋=array(868,87,"816|65|157584,899|51|130B08,904|79|E9E8E8,887|111|FFFFFF")
Dim 近卫=array(868,87,"816|65|1D6F76,899|51|FFFFFF,904|79|13120E,887|111|201F1D")
Dim 重装=array(868,87,"816|65|095B69,899|51|FFFFFF,904|79|ADE6F2,887|111|0D5863")
Dim 术士=array(868,87,"816|65|08055B,899|51|FFFFFF,904|79|000000,887|111|010101")
Dim 狙击=array(868,87,"816|65|111268,899|51|0B1317,904|79|F7F7FA,887|111|FFFFFF")
Dim 特种=array(868,87,"816|65|256369,899|51|040C16,904|79|E2F3F4,887|111|05080E")
Dim 医疗=array(868,87,"816|65|8A702C,899|51|241A0A,904|79|FAFAFA,887|111|FFFFFF")
Dim 辅助=array(868,87,"816|65|624900,899|51|AC7214,904|79|6E4D0A,887|111|FFFFFF")
Dim 召唤物=array(868,87,"816|65|646464,899|51|4A4A4A,904|79|010101,887|111|7B7B7B")

Dim 保全未打完=array(782,155,"830|1450|2F7373,893|1499|FFFFFF,866|1460|2A4B4B","保全未打完")
Dim 多伦矿场=array(83,1659,"845|216|FFFFFF,816|362|FFFFFF,990|1509|100C10,407|990|6DADA3")
Dim 格里布矿场=array(83,1659,"853|61|083C87,838|207|FFFFFF,835|546|FFFFFF,54|1081|B3B3B3")
Dim 选择保全=array(782,155,"906|1435|CFCFCF,103|66|315CDA,684|196|111111")
Dim 萝卜矿场=array(83,1659,"822|319|FFFFFF,124|912|9EA7BB,949|1656|FFFFFF")
Dim 斯沃玛加工平台=array(83,1659, "843|203|FEFEFE,130|1530|1166D2,842|475|171717")
Dim 阿卡胡拉丛林=array(83,1659,"843|203|555960,130|1530|1A58BA,842|475|2A2A2E")
Dim 定向导能元件=array(83,1659,"1002|384|313131,1022|297|48487C,109|1596|B7830A,1008|493|AFAFAF,997|569|B4B4B4","定向导能元件")
//Dim 战术装备配备=array(104,1617,"104|1617|C48C0C,994|319|515184,991|417|313131","战术装备配备")
Dim 战术装备配备=array(104,1617,"104|1617|D59101,994|319|505185,991|417|C6C6C6","战术装备配备")
//Dim 阵容确认=array(104,1617,"69|1640|563E00,994|457|313131,93|119|BDBDBD")
Dim 阵容确认=array(104,1617,"1027|415|B8B8B8,1026|530|313131,82|1723|BF8301","阵容确认")
Dim 结算委托=array(1026,1670,"1010|1586|020257,121|1609|055AE2,848|1362|2A61E5","结算委托")
Dim 保全开始行动=array(86,1698,"93|1604|0650C1,1002|1596|DC9800,1006|1574|FFFFFF","保全开始行动")
Dim 保全换牌=array(455,1744,"455|1744|006FF9,402|1690|202020,345|1574|898E95","保全换牌")
//Dim 保全战斗完成=array(464,1545,"246|70|FFFFFF,469|887|2F69ED,785|1555|605D5C","保全战斗完成")
Dim 保全战斗完成=array(464,1545,"246|70|FFFFFF,469|887|2F69ED,714|1585|FFFFFF","保全战斗完成")
//Dim 临时增调=array(302,269,"860|818|111111,901|1853|FFFFFF,78|442|CECECE,916|1649|FFFFFF","临时增调")
dim 临时增调=array(302,269,"826|64|212121,853|802|FFFFFF,862|1692|FFFFFF","临时增调")


Dim 五号矿洞=array(66,1700,"460|200|141414,632|148|08244D,285|1576|376ADF")
Dim 唯利是图=array(66,1700,"460|200|1E1E1E,632|148|FFFFFF,285|1576|3569E1")
Dim 恶势力=array(66,1700,"460|200|F6F6F6,632|148|FCFCFC,621|565|F5F6F5")
Dim 好邻居=array(66,1700,"460|200|101410,632|148|06244B,621|565|494849")
Dim 开工仪式=array(66,1700,"460|200|101410,632|200|FFFFFF,621|565|494849")
Dim 流浪之所=array(66,1700,"460|200|FFFFFF,632|200|FAFAFA,621|565|FEFEFE")
Dim 借道=array(66,1700,"460|200|0E1827,632|200|B9BCC0,621|565|4B4B4B")
Dim 有备而来=array(66,1700,"460|200|111B2A,632|200|0E1827,621|565|525252")
Dim 军容整肃=array(66,1700,"460|200|FFFFFF,632|200|0E1827,621|565|FEFEFE")
Dim 无心插柳=array(66,1700,"440|280|0F0F0F,623|148|0F2B53,621|565|4A4A4A")
Dim 真假难辨=array(66,1700,"460|200|101A28,623|148|0C284F,621|565|515151")
Dim 夜色温柔=array(66,1700,"460|200|EDEDED,623|148|0B264E,621|565|F5F5F5")
Dim 丛林式寒暄=array(66,1700,"460|200|111A28,623|148|0C2750,621|565|515151","丛林式寒暄")
Dim 生物多样性=array(66,1700,"460|200|081221,623|148|09244D,621|565|FFFFFF","生物多样性")

Dim 保全确认结束=array(345,1248,"345|1260|FFFFFF,354|1192|14146A,336|665|161617","保全确认结束")
Dim 保全作战终止1=array(274,724,"710|478|0162F4,662|1124|FEFEFF,200|1500|000000")
Dim 保全作战终止2=array(274,724,"775|126|FFFFFF,940|796|4D4D4D,131|1743|0A50C0")
Dim 保全作战终止3=array(274,724,"710|478|0E0F10,662|1124|FEFEFF")
//Dim 保全作战终止4=array(274,724,"736|129|FFFFFF,250|112|0265F9")
Dim 保全作战终止4=array(274,724,"815|49|FFFFFF,668|55|FFFFFF,124|43|0064FA")
//Dim 酬劳明细=array(440,130,"425|98|00D8FF,444|87|FFFFFF,444|211|00D6FD")
Dim 任务失败=array(249,904,"556|262|FFFFFF,544|352|FFFFFF,512|1164|FFFFFF")
Dim 保全编队=false
////////作业

dim 找不到次数=0
dim 引航者主页=array(753,1742,"753|1742|0B7DD0,250|1682|D7DFE0,1035|173|313131","引航者主页")
dim 引航者选关=array(329,131,"329|131|DB8025,434|139|EAF2F2","引航者选关")
dim 引航者选难度=array(80,150,"884|65|FFFFFF,874|143|FFFFFF,112|1671|DA7228","引航者选难度")
dim 引航者结束=array(985,124,"985|99|FFFFFF,876|84|0098F2","引航者结束")
Dim 引航者开始行动=array(343,1615,"343|1615|FFFFFF,430|1625|674604,281|1618|A89742,232|1640|FFFFFF","引航者开始行动")

Dim 生息演算关闭引导=array(917,189,"917|189|EBEBEB,936|220|2E2E2E,795|585|61D5CC,155|1324|EFEFEF","生息演算关闭引导")
Dim 生息演算开始演算=array(84,1530,"84|1530|FFFFFF,107|1613|49CDCB,81|1807|000000,115|106|FFFFFF","生息演算开始演算")
Dim 生息演算选择干员=array(1035,1672,"1035|1672|C9C9C9,1035|1730|000000,1014|1791|939393,858|1869|FFFFFF","生息演算选择干员")
Dim 生息演算选择干员加号=array(795,700,"795|700|FFFFFF,783|462|404040,719|616|FFFFFF,804|195|535353","生息演算选择干员")
Dim 生息演算确认=array(71,1539,"71|1539|61D5D7,71|1681|FFFFFF,52|1690|5EB5B5,59|1430|333333","生息演算确认")
Dim 生息演算全队补充=array(89,1557,"89|1557|C3C3C3,44|1422|2E9B7D,104|1456|313131","生息演算全队补充")
Dim 生息演算演算开始=array(177,1464,"177|1464|F3F3F3,137|1426|9F9F9F,171|1686|121212","生息演算演算开始")
Dim 生息演算今日日报=array(65,1825,"65|1825|DDDDDD,936|972|BABABA,652|1434|303030","生息演算今日日报")
Dim 生息演算地图=array(980,1800,"71|52|61D5D5,574|49|B5B5B5,999|64|FFFFFF,822|59|C9C9C9","生息演算地图")
Dim 生息演算红勾=array(350,1258,"350|1258|FFFFFF,317|1313|131374","生息演算红勾")
Dim 生息演算紧急事态=array(1023,68,"1023|68|FFFFFF,1000|1763|090AA3","生息演算紧急事态")
Dim 生息演算放弃=array(68,1316,"68|1316|1E1E1E,89|1287|000099","生息演算放弃")
Dim 生息演算奖励=array(153,1716,"159|1722|61D5D7","生息演算奖励")
Dim 生息演算物资=array(917,933,"917|933|818181,845|930|B2B2B2","生息演算物资")


Dim 部署前延时,部署后延时,操作前延时,操作后延时
Dim 行动下标
Dim 剿灭地图组=array("黑夜锦标秀","盘桓蜀道","切尔诺伯格","龙门外环","龙门市区","北原冰封废城","废弃矿区","积水潮窟","小丘郡郊野","大骑士领郊外","长泉镇郊野","多索雷斯换水口","南方监狱","大骑士领郊外","潮没海滨","长泉镇郊野","多索雷斯换水口","南方监狱")
Dim 保全地图组=array("五号矿洞","唯利是图","恶势力","好邻居","开工仪式","流浪之所","借道","有备而来","军容整肃","无心插柳","真假难辨","夜色温柔")
Dim 作业,zuoye,干员验证名单(),干员名单,节点类型,肉鸽战斗结果,干员列表,坐标列表(),职业列表(),费用列表(),干员排位,群组,无限放技能干员()

Dim 已部署干员={"干员名":"坐标"}
Dim 选路位置=0
Dim 到达层数,不花钱
Dim 部署,波数依赖,部署顺序,部署命令数,波数依赖命令数,波数依赖顺序
Dim map(14,9)
Dim map1(14,9)
Dim 肉鸽队员=array("棘刺","安赛尔","梓兰")
//Dim 已编队员=2
Dim 技能未就绪=0
Dim 队员技能={"棘刺":3}
Dim 账号=字符串转数组(ReadUIConfig("账号"),",")

Dim 密码=字符串转数组(ReadUIConfig("密码"),",")



Dim 账号个数=UBound(账号)+1
Dim 密码个数=UBound(密码)+1
TracePrint 账号个数,密码个数
Dim 给(3,20,6)
For j = 0 To 3
    For k = 0 To 好友页
        For i = 0 To 6
            给(j,k,i)=False
        Next
    Next	
Next



TracePrint "开始"

//
//
////////////////
If 自动选择模式 = true Then 
    KeepCapture 
    If 判断(开始1) = true OR 判断(开始11) = true Then 
        模式 = 0
    ElseIf  判断(开始唤醒) = true Then 
        模式 = 1
    ElseIf  判断(肉鸽主页1) = true Then 
        模式 = 3
    ElseIf  判断(主页) = true Then 
        模式 = 4
    End If 
	 
End If





If 模式 = 0  Then 
    ShowMessage "刷当前图"
    If 星期 = 7 Then 
        Delay 1000
        ShowMessage "星期天了,剿灭打完了么"
    End If
    Call 重复战斗()
    Delay 1500
    If 自动换岗 = true Then 
        ShowMessage "自动换岗"
        Call  基建每日()
    End If
    If 自公招 = true Then 
        Call 自动公招()
    End If
    

ElseIf 模式 = 1  Then
    ShowMessage "多账号刷图"
    If 账号个数 <> 密码个数 Then 
        ShowMessage "账号密码数不匹配"
        Delay 3000
        EndScript
    End If
    
    图=定图()
    TracePrint "星期"&星期&"选图"&图
    KeepCapture
    If sys.AppIsFront("com.hypergryph.arknights")=False and 判断(登录界面1)=False Then 
        RunApp "com.hypergryph.arknights"
        Delay 20000
        等待 开始游戏, 2000, 60, true
        Delay 10000
        等待 登录界面1,2000, 30, false
    End If

    For aa=开始账号数 to 100
        目前账号 = aa mod 账号个数
        轮次 = aa \ 账号个数
        If DateTime.Hour() = 3 Then 
            For 610
                Delay 6000
            Next            
            aa = 开始账号数
        End If
        图 = 定图()
        Call 登录(目前账号)
        If 自公招 = true Then 
            Call 自动公招()
        End If
        If 点潜能 = true Then 
            Call 自动潜能()
        End If
        If 打剿灭 = true and 轮次 < 3 Then 
            返回主页()
            点击 778, 1474'终端
            Delay 4000
            KeepCapture 
            If 判断(剿灭未打完)=true Then 
                TracePrint "剿灭"
                //                点击 78,1510'每周部署
                //                Delay 1500
                //                //          插入检测合成玉  
                //                点击 284, 454'进入地图
                //                Delay 2500
                //                KeepCapture 
                //                If 判断(剿灭情报) = true Then 
                //                    点击 剿灭情报(0), 剿灭情报(1)
                //                    Delay 2500
                //                End If
                //                Delay 2500
                //                点击 581,968'屏幕中间剿灭
                //                Delay 2500
                点击 854,1684'从终端进入
                If 剿灭图 = 2 Then 
                	
                Else 
                    Delay 2500
                    点击 509, 1236
                    //                    ShowMessage 剿灭图
                    Delay 2000
                    点击 124,1676
                    Delay 1500
                    If 剿灭图 = 1 Then
                        点击 534, 1523
                    ElseIf 剿灭图 = 0 Then
                        点击 671,1466
                    End If
                End if
                Delay 2500
                KeepCapture
                If CmpColor(194, 1601, "191919", 0.9) > -1 Then 
                    点击 194, 1601
                    Delay 1500
                End If               
                Call 重复战斗()
                Delay 1500
                Call 返回主页()                
            End If
            
			
        End If
        
        If 刷联锁 = true Then 
            Call 联锁竞赛()
        End If
        Call 选图(图)
        Call 重复战斗()
        Delay 1500
        If 图 = 41 or 图 = 42 Then 
            点击 1018, 411
            Delay 1000
            点击 719, 133
            Delay 1500
            Call 选图(43)
            Call 重复战斗()
            Delay 1500
        End If
        If 自动换岗 = true Then 
            ShowMessage "基建每日"
            Call  基建每日()		
        End If
        If 刷保全 = true Then 
            保全编队=false
            Call 保全()
        End If
        //        If 刷肉鸽 = true Then 
        //            Call rouge()
        //        End If
        If 间隔 = true Then 
            For 1000
                Delay 间隔时间
            Next
        End If
        Call 切换()
    Next
ElseIf 模式 = 2 Then
    If 账号个数 <> 密码个数 Then 
        ShowMessage "账号密码数不匹配"
        EndScript
    End If
    
    For aa=开始账号数 to 30
        目前账号 = aa mod 账号个数
        
        Call 登录(目前账号)
        
        If 自公招 = true Then 
            Call 自动公招()
        End If
        If 点潜能 = true Then 
            Call 自动潜能()
        End If
        If 刷保全 = true Then 
            保全编队=false
            Call 保全()
        End If
        If 自动换岗 = true Then 
            Call  基建每日()		
        End If
        
        Delay 1500
       

        Call 切换()
    Next
ElseIf 模式 = 3 Then
    //肉鸽(开始探索启动,仅支持1080p)
    ShowMessage "刷肉鸽"
    作业路径 = 0
	
    If Not zm.OcrBaiDuInit(ReadUIConfig("ocrid"),ReadUIConfig("ocrkey"),"https://aip.baidubce.com/rest/2.0/ocr/v1/general") Then
        TracePrint "初始化设置百度云识别失败"
        EndScript
    End If
    PutAttachment 临时目录, "肉鸽商品排序.txt"
    dim 肉鸽商品评分=Encode.JsonToTable(zm.FileRead(临时目录 & "肉鸽商品排序.txt"))
    Dim 第五层暂停=ReadUIConfig("第五层暂停")
    If 宽 <> 1080 or 高 <> 1920 Then 
        ShowMessage "请设置分辨率宽1080,高1920,推荐dpi320,即将关闭脚本",5000,0,0
        Delay 5000
    Else 
        Dim 局数=0
        Dim 进商店次数=0
        Dim 存钱次数=0
        Dim 存钱数=0
        Dim 大锁,喉舌
        Dim tt=TickCount()
        If 肉鸽推图 = 2 Then 
            Do
                Call 肉鸽速刷()
                肉鸽放弃
                肉鸽结果
            Loop
        Else
            Do
                Call 肉鸽()
            Loop
        End If		
    End If    
ElseIf 模式 = 4 Then
    ShowMessage "基建收菜"
    Call 基建每日()
ElseIf 模式 = 5 Then
    Call 自动公招()
    //自动公招(主页启动)
ElseIf 模式 = 6 Then
    Call 公招()
    //自动公招(公招标签页启动)
ElseIf 模式 = 7 Then
    If 宽 <> 1080 or 高 <> 1920 Then 
        ShowMessage "请设置分辨率宽1080,高1920,推荐dpi320,即将关闭脚本",5000,0,0
        Delay 5000
    Else 
    
        Dim 干员提示=ReadUIConfig("干员提示")
        Delay 1500
        Dim 目录=ReadUIConfig("作业路径")
        If Right(目录, 1) <> "/" Then 
            目录=目录&"/"
        End If
        下载地图数据()
        Dim 所有txt=zm.DirScan(目录,"*.txt",1)
        For i= 0 to UBound(所有txt)
            所有txt(i) = UTF8.StrCut(所有txt(i), 1, UTF8.Len(目录))
        Next
        UI.NewLayout ("选择作业")
		
        UI.AddCheckBox "选择作业", "是否自动编队", "自动编队,测试中,不支持群组内干员选择", False
        //		
        UI.Newrow "选择作业","换行1"
		
        UI.AddTextView ("选择作业", "文本1", "选择作业")
        UI.AddSpinner("选择作业","作业列表",所有txt,0)
        UI.Show ("选择作业")
        Dim 是否自动编队=ui.GetValue("是否自动编队")
        Dim 作业名=ui.GetValue("作业列表")
        //		zm.TracePrint 所有txt(作业名["作业列表"])
        //        If 干员提示=true Then 
        //            Dim text="请确定拥有以下干员,没有请将作业内干员替换:\n"
        //            For Each i,j In 所需干员
        //                text=text&i&":"&join(j,",")&"\n"
        //            Next
        //            UI.NewLayout("干员确定")
        //            UI.AddTextView("干员确定","干员名单",text)
        //            UI.Show ("干员确定")
        //            Delay 1500
        //        ElseIf 模式 = 7 and 干员提示 = false Then
        //            Delay 1500
        //        End If
        Call prts(所有txt(作业名["作业列表"]),是否自动编队["是否自动编队"])	
    End If
ElseIf 模式 = 8 Then
    If 宽 <> 1080 or 高 <> 1920 Then 
        ShowMessage "请设置分辨率宽1080,高1920,推荐dpi320,即将关闭脚本",5000,0,0
        Delay 5000
    End If
    /*
    PutAttachment "","*.png"
    UI.NewLayout ("手动编队")
    UI.AddTextView "手动编队", "文本1", "是否手动编队"
    UI.AddSpinner("手动编队","是否手动编队",{"否","是,编好队后退出到主页启动"},0)
    UI.NewRow "手动编队", "换行2"		
    UI.AddTextView "手动编队", "文本2", "自动编队干员"
    UI.NewRow "手动编队", "换行1"
    UI.AddImageView "手动编队", "推荐干员", 临时目录 & "推荐队员.png"
    UI.AddTextView "手动编队", "文本2", "推荐编队干员:\n核心C:泥岩、棘刺、水陈(可用澄闪、异客代替)、红蒂(可用白面、ff0代替)\n先锋推荐:桃金娘、推王、豆苗\n其他位置用二三星低费干员塞满"
    UI.Show ("手动编队")
    Dim 手动编队=ui.GetValue("是否手动编队")
    If 手动编队["是否手动编队"] = 0 Then 
        ShowMessage "请把水陈和红蒂的特别关注取消掉"
        Delay 500
    Else 
        保全编队=true
    End If
    */
    ShowMessage "开始保全派驻,请把剿灭打完",5000,0,0
    Call 保全()
    
ElseIf 模式 = 9 Then
    If 宽 <> 1080 or 高 <> 1920 Then 
        ShowMessage "请设置分辨率宽1080,高1920,推荐dpi320,即将关闭脚本",5000,0,0
        Delay 5000
    End If
    Do
        Call 生息演算()
    Loop
ElseIf 模式 = 10 Then
    Import "Cjson.lua"

    If 宽 <> 1080 or 高 <> 1920 Then 
        ShowMessage "请设置分辨率宽1080,高1920,推荐dpi320,即将关闭脚本",5000,0,0
        Delay 5000
    End If
    找不到次数=0
    Do
        Call 引航者()
    Loop
End If



EndScript







/////////////////////////////////////////////////////
Sub prts(作业名, 需要编队)
    Dim t=TickCount()
    技能未就绪=0
    zuoye = 作业名
    保全作战 = 0
    Dim 职业=array("先锋","近卫","重装","医疗","术士","狙击","特种","辅助","召唤物","all")
    TracePrint "prts作战开始",zuoye
    干员名单 = ""
    TracePrint 作业路径
    zm.TableClear (部署)
    zm.TableClear (已部署干员)
    zm.TableClear (队员技能)
    zm.TableClear (无限放技能干员)
    zm.TableClear(干员验证名单)
    If 作业路径 = 0 Then 
        PutAttachment 临时目录, zuoye&".txt"
        作业 = Encode.JsonToTable(zm.FileRead(临时目录 & zuoye&".txt"))
    ElseIf 作业路径 = 1 Then
        TracePrint "读取作业",zuoye
        作业 = Encode.JsonToTable(zm.FileRead(目录 & zuoye))
    End If   
    TracePrint "读取作业成功"

    Dim 地图=作业["stage_name"]
	
    If isin(作业, "groups") = true and zm.TableIsEmpty(作业["groups"])=false Then    	
        dim text="{"
        For Each i In 作业["groups"]
            text = text & Encode.TableToJson(i["name"]) & ":" & Encode.TableToJson(i["opers"]) & ","
            For Each ii In i["opers"]
                If isIn(ii, "skill_usage") = true and ii["skill_usage"] = 1 Then 
                    无限放技能干员=zm.ArrayInsert(无限放技能干员,ii["name"])
                End If
                If isin(ii, "skill") = true and (ii["skill"] = 2 or ii["skill"] = 3) Then 
                    队员技能[ii["name"]]=ii["skill"]
                End If
            Next
        Next
        text = Left(text, Len(text) - 1) & "}"
        //    	TracePrint text
        群组=encode.JsonToTable(text)    	
    End If
    TracePrint "读取群组成功"
    For Each i In 作业["opers"]    		
        If isIn(i, "skill_usage") = true and i["skill_usage"] = 1 Then 
            无限放技能干员=zm.ArrayInsert(无限放技能干员,i["name"])
        End If
        If isin(i, "skill") = true and (i["skill"] = 2 or i["skill"] = 3) Then 
            队员技能[i["name"]]=i["skill"]
        End If
    Next
    zm.TracePrint 无限放技能干员
    zm.TableClear(行动下标)
    PutAttachment 临时目录, 地图 & ".txt"
    TracePrint 地图
    Dim 地图数据=Encode.JsonToTable(zm.FileRead(临时目录 & 地图&".txt"))
    dim 地图数据0 = 地图数据(0)
    dim 地图数据1= 地图数据(1)
    TracePrint "读取地图数据成功"
    
    Dim c结束,r结束
    Dim 行()
    dim y坐标(13),dy,dx
    r结束=UBound(地图数据0)
    c结束=UBound(地图数据0(0))
    
    For r = 0 To r结束
        行=地图数据0(r)
        For c = 0 To c结束
            map(c,r)=行(c) 
        Next   		
    Next
    For r = 0 To r结束
        行=地图数据1(r)
        For c = 0 To c结束
            map1(c,r)=行(c) 
        Next   		
    Next

    Dim 行动=作业["actions"]
    Dim 操作
	
    For i = 0 To UBOUND(行动)
        操作 = 行动(i)
        //		zm.TracePrint 操作
        If 操作["type"] = "部署" Then 
            If IsNumeric(操作["kills"]) = true Then 
                Exit For
            Else 
                If IsNull(部署) = true Then 
                    部署 = Array(操作)
                    行动下标=array(i)
                Else 
                    部署(UBOUND(部署) + 1) = 操作
                    行动下标(ubound(行动下标)+1)=i
                End If	
            End If
        End If
    Next
    For i = 0 To UBOUND(行动)
        操作 = 行动(i)		
		
        If IsNull(操作["name"]) = false Then 
            If 群组<>null and zm.TableIsEmpty(群组)=false and  isin(群组, 操作["name"]) = true Then 
                For Each item In 群组[操作["name"]]
                    If zm.ArraySearch(职业,item["name"])=-1 Then 
                        干员名单 = 干员名单 & item["name"]
                        zm.ArrayInsert 干员验证名单,item["name"]
                    End if
                Next
            Else 
                If zm.ArraySearch(职业,操作["name"])=-1 Then 
                    干员名单 = 干员名单 & 操作["name"]
                    zm.ArrayInsert 干员验证名单,操作["name"]
                End If
		 		
            End If
			
        End If
    Next
    zm.TracePrint "_643",行动下标
    波数依赖=作业["actions"]
    For i = 0 To UBOUND(行动下标)
        波数依赖=zm.ArrayRemove(波数依赖,行动下标(i)-i) 
    Next
	
	
    //    zm.TracePrint 地图数据
    //    zm.TracePrint 部署
    //    zm.TracePrint 波数依赖
    部署顺序 = 0
    部署命令数 = UBOUND(部署)
    波数依赖顺序 = 0
    波数依赖命令数 = UBOUND(波数依赖)
    TracePrint 部署命令数,波数依赖命令数
    If 需要编队 = true Then 
        TracePrint "开始编队"
        
        Call 自动编队(作业["opers"], 作业["groups"])
        //        EndScript
        
    End If  
    If 波数依赖命令数 > -1 Then 
        For Each i In 波数依赖
            If IsNumeric(i(2)) = false Then 
                干员名单=干员名单&i(2)
            End If        	
        Next
    End If
    干员名单=字符串去重(干员名单)
    TracePrint 干员名单
    //    TracePrint 开始行动样式
    KeepCapture 
    If 判断(保全开始行动) = true Then 
        点击 保全开始行动(0), 保全开始行动(1)
        保全作战 = 1
        //选人	
        dim 换牌数=0
        Do
            KeepCapture 
            If 判断(保全换牌) = true Then 
                干员列表=获取费用列表()
                For Each i In 干员列表
                    If i(0) = "特种" or i(0) = "辅助" or i(0) = "医疗" or i(0) = "召唤物" Then 
                        点击 i(2), i(3)
                        换牌数 = 换牌数 + 1
                        Delay 50
                        If 换牌数 > 3 Then 
                            Exit For
                        End If                        
                    End If
                Next
                点击 428, 1745
                Exit Do
            End If
            Delay 500
        Loop
    Else 
        Dim 开始行动样式=array(红色开始,开始4,开始3,肉鸽开始行动,开始模拟,演习开始行动,引航者开始行动)
        等待 开始行动样式, 1000,3, true
        TracePrint 等待数组    
        Delay 3000
    End If  	
    Do
        KeepCapture 
        If 判断(肉鸽返回) = true Then 
            点击 肉鸽返回(0), 肉鸽返回(1)
        ElseIf 判断(肉鸽开始行动) = true Then 
            点击 肉鸽开始行动(0), 肉鸽开始行动(1)        
        ElseIf 判断(跳过剧情) = true Then
            点击 跳过剧情(0), 跳过剧情(1)
            Delay 1500
            点击 跳过剧情确定(0), 跳过剧情确定(1)
        ElseIf 判断(战斗中) = true Then 
            Exit Do
        End If
        Delay 800
    Loop
    Call 抄作业(作业)    
    Do
        KeepCapture 
        If 判断(跳过剧情) = true Then
            点击 跳过剧情(0), 跳过剧情(1)
            Delay 1500
            点击 跳过剧情确定(0),跳过剧情确定(1)
        ElseIf 判断(战斗中) = false Then 
            Exit Do
        End If
        Delay 5000
    Loop
    Delay 3000
    TracePrint "prts耗时",TickCount()-t
End Sub


Sub 自动编队(干员, 群组)
    //	Dim arr()
    //    Dim 干员目录={"PIONEER":arr,"WARRIOR":arr,"TANK":arr,"SNIPER":arr,"CASTER":arr,"MEDIC":arr,"SUPPORT":arr,"SPECIAL":arr}
    Dim 干员目录()
    Dim 字典
    dim 编入数量=0
    Dim 未编入(),未编入干员()
    Dim 干员类别=array("PIONEER","WARRIOR","TANK","SNIPER","CASTER","MEDIC","SUPPORT","SPECIAL")
    Dim 未编入数量=0
    Dim 类别选择=array(977,1802,"977|1802|1E1D1D,1019|1901|D49E22")
    PutAttachment 临时目录, "character_type_list.txt"
    Dim 干员职业= Encode.JsonToTable(zm.FileRead(临时目录 & "character_type_list.txt"))
    TracePrint "读取干员职业成功"
    For Each i In 干员
        zm.TracePrint i["name"]
        TracePrint 干员职业[i["name"]]
        //		zm.ArrayInsert( 干员目录[干员职业[i["name"]]],i["name"]&i["skill"])
    Next
    点击 1014,1552'快速编队
    
    Delay 1500
    点击 77,770'清空选择
    Delay 1000
    
    KeepCapture 
    If 判断(类别选择) = false Then 
        点击 977, 1802
        Delay 500
    End If
    
    If 判断(等级降序) = false Then 
        点击 等级降序(0), 等级降序(1)
        Delay 500
    End If
    For i = 0 To 7
        字典 = ""
        zm.TableClear(干员目录)
        For Each item In 干员
            If 干员职业[item["name"]] = 干员类别(i) Then 
                字典 = 字典 & item["name"]
                zm.ArrayInsert(干员目录,item["name"]&item["skill"])
            End If

        Next
        TracePrint 字典
        If 字典<>"" Then 
            
            
            KeepCapture 

            点击 899 - i * 121, 1829
            Delay 300
            //            For Each 字符串 In 干员目录[干员类别(i)]
            //                字典 = 字典 & Left(字符串, Len(字符串) - 1)
            //                干员名单= 干员名单 & Left(字符串, Len(字符串) - 1)
            //            Next
            TracePrint "字典",字典
            未编入 = 选择干员(干员目录, "待编队干员",字典,9,4,70)            
            未编入数量 = 未编入数量 + 未编入(0)
            If 未编入数量 = 1 and 未编入干员(1)=null Then 
                TracePrint i,未编入(1)
                未编入干员 = array(i,未编入(1))
            ElseIf 未编入数量 > 1 Then
                TracePrint "缺少干员超过1个"
                EndScript
            End If
            //            Delay 1000
            编入数量 = UBOUND(干员目录) + 1 + 编入数量

        End If
        If i = 7 Then 
            点击 1025,1864'确定
            Delay 1500
            TracePrint "点击全部"
        End If
        TracePrint 编入数量
    Next
    If 编入数量 < 10 Then 
        点击 1022,1676'自定义排序
        Delay 500
        点击 861,1692'信赖
        Delay 500
        点击 861,1692'信赖
        Delay 500
        点击 1038,1861
        Delay 1000
        TracePrint "编入低信赖干员"
        For i = 编入数量 To 9
            点击 754 - (i mod 2) * 421, 740 + (i \ 2) * 217
            Delay 300
        Next
    End If
    点击 79, 1719
    Delay 1500
    zm.TracePrint  未编入干员
    If 未编入数量 >= 1 Then 
        ShowMessage "编队未完成，需要手动编队"
        Delay 1000
        EndScript
    End If
    //	If 未编入数量 = 1 Then 
    //		Call 编入支援干员(未编入干员,1)
    //	End If
	
	
End Sub

Function 保全编队识别(方向,a)
    If a = null Then 
        Call TURING.Lib_Load(临时目录 & "保全队员.lib")
    Else 
        Call TURING.Lib_Load(临时目录 & "保全队员.lib",a)
    End If
	
    If 方向 = "上" Then 
        Call TURING.Pixel_FromScreen(573,578,604,1625)
    Else 
        Call TURING.Pixel_FromScreen(157,578,188,1625)	
    End If	
    Call TURING.Filter_Binaryzation("FBFBFB-303030|F0F0F0-202020")
    Call TURING.Incise_ScopeAisle(10, 6)
    保全编队识别=字符串转数组(TURING.OCR(90,2,10),"|")
End Function

Function 选择干员(干员目录,字典,zidian,横,纵,精度)
    Dim 干员和技能=干员目录
    Dim 部署数=ubound(干员和技能)
    Dim 已部署()
    Dim bushu=-1
    Dim jieguo
    Dim t=TickCount()
    Dim 干员组(),技能组()
    For i = 0 To 部署数
        干员组(i) = Left(干员和技能(i), Len(干员和技能(i)) - 1)
        技能组(i)=cint(right(干员和技能(i),1))
    Next
    zm.TracePrint  "_657",干员组,技能组
    选择干员 = Array(0)	
    For 4
        TracePrint "识别上"
        Call TURING.Pixel_FromScreen(573, 578, 604, 1625)
        If 字典 = "待编队干员" Then 
            Call TURING.Filter_Rotate(270)
        End If
        //        
        Call TURING.Filter_Binaryzation("FBFBFB-303030|F0F0F0-202020")
        Call TURING.Incise_ScopeAisle(横,纵)
        TracePrint TURING.Lib_Load(临时目录 &字典&".lib",zidian) 
        Dim 识别结果 = 字符串转数组(TURING.OCR(精度,2,25),"|") 
        
        //        TracePrint t
        zm.TracePrint 识别结果
        TracePrint "111"
        //        Call 识别待编队干员(zidian)
        For i = 0 To 部署数
            //            TracePrint "需要干员",i,干员组(i)
            If IsNull(已部署(i)) = true Then 
                TracePrint 干员组(i),"未编入"
                For Each 结果 In 识别结果
                    结果=字符串转数组(结果,",") 
                    If 结果(0) = 干员组(i) Then 
                        If 字典 = "待编队干员" Then 
                            点击 CInt(结果(2)) + 573 + 100, CInt(结果(1)) + 578
                        Else 
                            点击 CInt(结果(1)) + 573 + 100, CInt(结果(2)) + 578
                        End If
                        
                        TracePrint 干员组(i),"正在编入,选择",技能组(i),"技能"
                        Delay 500
                        Call 选择技能(技能组(i))
                        Delay 500
                        已部署(i) = 1
                        bushu=bushu+1
                        Exit For
                    End If
                Next
            Else 
                TracePrint 干员组(i),"已编入"
            End If		
        Next
        TracePrint "识别下"
        Call TURING.Pixel_FromScreen(157, 578, 188, 1625)
        If 字典 = "待编队干员" Then 
            Call TURING.Filter_Rotate(270)
        End If
        Call TURING.Filter_Binaryzation("FBFBFB-303030|F0F0F0-202020")
        Call TURING.Incise_ScopeAisle(横,纵)
        识别结果 = 字符串转数组(TURING.OCR(精度, 2,25), "|")
        zm.TracePrint 识别结果
        TracePrint "111"
        For i = 0 To 部署数
            TracePrint "需要干员第",i,干员组(i)
            If IsNull(已部署(i)) = true Then 
                TracePrint 干员组(i),"未编入"
                For Each 结果 In 识别结果
                    结果=字符串转数组(结果,",") 
                    If 结果(0) = 干员组(i) Then 
                        TracePrint "识别到干员",结果(0)
                        //                        TracePrint CInt(结果(1)) + 157, CInt(结果(2)) + 639
                        If 字典 = "待编队干员" Then 
                            点击 CInt(结果(2)) + 157 + 100, CInt(结果(1)) + 578
                        Else 
                            点击 CInt(结果(1)) + 157 + 100, CInt(结果(2)) + 578
                        End If                      
                        TracePrint 干员组(i),"正在编入,选择",技能组(i),"技能"
                        Delay 500
                        Call 选择技能(技能组(i))
                        Delay 500
                        已部署(i) = 1
                        bushu=bushu+1
                        Exit For
                    End If
                Next
            Else 
                TracePrint 干员组(i),"已编入"
            End If
		
        Next
	
	
        If bushu < 部署数 Then 
            TracePrint "下一页搜索"
            TouchDown 593,1304,1
            Delay 200
            TouchMove 593,653, 1, 200
            Delay 100
            TouchMove 593,653, 1, 200
            KeepCapture     
            Delay 500
            TouchUp 1
        Else 
            Exit For
		
        End If
	
    Next
    bushu=0
    for i= 0 to 部署数
        If IsNull(已部署(i)) = true Then     		
            TracePrint "干员",干员组(i),"未部署"
            bushu = bushu + 1
            If bushu = 1 Then 
                选择干员 = Array(bushu, 干员组(i))
            ElseIf bushu > 1 Then
                选择干员 = Array(bushu)
                ShowMessage "2名干员缺失"
                Exit For
            End If
        End If    
    Next    	
End Function

Sub 检测更新()
    dim 更新信息 = URL.Get("https://gitee.com/hwj943680363/Liver-Arknights-Tomorrow/raw/master/version.json")
    dim 更新信息json = Encode.JsonToTable(更新信息)
    Dim 最新版本号=更新信息json["code"]
    TracePrint 最新版本号
    If 版本号 < 最新版本号 Then 
        ShowMessage "已检测到新版", 1000, 0, 0
        zm.OpenURL (更新信息json["Releases_url"])
        EndScript
    Else 
        ShowMessage "已是最新版",1000,0,0
    End If

End Sub

Sub 下载地图数据()
    If 在线下载活动地图数据 = true Then 
        dim 更新信息 = URL.Get("https://gitee.com/hwj943680363/Liver-Arknights-Tomorrow/raw/master/version.json")
        dim 更新信息json = Encode.JsonToTable(更新信息)
        dim 更新地图=zm.Split(更新信息json["map_name"],"|")
        For i = 0 To UBOUND(更新地图)
            zm.HttpDownload "https://gitee.com/hwj943680363/Liver-Arknights-Tomorrow/raw/master/map/"&更新地图(i)&".txt",临时目录&更新地图(i)&".txt"
        Next
        Dim 更新作业=zm.Split(更新信息json["homework_name"],"|")
        TracePrint 目录 
        For i = 0 To UBOUND(更新作业)
            zm.HttpDownload "https://gitee.com/hwj943680363/Liver-Arknights-Tomorrow/raw/master/homework/"&更新作业(i)&".txt",目录&更新作业(i)&".txt"
        Next
    End If
End Sub

Sub 生息演算()
    KeepCapture 
    If 判断(生息演算开始演算) = true Then 
        TracePrint "生息演算界面"
    Else 
        返回主页 
        点击 850, 1650'上活动
        delay(3000)
    End If
    KeepCapture 
    If 判断(生息演算关闭引导 ) = true Then 
        点击 生息演算关闭引导(0),生息演算关闭引导(1)
    End If
    等待 生息演算开始演算, 300, 8, true
    Delay 500
    等待 生息演算选择干员, 1000, 8, true
    KeepCapture 
    If 判断(生息演算选择干员加号) = true Then 
        点击 生息演算选择干员加号(0), 生息演算选择干员加号(1)
        等待 生息演算确认, 300, 8, false
        点击 850, 750
        Delay 500
        等待 生息演算确认, 300, 8,true
    End If
    等待 生息演算全队补充, 300, 8, true
    Delay 2000
    等待 生息演算演算开始, 300, 8, true
    do
        等待 生息演算今日日报, 1000, 10, true
        等待 生息演算地图, 300, 8, false
        KeepCapture 
        If 判断(生息演算紧急事态) = true Then 
            点击 生息演算紧急事态(0), 生息演算紧急事态(1)
            Exit Do
        Else 
            点击 生息演算地图(0),生息演算地图(1)
        End If
        等待 生息演算红勾, 300, 8, true
    Loop
    等待 生息演算放弃, 300, 8, true
    等待 生息演算红勾, 300, 8, true
    等待 生息演算奖励, 300, 8, true
    发送QQ通知 "生息演算结束", true, 300, 1300, 500, 1600
    等待 生息演算奖励, 300, 8, true
    等待 生息演算物资, 300, 8, true
End Sub

Sub 引航者()
    Dim x1,x2,y1,y2
    作业路径=0
    返回主页()
    点击 730, 1650'下活动
    等待 引航者主页, 800, 3, true
    等待 引航者选关, 800, 3, true
    do
        等待 引航者选难度, 800, 5, true
        Delay 1000
        点击 80, 1700
        Delay 1000
        Call prts("困顿囚徒-0", false)
        Delay 10000
        点击 1000, 1650//2倍速
        x1 = 85 + Rnd() * 10
        y1 = 1645 + Rnd() * 10
        x2 = 605 + Rnd() * 10
        y2 = 595 + Rnd() * 10
        Swipe x1, y1, y1, y2
        Delay 1000
        x1 = 95 + Rnd() * 10
        y1 = 1845 + Rnd() * 10
        x2 = 845 + Rnd() * 10
        y2 = 1145 + Rnd() * 10
        Swipe x1, y1, y1, y2
        Delay 10000
        x1 = 95 + Rnd() * 10
        y1 = 1845 + Rnd() * 10
        x2 = 645 + Rnd() * 10
        y2 = 1195 + Rnd() * 10
        Swipe x1, y1, y1, y2
        do
            KeepCapture 
            If 判断(引航者结束) = true Then 
                发送QQ通知 ("引航者结束", true, 200, 200, 500, 450)
                点击 985,124
                Exit Do 
            End If
            Delay 1000
        Loop
    loop
End Sub

Sub 保全()
    do
        作业路径=0
        返回主页()
        点击 778, 1474'终端
        Delay 2500
        Dim 组合
        KeepCapture 
        If 判断(保全未打完) = true Then 
            找不到次数=0
            TracePrint "保全"
            发送QQ通知 ("保全未打完",true,774,1434,920,1876)
            点击 848,1678'进保全
            Delay 3000
            点击 400,750'进阿卡胡拉丛林
            Delay 5000
            KeepCapture 
            If 判断(结算委托) = true Then 
                等待 结算委托,5000,10,true
                等待 保全确认结束, 800, 3, true
                组合=array(保全作战终止1,保全作战终止2,保全作战终止3,保全作战终止4)
                等待 组合, 1000, 10, True
                Delay 1500
                点击 50,1000
                返回主页()
                点击 778, 1474'终端
                Delay 2500
                点击 848,1678
                Delay 3000
                点击 400,750'进阿卡胡拉丛林
                KeepCapture 
            End If
            等待 阿卡胡拉丛林, 800, 3, true
            等待 定向导能元件, 800, 3, False
            Delay 1500
            点击 450, 1300'选择第三个
            Delay 1500
            等待 定向导能元件, 800, 3, true
            Delay 500
            等待 战术装备配备, 800, 3, true
            Delay 500
            等待 阵容确认, 800, 3, false
        /*
        TracePrint 保全编队
        If 保全编队 = false  Then 
            Call 保全选人()
            保全编队=true
        End If
        */
            点击 阵容确认(0), 阵容确认(1)
            Do
                等待 结算委托, 1000, 10, false
                KeepCapture 
                If 判断(丛林式寒暄) = true Then 
                    TracePrint "丛林式寒暄"
                    点击 64, 1707
                    等待 保全开始行动, 800, 3, false
                    Call prts("丛林式寒暄-0", false)
                ElseIf 判断(生物多样性) = true Then
                    点击 64, 1707
                    If 等待(临时增调, 1000, 5, false) = true Then 
                        Delay 2500
                        Call 保全增调()
                        Call 保全增调()
                    End If
                    等待 保全开始行动, 800, 3, false
                    Call prts("生物多样性-0", false)
                Else
                    等待 结算委托, 1000, 10, true
                    等待 保全确认结束, 800, 3, true
                    Delay 2000
                    组合=array(保全作战终止1,保全作战终止3)
                    等待 组合, 1000, 5, True
                    Delay 2000
                    组合=array(保全作战终止2,保全作战终止4)
                    等待 组合, 1000, 5, True
                    等待 阿卡胡拉丛林, 800, 3, false
                    发送QQ通知 ("保全战斗完成",true,0,140,400,600)
                    Exit Do
                End If
                组合=array(保全战斗完成,任务失败)
                等待 组合, 1000, 10, True
            Loop
            Call 返回主页()
        Else 
            发送QQ通知 ("未找到保全，打完了？",true,774,1434,920,1876)
            找不到次数 = 找不到次数 + 1
            If 找不到次数 > 10 Then 
                Exit Do
            End If
        End If
    loop

End Sub

Sub 保全自动识别赏金地图()
    dim 保全主地图
    Dim 保全一层地图
    Dim 保全二层地图
    Dim 保全三层地图
    Dim 保全一层
    Dim 保全二层
    Dim 保全三层
    Dim 组合
    Dim 找不到次数 =0
    作业路径=0
    返回主页()
    点击 778, 1474'终端
    Delay 2500
    KeepCapture 
    If 判断(保全未打完)=true Then 
        TracePrint "保全"
        发送QQ通知 ("保全未打完",true,774,1434,920,1876)
        点击 848,1678
        Delay 5000        
        KeepCapture 
        If 判断(结算委托) = true Then 
            等待 结算委托,5000,10,true
            等待 保全确认结束, 800, 3, true
            组合=array(保全作战终止1,保全作战终止2,保全作战终止3,保全作战终止4)
            等待 组合, 1000, 3, True
            等待 组合, 1000, 10, True
            返回主页()
            点击 778, 1474'终端
            Delay 2500
            点击 848,1678
            Delay 15000
            KeepCapture 
        End If
        
        If 判断(萝卜矿场) = true Then 
            TracePrint"萝卜矿场"
            保全主地图=萝卜矿场
            保全一层地图="五号矿洞-0"
            保全二层地图="唯利是图-0"
            保全三层地图 = "恶势力-0"
            保全一层=五号矿洞
            保全二层=唯利是图
            保全三层=恶势力
        ElseIf 判断(格里布矿场) = true Then
            TracePrint"格里布矿场"
            保全主地图=格里布矿场
            保全一层地图="借道-0"
            保全二层地图="有备而来-0"
            保全三层地图 = "军容整肃-0"
            保全一层=借道
            保全二层=有备而来
            保全三层=军容整肃
        ElseIf 判断(多伦矿场) = true Then
            TracePrint"多伦矿场"
            保全主地图=多伦矿场
            保全一层地图="好邻居-0"
            保全二层地图="开工仪式-0"
            保全三层地图 = "流浪之所-0"
            保全一层=好邻居
            保全二层=开工仪式
            保全三层 = 流浪之所
        ElseIf 判断(斯沃玛加工平台)=true then
            TracePrint"斯沃玛加工平台"
            保全主地图=斯沃玛加工平台
            保全一层地图="无心插柳-0"
            保全二层地图="真假难辨-0"
            保全三层地图 = "夜色温柔-0"
            保全一层 = 无心插柳
            保全二层 = 真假难辨
            保全三层 = 夜色温柔
        End If
        等待 保全主地图, 800, 3, true
        等待 战术装备配备, 800, 3, true
        //        	选择装备
        等待 阵容确认, 800, 3, false
        TracePrint 保全编队
        If 保全编队 = false  Then 
            Call 保全选人()
            保全编队=true
        End If
        	
        点击 阵容确认(0), 阵容确认(1)
        Do
            //Rem 保全作战失败
            等待 结算委托, 1000, 10, false
            KeepCapture 
            If 判断(保全一层) = true Then 
                点击 64, 1707
                等待 保全开始行动, 800, 3, false
                Call prts(保全一层地图, false)
            ElseIf 判断(保全二层) = true Then 
                点击 64, 1707
                If 等待(临时增调, 1000, 5, false) = true Then 
                    Delay 2500
                    Call 保全增调()
                    Call 保全增调()
                End If
                等待 保全开始行动, 800, 3, false
                Call prts(保全二层地图, false)
            ElseIf 判断(保全三层) = true Then 
                点击 64, 1707
                If 等待(临时增调, 1000, 5, false) = true Then 
                    Delay 2500
                    Call 保全增调()
                    Call 保全增调()
                End If
                等待 保全开始行动, 800, 3, false
                Call prts(保全三层地图, false)
            Else
                等待 结算委托, 1000, 10, true
                等待 保全确认结束, 800, 3, true
                Delay 2000
                组合=array(保全作战终止1,保全作战终止3)
                等待 组合, 1000, 5, True
                Delay 2000
                组合=array(保全作战终止2,保全作战终止4)
                等待 组合, 1000, 5, True
                等待 保全主地图, 800, 3, false
                发送QQ通知 ("保全战斗完成",true,50,140,150,650)
                Exit Do
            End If
            组合=array(保全战斗完成,任务失败)
            等待 组合, 1000, 10, True
        Loop
        Call 返回主页()
    Else 
        发送QQ通知 ("未找到保全，打完了？",true,774,1434,920,1876)
        找不到次数 = 找不到次数 + 1
        If 找不到次数 > 10 Then 
            EndScript
        End If
    End If	
End Sub

Sub 保全增调()
    KeepCapture 
    Dim 选人1,选人2,序号
    Call TURING.Lib_Load(GetTempDir() & "保全临时增调职业.lib") 
    If CmpColor(308,250, "FFFFFF", 0.9) > -1 Then 
        选人1=array(-1,-1,-1,-1,-1)
        TracePrint "5个人"
        For i = 0 To 4
            Call TURING.Pixel_FromScreen(273,247+i*300,333,307+i*300)  
            Call TURING.Filter_Binaryzation("0-134")
            Call TURING.Filter_InverseColor(2)
            Call TURING.Incise_ScopeAisle(3,3)
            选人1(i)=cint(turing.ocr(75))   
        Next
        zm.TracePrint 选人1
        选人2=clone(选人1)
        zm.ArraySort 选人2, true
        序号 = zm.ArraySearch(选人1, 选人2(0))
        点击 333,307+序号*300
    Else 
        TracePrint "6个人"
        /*
        选人1=array(-1,-1,-1,-1)		
        For i = 0 To 4
            Call TURING.Pixel_FromScreen(274,397+i*300,333,457+i*300)   
            Call TURING.Filter_Binaryzation("0-134")
            Call TURING.Filter_InverseColor(2)
            Call TURING.Incise_ScopeAisle(3,3)
            选人1(i) = CInt(turing.ocr(75))
        Next
        zm.TracePrint 选人1
        选人2=clone(选人1)
        zm.ArraySort 选人2, true
        序号 = zm.ArraySearch(选人1, 选人2(0))
        点击 331, 456 + 序号 * 300
        */
        点击 400, 1650
    End If
    Delay 1000
    点击 181, 1780
    Delay 5000
End Sub

Sub 保全选人()
    TracePrint "保全选人"
    Dim 字典
    dim 编入数量=0
    Dim 未编入(),未编入干员()
    Dim 干员类别=array("PIONEER","WARRIOR","TANK","SNIPER","CASTER","MEDIC","SUPPORT","SPECIAL")
    Dim 未编入数量=0
    Dim 类别选择=array(977,1802,"977|1802|1E1D1D,1019|1901|D49E22")
    Dim 稀有度升序=array(1001,1427,"1015|1426|DA9702,999|1409|EBA301")
    点击 1007,1649'快速编队
    Delay 1500
    点击 77,770'清空选择
    Delay 1000    
    KeepCapture 
    If 判断(类别选择) = false Then 
        点击 977, 1802
        Delay 500
    End If
    Do
        KeepCapture 
        If 判断(稀有度升序) = false Then 
            点击 稀有度升序(0), 稀有度升序(1)
            Delay 500
        Else 
            Exit Do
        End If
    Loop
    	
    //保全选择初始低级队员(null) 
    点击 542, 1857'狙击
    Delay 500

    保全选择初始低级队员 ("杰西卡")
    保全选择初始低级队员 ("安德切尔")
    保全选择初始低级队员 ("克洛丝")
    call 保全选择初始高级干员()

End Sub

Sub 保全选择初始低级队员(a)
    //    TracePrint "识别上"    
    Dim 识别结果 = 保全编队识别("上",a)
    Dim 结果坐标()
    zm.TracePrint "_671", 识别结果
    For Each i In 识别结果
        结果坐标 = 字符串转数组(i, ",")
        点击 CInt(结果坐标(1)) + 100 + 604, CInt(结果坐标(2)) + 578
        Delay 50
    Next
    TracePrint "识别下"
         
    识别结果 = 保全编队识别("下",a)      
    zm.TracePrint "_705",识别结果
    For Each i In 识别结果
        结果坐标 = 字符串转数组(i, ",")
        点击 CInt(结果坐标(1)) + 100 + 188, CInt(结果坐标(2)) + 578
        Delay 50
    Next
    Delay 100
End Sub

Sub 保全选择初始高级干员()
	
    Dim 高级干员={"先锋":{"推进之王2","桃金娘1","豆苗1"},"近卫":{"棘刺3"},"重装":{"泥岩2"},"狙击":{"假日威龙陈3"},"辅助":{"浊心斯卡蒂2"}}
    点击 991,1275'等级降序
    Delay 500
    点击 909,1833'先锋
    Delay 500
    选择干员 高级干员["先锋"], "保全队员", "推进之王桃金娘豆苗",10,6,80
    点击 780,1835'近卫
    Delay 500
    选择干员 高级干员["近卫"], "保全队员", "棘刺",10,6,80
    点击 650,1843'重装
    Delay 500
    选择干员 高级干员["重装"], "保全队员", "泥岩",10,6,80
    点击 538,1854'狙击
    Delay 500
    选择干员 高级干员["狙击"], "保全队员", "假日威龙陈",10,6,80
    点击 184,1854'辅助
    Delay 500
    选择干员(高级干员["辅助"],"保全队员","浊心斯卡蒂",10,6,80)
    Delay 300
    点击 53,1513'确认
    等待 阵容确认,800,3,false
    
End Sub



Sub 选择技能(a)
    TracePrint "选择技能",a
    KeepCapture 
    intX=520
    For i = 0 To a - 1
	
        FindColor 2, 13,intX-i*157, 14,"121212", 2, 0.85, intX, intY'找左上角黑点
        //		TracePrint intX,intY,i
        If i = a - 1 Then 
            If intX > -1 Then 				
                点击 intX,intY
            Else 
                TouchDown 97,103,1
                Delay 200
                TouchMove 297,72, 1, 200
                Delay 100
                TouchMove 297,72, 1, 200
                Delay 500
                TouchUp 1
                点击 97,103
            End If			
        End If		
    Next
End Sub

Function 识别肉鸽地图()
    KeepCapture 
    If 判断(肉鸽战斗进入) = true or 判断(肉鸽boss作战进入)=true Then 
        Call TURING.Pixel_FromScreen(770,1330,822,1554)    ' 需要修改的地方！
    ElseIf 判断(肉鸽紧急作战进入) = true Then
        Call TURING.Pixel_FromScreen(826,1335,876,1559)    ' 需要修改的地方！
    End If
   
    Call TURING.Filter_Rotate(270)
    Call TURING.Filter_Binaryzation("0-180")
    Call TURING.Incise_ScopeAisle(10,10)
    TracePrint TURING.Lib_Load(GetTempDir() & "肉鸽地图名.lib")    ' 识别字库路径可自行更换！！！

    识别肉鸽地图 = TURING.OCR(80)
End Function


Sub 识别待编队干员(字典)
    Dim t=TickCount()
    TracePrint turing.Version()
	
    Call TURING.Pixel_FromScreen(573,639,604,1589)
    Call TURING.Filter_Rotate(270)
    Call TURING.Filter_Binaryzation("0-199")
    Call TURING.Incise_ScopeAisle(8,3)
    //识别字库路径可自行更换！！！
    TracePrint "加载条数", TURING.Lib_Load(临时目录 & "待编队干员.lib",字典) 
    Dim 识别结果 = TURING.OCR(70,2,50)
    t=TickCount()-t
    TracePrint t,识别结果
	
    Call TURING.Pixel_FromScreen(157,639,188,1589)
    Call TURING.Filter_Rotate(270)
    Call TURING.Filter_Binaryzation("0-199")
    Call TURING.Incise_ScopeAisle(8,3)
    //识别字库路径可自行更换！！！
    //	TracePrint 字典
    TracePrint TURING.Lib_Load(临时目录 & "待编队干员.lib",字典) 
    识别结果 = TURING.OCR(70,2,50)
    t=TickCount()-t
    TracePrint t,识别结果	
End Sub


Function 识别支援干员(a)
    For i = 0 To 8	
        Call TURING.Pixel_FromScreen(840 - 298 * (i \ 3), 261 + 678 * (i mod 3), 902 - 298 * (i \ 3), 437 + 678 * (i mod 3))    ' 需要修改的地方！
        Call TURING.Filter_Rotate(270)
        Call TURING.Filter_Binaryzation("0-172")
        Call TURING.Incise_ScopeAisle(10,1)
        Call TURING.Lib_Load(GetTempDir() & "肉鸽干员.lib",a)    ' 识别字库路径可自行更换！！！
        If TURING.OCR(85) = a Then 
            识别支援干员=array(830 - 298 * (i \ 3), 785 + 678 * (i mod 3))
        End If
    Next
End Function

Sub 编入支援干员(数组,方式)
    TracePrint "编入支援干员"
    Dim 干员类型=数组(0)
    Dim 干员
    干员 = 数组(1)    
    Dim 识别结果(),b64,结果
    Dim 选到干员=false
    TracePrint 干员类型,干员
    //    点击 769,1653'支援加号
    Delay 1500
    点击 882-干员类型*114,86'干员类别
    Delay 800
    //    Swipe 720, 255,725, 1610'滑动到左边
    //    Delay 1000
    For 25
        For i = 0 To 7

            If 方式 = 1 Then
                //                Call TURING.Pixel_FromScreen(853 - 298 * (i \ 3), 253 + 678 * (i mod 3), 895 - 298 * (i \ 3), 437 + 678 * (i mod 3))    ' 需要修改的地方！
                Call TURING.Pixel_FromScreen(188,204+208*i,230,376+208*i)
                Call TURING.Filter_Rotate(270)
                Call TURING.Filter_Binaryzation("0-178")
                Call TURING.Incise_ScopeAisle(10,10)
                //                TURING.Pixel_Preview()
                Call TURING.Lib_Load(GetTempDir() & "支援干员.lib",干员)
                结果 = TURING.OCR(80)
                
            End If
            TracePrint i,结果
            If 识别结果 <> null Then 
                
                If 结果 = 干员 Then 
                    点击 245, 281 + 208 * i
                    Delay 1000
                    选到干员 = true
                    
                End If
            End If
        Next
			
			
        If 选到干员 = true Then 
            Exit For
        Else 
            点击 1021, 1765
            Delay 1500
           
        End If
    Next
End Sub

Sub 读作业()
    PutAttachment 临时目录,zuoye
    作业=Encode.JsonToTable(zm.FileRead (临时目录&zuoye))
End Sub


Sub 抄作业(作业)
	
    //    Dim 慢放=需要慢放干员
    Dim cost,wave,t,wavetxt
    Dim cost依赖命令,wave依赖命令
    wave=0	
    Dim 部署指令,等待cost,需要cost
    Dim wave依赖指令,wave部署,wave干员信息,地图坐标()
    部署指令 = 部署(部署顺序)
    Dim 下排干员数量,数量变化,差值
    Dim 需要,找到
    //    Dim 操作时间戳1,操作时间戳2,部署时间戳1,部署时间戳2
    Dim 操作后,部署后
    //    zm.TracePrint "_936",部署指令
    wave依赖指令=波数依赖(波数依赖顺序)
    //	操作时间戳1 = 波数依赖顺序 - 1
    //	操作时间戳2=操作时间戳1
    //	部署时间戳1 = 部署顺序 - 1
    //	部署时间戳2=部署时间戳1
    Dim aa()
    点暂停()
    加速()
    干员列表 = 识别未部署干员()
    下排干员数量 =识别未部署干员数量()
    
    Dim 是否剿灭图=0
    If zm.ArraySearch (剿灭地图组,作业["stage_name"]) >-1 Then 
        是否剿灭图 = 1
    elseIf zm.ArraySearch(保全地图组,作业["stage_name"]) >-1 Then 
        是否剿灭图=2
    End If
    //    TracePrint 是否剿灭图
    Do
        //        If 部署顺序 < 2 and 慢放=true Then 
        //            Tap 79,1824
        //        End If
        Call 点战斗()
        cost = 获得cost()
        //        TracePrint 是否剿灭图
        wavetxt = 获得敌人数(是否剿灭图)
        //        TracePrint 获得敌人数(2)
        TracePrint "当前波次",wavetxt
        If IsNumeric(Int(Left(wavetxt, InStr(2, wavetxt, "/") - 1))) = true Then 
            wave=Int(Left(wavetxt, InStr(2, wavetxt, "/") - 1))
        End If
        
        TracePrint "当前cost",cost,"已击败敌人数",wave
        zm.TracePrint "_1111", 部署指令
        //		zm.ShowMessage(部署指令,2000,0,0)
        Rem 找干员
        If 部署顺序 <= 部署命令数 and IsNull(干员列表) = false Then 
            //            If 部署时间戳1 <> 部署顺序 Then 
            //                部署前延时 = TickCount()
            //                部署时间戳1=部署顺序
            //            End If
                    
            If (IsNull(部署指令["pre_delay"]) = false and (TickCount() - 部署前延时) < 部署指令["pre_delay"]) or (IsNull(部署后) = false and (TickCount() - 部署前延时) < 部署后)  Then 
            
            else                    
                //            TracePrint 部署指令["name"],isIn(干员列表, 部署指令["name"])
                //                TracePrint "到达层数",到达层数
                干员排位 = zm.arraysearch(干员列表, 部署指令["name"])
                
                If 干员排位 > -1 Then 
                    //                    If arraysearch(无限放技能干员, 部署指令["name"]) > -1 Then 
                    	
                    已部署干员[部署指令["name"]]=部署指令["location"]
                    //                    End If
                    需要cost = 坐标列表(干员排位)
                    zm.TracePrint "_1148", 干员列表
                ElseIf isIn(群组, 部署指令["name"]) = true Then
                    找到=false
                    For Each i In 群组[部署指令["name"]]
                        //                        TracePrint i["name"]
                        干员排位=zm.arraysearch(干员列表, i["name"])
                        If 干员排位 > -1 Then 
                            //                        	If arraysearch(无限放技能干员,i["name"])>-1 Then 
                            已部署干员[i["name"]]=部署指令["location"]
                            //                        	End If
                            需要cost = 坐标列表(干员排位)
                            找到 = true            			
                            Exit For
                        End If            		
                    Next
                    If 找到 = false Then 
                        部署顺序 = 部署顺序 + 1
                        部署指令 = 部署(部署顺序)
                        Goto 找干员
                    End If
                Else 
                    部署顺序 = 部署顺序 + 1
                    部署指令 = 部署(部署顺序)
                    Goto 找干员
                End If
                //                If cost >= (需要 - 3) Then 
                //                    点子弹时间
                //                End If
                KeepCapture 
                If (CmpColor(需要cost(0),需要cost(1)+5,"FFFFFF",0.95)>-1 or CmpColor(需要cost(0)+20,需要cost(1)+5,"FFFFFF",0.95)>-1) Then  
                    部署指令 = 部署干员(干员排位)//                  
                    下排干员数量 = 下排干员数量 - 1               		
                    点战斗()
                End If
            End If
        End If
                
        If 波数依赖顺序 <= 波数依赖命令数 Then 
            zm.TracePrint "_1140", wave依赖指令
            If wave依赖指令["kills"] = null Then 
                wave依赖指令["kills"]=0
            End If
            //            zm.ShowMessage (wave依赖指令,2000,0,0)
            //            ShowMessage "消灭敌人数"&wave依赖指令["kills"]&"时,"&wave依赖指令["type"]&","&wave依赖指令["name"]&","&wave依赖指令["location"],1500,0,0
            If wave依赖指令["type"] = "二倍速" Then 
                Delay 50
                加速 
                波数依赖顺序 = 波数依赖顺序 + 1
                wave依赖指令=波数依赖(波数依赖顺序)
            Else 
                If wave >= wave依赖指令["kills"] Then 
                    //                	If 操作时间戳1 <> 波数依赖顺序 Then 
                    //                		操作前延时 = TickCount()
                    //                		操作时间戳1=波数依赖顺序
                    //                	End If
                    
                    If (IsNull(wave依赖指令["pre_delay"]) = false and (TickCount()-操作前延时)<wave依赖指令["pre_delay"]) or IsNull(操作后) = false and (TickCount()-操作后延时)<操作后 Then 
            		
                    Else 
            		
                        If wave依赖指令["type"] = "技能" Then 
                            If Isnull(wave依赖指令["location"]) = false Then 
                                wave依赖指令 = 释放坐标技能(wave依赖指令["location"])
                            Else 
                                wave依赖指令 = 释放技能(wave依赖指令["name"])
                            End If
                    
                        ElseIf wave依赖指令["type"] = "部署" Then
                            干员排位=zm.arraysearch(干员列表, wave依赖指令["name"])    
                            TracePrint wave依赖指令["name"],"干员排位",干员排位
                            If 干员排位 > -1 Then 
                                需要 = 费用列表(干员排位)
                                zm.TracePrint 需要
                                If cost >= 需要 Then 
                                    Call 部署操作(干员排位, wave依赖指令)
                                    已部署干员[wave依赖指令["name"]]=wave依赖指令["location"]
                                    下排干员数量=下排干员数量-1
                                    点战斗()
                                    波数依赖顺序 = 波数依赖顺序 + 1
                                End If
                            Elseif isIn(群组, wave依赖指令["name"]) = true Then
                                zm.TracePrint 干员列表
                                For Each i In 群组[wave依赖指令["name"]]
                                    
                                    干员排位 = zm.arraysearch(干员列表, i["name"])
                                    TracePrint i["name"],"群组内干员排位",干员排位
                                    If 干员排位 > -1 Then 
                                        需要 = 费用列表(干员排位)
                                        Call 部署操作(干员排位, wave依赖指令)                      
                                        已部署干员[i["name"]]=wave依赖指令["location"]
                                        下排干员数量=下排干员数量-1
                                        点战斗()                                        
                                                  			
                                        Exit For
                                    End If            		
                                Next
                                波数依赖顺序 = 波数依赖顺序 + 1 
                            Else 
                                波数依赖顺序 = 波数依赖顺序 + 1	
                            End If
                            wave依赖指令 = 波数依赖(波数依赖顺序)
                        ElseIf wave依赖指令["type"] = "撤退" Then
                            Call 撤退干员(wave依赖指令["location"])
                            //                            干员列表 = 识别未部署干员()
                            点战斗()
                            波数依赖顺序 = 波数依赖顺序 + 1
                            wave依赖指令 = 波数依赖(波数依赖顺序)    
                        End If                        
                    End If
                End If
            End If            
        End If
        KeepCapture
        For Each k , v In 已部署干员
            If zm.ArraySearch(无限放技能干员, k) > -1 Then 
                If k = "棘刺" and 模式 = 3 and 到达层数 < 3 Then 
                Else            	 
                    地图坐标 = map(v(0), v(1))
                    //                    If v(1) <= 1 Then 
                    //                    	//血条和技能条
                    //                    Else
                    FindMultiColor(地图坐标(0)+80, 地图坐标(1)-40, 地图坐标(0)+180, 地图坐标(1)+40,"19A0F3","21|-21|18A0F4,21|21|08C0FD,11|7|062641,34|-8|04182D", 0, 0.87,intX,intY)
                    If IntX > -1 Then 
                        TracePrint "干员"&k&"技能就绪"
                        点击 地图坐标(0), 地图坐标(1)
                        Delay 200
                        点击 480, 1244
                        Delay 50
                        点击 296, 1814
                        Delay 50
                    End If
                    //                    End If
                End If
            End If
        Next
        If 保全作战 = 1 Then 
            差值 = 识别未部署干员数量()
            TracePrint 差值
            If  差值< 9 Then 
                If CmpColor(370, 1869, "1965E9", 0.85) > -1 Then 
                    点击 370, 1869
                    Delay 300
                    For 9 - 差值
                        KeepCapture 
                        If CmpColor(370, 1869, "1965E9", 0.8) > -1 Then 
                            TracePrint "抽卡"
                            点击 370, 1869
                            Delay 300
                        End If
                    Next
                    Delay 1100
                End If
            End If
        End If
        数量变化=识别未部署干员数量()-下排干员数量
        TracePrint "下排干员数量",下排干员数量,"数量变化",数量变化
		
        //		If 识别未部署干员数量() <> 下排干员数量 Then 			
        //        	干员列表 = 识别未部署干员()
        //        	下排干员数量 = 识别未部署干员数量()
        //        End If
        If 数量变化 <> 0 Then 
            Call 更新未部署干员(数量变化)
            下排干员数量 = 识别未部署干员数量()
        End If
        点战斗 
        Delay 50
        KeepCapture
        If 判断(跳过剧情) = true Then
            点击 跳过剧情(0), 跳过剧情(1)
            Delay 1500
            点击 跳过剧情确定(0),跳过剧情确定(1)
            Delay 1500
        End If
        KeepCapture
        If  (判断(战斗中) = false and 判断(暂停中)=false) Then 
            TracePrint "结束抄作业"
            Exit Do 
        End If		
    Loop
End Sub


Function 部署干员(干员信息)
    Dim 指令=部署(部署顺序)    
    //    TracePrint 指令(0)	
    zm.TracePrint "_1287", 指令
    //	ShowMessage "部署干员"&指令["name"]&"位于"&指令["location",2000,0,0
    部署操作 干员信息, 指令
    部署顺序 = 部署顺序 + 1
    If 部署顺序 <= 部署命令数 Then 
        部署干员=部署(部署顺序)
    End If
	
End Function

Function 部署操作(干员排位, 指令)
    Dim 干员信息
    干员信息=坐标列表(干员排位)
    点战斗 
    TracePrint "点战斗，部署第",干员排位,"位干员"
    Delay 50
    TouchDown 干员信息(0)-130, 干员信息(1), 1
    TouchMove 干员信息(0)+60-130, 干员信息(1), 1
    点暂停
    部署操作 = False
    Dim 原地图坐标(),地图坐标()
    
        
    //        点击 干员信息(1), 干员信息(2)
    //        Delay 200
     
    原地图坐标 = 指令["location"]
    zm.TracePrint "_1325",原地图坐标
    地图坐标 = map1(原地图坐标(0), 原地图坐标(1))
    //    原地图坐标 = map(指令(1), 指令(2))
    //    地图坐标=计算变换坐标(原地图坐标(0),原地图坐标(1),变换矩阵)
    zm.TracePrint "_1049",原地图坐标,地图坐标    
    TouchMove 地图坐标(0)-40, 地图坐标(1), 1, 200     
    Delay 100    
    TouchMove 地图坐标(0)-20 , 地图坐标(1), 1, 200
    Delay 500    
    TouchUp 1
    Delay 200
    If 指令["direction"] = "左" Then 
        Swipe 地图坐标(0), 地图坐标(1),地图坐标(0), 地图坐标(1)-200
    ElseIf 指令["direction"] = "右" Then
        Swipe 地图坐标(0), 地图坐标(1),地图坐标(0), 地图坐标(1)+200
    ElseIf 指令["direction"] = "上" Then
        Swipe 地图坐标(0), 地图坐标(1),地图坐标(0)+200, 地图坐标(1)
    ElseIf 指令["direction"] = "下" Then
        Swipe 地图坐标(0), 地图坐标(1),地图坐标(0)-200, 地图坐标(1)
    End If
    zm.ArrayRemove 干员列表, 干员排位
    zm.ArrayRemove 费用列表, 干员排位
    If 保全作战 = 1 and 职业列表(干员排位) = "辅助" Then 
        点战斗
        Delay 500
        点暂停 
        Delay 500
    End If
    zm.ArrayRemove 职业列表, 干员排位
    Delay 100
    If IsNull(指令["rear_delay"]) = false Then 
        ShowMessage "等待" & 指令["rear_delay"]&"毫秒", 指令(4), 0, 0
    End If
End Function

Function 识别未部署干员数量()
    //	Dim tim=TickCount()
    Dim 干员cost
    KeepCapture 
    Dim 数量=zm.FindMultiColorEx(183, 19, 184, 1900,"000000","000000","5|5|000000,-4|5|000000,7|4|FFFFFF-808080,0|6|FFFFFF-808080", "右下", 0.93, intX, intY)
    //	Dim 数量1=zm.FindMultiColorEx(183, 19, 184, 1900,"000000","5|5|000000,-4|5|000000,7|4|7F7F7F,0|6|7F7F7F", 7, 0.95, intX, intY)
    //	zm.TracePrint 数量
    If isnull(数量)=false Then 
        识别未部署干员数量 = 数量["counts"]
        坐标列表 = 数量["xy"][0]
    Else 
        识别未部署干员数量=0
    End If	
    //	TracePrint TickCount()-tim
End Function

Function 识别未部署干员()
    Dim tim=TickCount()
    Dim t,text
    Dim 干员数,干员名字
    Dim 干员列表()
    Dim BX,BY
    t = TickCount()
    
    Dim i()
    干员列表 =获取费用列表()
    //    TracePrint TickCount()-tim
    ReleaseCapture 
    zm.TracePrint "_1378", 干员列表
    干员数=UBound(干员列表)
    TracePrint "待部署干员"&干员数+1&"名"
    If 干员数 > -1 Then 
        text = "["
        //        验证="00"                
        For 下标 = 0 To 干员数        	
            i=干员列表(下标)
            点击 i(2), i(3)
            Delay 300	
            干员名字 = 战斗识别干员(1)
            If 干员名字 <> null Then 
                i(0)=战斗识别干员(1)
            End If
            	
            
            //            If i(1) <> null Then 
            TracePrint "干员"&i(0)&",cost"&i(1)
            //            	text = text & """" & i(0) & """:[" & i(1) & "," & i(2) & "," & i(3) & "],"
            text=text&""""&i(0)&""""&","
            BX= i(2)
            BY = i(3)
            // 				验证=i(0)
            // 			Else 
            // 				Exit For
            //            End If
            
        Next
        点击 BX,BY
        Delay 200
        text = Left(text, Len(text) - 1) & "]"
        TracePrint text
        识别未部署干员=Encode.JsonToTable(text)
    End If	
    TracePrint "耗时"&TickCount()-t
End Function

Function 更新未部署干员(数量变化)
    Dim 旧费用列表,旧职业列表
    Dim 坐标(),识别结果,更新()
    Dim 更新列表
    旧职业列表=clone(职业列表)
    旧费用列表=clone(费用列表)
    更新列表 = 获取费用列表()
    TracePrint "更新未部署干员"
    zm.TracePrint 费用列表	
    zm.TracePrint 职业列表	
    If 数量变化 > 0 Then 
        TracePrint "干员增加",数量变化
        For 数量变化
            zm.TracePrint 旧费用列表
            zm.TracePrint 旧职业列表
            zm.TracePrint 干员列表
			
            For i = 0 To UBOUND(费用列表)
                If 旧费用列表(i) <> 费用列表(i) or 旧职业列表(i) <> 职业列表(i) Then 
                    坐标=坐标列表(i)
                    点击 坐标(0) - 130, 坐标(1)
                    TracePrint i
                    
                    Delay 400
                    识别结果 = 战斗识别干员(1)
                    
                    TracePrint 识别结果
                    If 识别结果 <> null Then 
                        //                    	If 识别结果 = 干员列表(i) Then 
                        //                    		旧费用列表(i) = 费用列表(i)
                        //                    		旧职业列表(i) = 职业列表(i)
                        //                    	Else 
                        zm.ArrayInsert 旧费用列表, 费用列表(i), i
                        zm.ArrayInsert 旧职业列表, 职业列表(i), i
                        zm.ArrayInsert 干员列表, 识别结果, i
                        zm.TracePrint  干员列表
                        //                    	End If
                    	
                    Else 
                        zm.ArrayInsert 旧费用列表, 费用列表(i), i
                        zm.ArrayInsert 旧职业列表, 职业列表(i), i
                        更新 = 更新列表(i)
                        TracePrint 更新(0)
                        zm.ArrayInsert 干员列表, 更新(0), i
                    End If
                    
                    点击 坐标(0)-130, 坐标(1)
                    Delay 300
                    Exit For
                End If
            Next
        Next
    ElseIf 数量变化 < 0 Then
        TracePrint "干员减少",数量变化
        For Abs(数量变化)
            //    		旧费用列表=clone(费用列表)
            //			更新列表 = 获取费用列表()
            zm.TracePrint 旧费用列表
            zm.TracePrint 旧职业列表
            //			zm.TracePrint 费用列表
            zm.TracePrint 干员列表
            For i = 0 To UBOUND(费用列表)
                If 旧费用列表(i) <> 费用列表(i) or 旧职业列表(i) <> 职业列表(i) Then 
                    zm.ArrayRemove 干员列表, i
                    zm.ArrayRemove 旧费用列表, i
                    zm.ArrayRemove 旧职业列表, i
                    zm.TracePrint 干员列表
                    Exit For
                End If
            Next
        Next
    End If
    
End Function

Function 获取费用列表()
    Dim 干员数,干员名称,干员cost
    dim 干员职业="未识别干员"
    Dim 职业颜色
    Dim 干员列表()
    Dim BX,BY
    TURING.Lib_Load(临时目录&"干员cost.lib")
    BX = 183
    BY = 1900
    干员数 = 0
    zm.TableClear (费用列表)
    zm.TableClear(职业列表)
    Call 点暂停()
    Do
        FindMultiColor(183, 19, BX+1, BY,"000000","5|5|000000,-4|5|000000,7|4|FFFFFF-808080,0|6|FFFFFF-808080", 7, 0.95, intX, intY)		
        //                TracePrint intX,intY
        If intX <0 Then 			
            Exit Do
        Else 
            BX = intX
            BY = IntY-40
            干员数 = 干员数 + 1

            turing.Pixel_FromScreen 147, intY - 18, 173, intY + 25
            Call TURING.Filter_Binaryzation("FFFFFF-404040|7E7E7E-202020")
            Call TURING.Filter_Despeckle(6)
            TURING.Incise_ScopeAisle 1, 1
            干员cost = turing.OCR(70)
            //            TracePrint smartocr(147, intY - 15, 173, intY + 25)
            If 干员cost <> null Then 
                干员cost = Int(干员cost)
            End If
            
            职业颜色=CmpColor(182,intY-20,"00D8FF|2217B1|DC9800|1FC38F|888888",0.85)'黄|红|蓝|绿|灰
            If 职业颜色 = 0 Then 
                If CmpColor(167, intY - 27, "292929", 0.9) > -1 Then 
                    干员职业 = "重装"
            		
                ElseIf CmpColor(172, intY - 26, "292929", 0.9) > -1 Then 
                    干员职业 = "先锋"
                Else 
                    干员职业="近卫"
                End If
            ElseIf 职业颜色 = 1 Then
                If CmpColor(149, intY - 52, "292929", 0.9) > -1 Then 
                    干员职业 = "狙击"
                Else 
                    干员职业="术士"
                End If
            ElseIf 职业颜色 = 2 Then
                If CmpColor(149, intY - 41, "292929", 0.9) > -1 Then 
                    干员职业 = "医疗"
                Else 
                    干员职业="辅助"
                End If
            ElseIf 职业颜色 = 3 Then
                干员职业="特种"
            ElseIf 职业颜色 = 4 Then
                干员职业="召唤物"
            End If
            
            干员列表(干员数-1) = Array(干员职业, 干员cost, intX - 130, intY)
            费用列表(干员数 - 1) = 干员cost
            职业列表(干员数 - 1)=干员职业
            //            坐标列表(干员数-1)=array(intX , intY)
        End If		
    Loop
    //	zm.TracePrint 干员列表
    获取费用列表=干员列表
End Function

Function 获得敌人数(a)
    Delay 10
    If a = 0 Then 
        TURING.Pixel_FromScreen 1018, 794, 1053, 943
    ElseIf a = 1 Then
        TURING.Pixel_FromScreen 1006, 930, 1057, 1086
    ElseIf a = 2 Then
        TURING.Pixel_FromScreen 1006, 930, 1057, 1086
    End If
    Call TURING.Filter_Binaryzation("41-166")
    Call TURING.Incise_ScopeAisle(1,1)
    Call TURING.Lib_Load(临时目录 & "当前波数.lib")
    获得敌人数=TURING.ocr()    
    Delay 10    
End Function

Function 获得cost()
    TURING.Lib_Load(临时目录&"当前cost.lib")
    TURING.Pixel_FromScreen 272,1793,341,1907
    TURING.Filter_Binaryzation ("0-100")
    TURING.Incise_ScopeAisle 1, 1
    获得cost=int(TURING.ocr())
End Function

Function 战斗识别干员(a)
    //	Dim MyTime
    //	MyTime = TickCount()
    Dim 识别结果1,识别结果2
    If a = 1 Then
        Dim t=TickCount()
        //        TracePrint t
        TURING.Lib_Load (临时目录 & "战斗干员名.lib",干员名单)
        TURING.Pixel_FromScreen 762+保全作战*118,20-12*保全作战,807+保全作战*118,318
        TURING.Filter_Binaryzation ("0-187")
        Call TURING.Filter_Rotate(270)
        Call TURING.Incise_ScopeAisle(10, 4)
        识别结果1 = turing.OCR(75)
        
        TURING.Pixel_FromScreen 762+保全作战*118,20-12*保全作战,807+保全作战*118,318
        TURING.Filter_Binaryzation ("0-187")
        Call TURING.Filter_Rotate(270)
        Call TURING.Incise_ScopeAisle(10, 3)
        识别结果2 = turing.OCR(75)
        //        TracePrint 识别结果1,识别结果2
        If Len(识别结果2) > Len(识别结果1)  Then 
            识别结果1 = 识别结果2      		
        End If
        If zm.ArraySearch(干员验证名单,识别结果1) > -1 Then 
            战斗识别干员=识别结果1
        End If
    End If
    
End Function

Function 查找技能()
    Dim 技能表
    Dim t
    KeepCapture
    技能表 = Image.FindMultiColor(182, 167, 1080, 1740,"19A0F3","21|-21|18A0F4,21|21|08C0FD,11|7|062641,34|-8|04182D", 0, 0.9)
    Dim 下标 = UBound(技能表)
    TracePrint "找到",下标,"就绪技能"
    点战斗()
    t=TickCount()
    For i = 0 To 下标
        技能表(i, 0) = 技能表(i, 0) - 155
        技能表(i, 1) = 技能表(i, 1) - 20
        点击 技能表(i, 0), 技能表(i, 1)
        Delay 200
        技能表(i, 2) = 战斗识别干员(1)
        点击 560, 1828
        Delay 200
        TracePrint "干员"&技能表(i,2)&"技能准备就绪,坐标:"&技能表(i,0),技能表(i,1)
    Next
    KeepCapture
    If 判断(战斗中) = true Then 
        点击 战斗中(0), 战斗中(1)
    End If
    TracePrint "耗时"&TickCount()-t
    查找技能=技能表()
End Function

Function 释放技能(干员)
    Dim 技能表
    Dim t
    
    KeepCapture
    技能表 = Image.FindMultiColor(182, 167, 1080, 1740,"19A0F3","21|-21|18A0F4,21|21|08C0FD,11|7|062641,34|-8|04182D", 0, 0.87)
    Dim 下标 = UBound(技能表)
    TracePrint 下标+1&"个技能准备好了"
    If 下标 > -1 Then 
        点战斗()
        t=TickCount()
        For i = 0 To 下标    	
            技能表(i, 0) = 技能表(i, 0) - 155
            技能表(i, 1) = 技能表(i, 1) - 20
            If i > 0 and Abs(技能表(i, 0) - 技能表(i - 1, 0)) < 20 and Abs(技能表(i, 1) - 技能表(i - 1, 1)) < 20 Then 
            	
            Else 
                tap 技能表(i, 0), 技能表(i, 1)
                Delay 350
                技能表(i, 2) = 战斗识别干员(1)
                If 干员 = "all" Then 
                    点击 465,1271
                    Delay 100
                    点击 296,1814
                    技能未就绪=0
                elseIf 技能表(i, 2) = 干员  Then 
                    点击 465,1271
                    Delay 100
                    点击 296,1814
                    技能未就绪=0
                    波数依赖顺序 = 波数依赖顺序 + 1    		
                    Exit For
                ElseIf 技能表(i, 2) = "桃金娘" Then
                    点击 465, 1271
                    技能未就绪=0
                    Delay 100
                    点击 296,1814
                    Exit For 
                Else 
                    点击 296,1814
                    技能未就绪 = 技能未就绪 + 1
                    If 技能未就绪 > 40 Then 
                        技能未就绪=0
                        波数依赖顺序 = 波数依赖顺序 + 1    
                    End If
                    Delay 100
                End If
                //        点击 560, 1828
                //        Delay 200
                //        TracePrint "干员"&技能表(i,2)&"技能准备就绪,坐标:"&技能表(i,0),技能表(i,1)
            End If
            Delay 50
        Next
        If 干员 = "all" Then 
            波数依赖顺序 = 波数依赖顺序 + 1   
        End If
    End If
    If 波数依赖顺序 <= 波数依赖命令数 Then 
    	
        释放技能= 波数依赖(波数依赖顺序)
    End If
    
End Function

Function 释放坐标技能(坐标)
    Dim c=坐标(0)
    Dim r=坐标(1)
    TracePrint "释放技能,格子坐标",c,r
    Dim 地图坐标()
    Call 点战斗()    
    地图坐标 = map(c ,r)
    点战斗 
    TracePrint c,r,"实际坐标",地图坐标(0), 地图坐标(1)
    Delay 10
    If r <= 1 Then 
        点击 地图坐标(0), 地图坐标(1)
        Delay 500
        For 6
            KeepCapture
            If 判断(技能就绪) = true Then 
                点击 480, 1244
                技能未就绪=0
                波数依赖顺序 = 波数依赖顺序 + 1
                Delay 100
                点击 296,1814
                Exit For
            Else 
                点击 304, 1803
                
                技能未就绪 = 技能未就绪 + 1
                If 技能未就绪 > 25 Then 
                    技能未就绪=0
                    波数依赖顺序 = 波数依赖顺序 + 1    
                End If
            End If
            delay 200
        Next
        delay 250	
    Else 
        For 6
            KeepCapture 
            FindMultiColor(地图坐标(0)+80, 地图坐标(1)-40, 地图坐标(0)+180, 地图坐标(1)+40,"19A0F3","21|-21|18A0F4,21|21|08C0FD,11|7|062641,34|-8|04182D", 0, 0.87,intX,intY)
            If IntX > -1 Then 
                点击 地图坐标(0), 地图坐标(1)
                Delay 300
                点击 480, 1244
                技能未就绪 = 0
                波数依赖顺序 = 波数依赖顺序 + 1
                Exit For
            Else 
                技能未就绪 = 技能未就绪 + 1
                If 技能未就绪 > 40 Then 
                    技能未就绪=0
                    波数依赖顺序 = 波数依赖顺序 + 1    
                End If
            End If
            delay 300
        Next
    End If
    delay 200	
    If 波数依赖顺序 <= 波数依赖命令数 Then 
        释放坐标技能= 波数依赖(波数依赖顺序)
    End If
End Function



Sub 撤退干员(坐标)	
    Dim c=坐标(0)
    Dim r=坐标(1)
    TracePrint "撤退干员,格子坐标",c,r
    Dim 地图坐标()
    地图坐标 = map(c ,r)
    点战斗 
    KeepCapture 
    If 判断(子弹时间) = true Then 
        地图坐标 = map1(c ,r)
    End If
    Delay 100
    TracePrint c,r,"实际坐标",地图坐标(0), 地图坐标(1)
    点击 地图坐标(0), 地图坐标(1)
    Delay 300
    点暂停 
    Delay 100
    点击 747,900
    Delay 300
    点击 296, 1814
    Delay 50
End Sub

Sub 点战斗()	
    KeepCapture 
    If 判断(暂停中) = true Then 
        TracePrint "点战斗"
        zm.KeyPress ("back")
    End If
End Sub

Sub 点暂停()//	
    KeepCapture 
    If 判断(战斗中) = true Then 
        TracePrint "点暂停"
        zm.KeyPress ("back")
    End If
End Sub

Sub 点子弹时间()
    KeepCapture 
    If 判断(子弹时间) = false and (判断(战斗中) = true or 判断(暂停中) = true) Then 
        TracePrint "启动子弹时间"
        点击 120, 1822
        Delay 20
    End if
End Sub

Function 加速()
    //	TracePrint "点2倍速"
    KeepCapture 
    If 判断(单倍速) = true Then 
        点击 单倍速(0), 单倍速(1)
        Delay 100
    End If
End Function

Function 减速()
    //	TracePrint "点1倍速"
    KeepCapture 
    If 判断(双倍速) = true Then 
        点击 单倍速(0), 单倍速(1)
        Delay 100
    End If
End Function

Sub 重复战斗()
    TracePrint "重复战斗"
    Dim 循环计数
    Dim 开始()=array(开始1,开始11)
    Dim 点击开始后=array(红色开始, 确认使用剿灭券)
    Do
        Rem 标记
        If 出击检测 = true Then 
            KeepCapture
            If Sys.AppIsFront("com.hypergryph.arknights") = False and 判断(开始1) = False Then 
                KillApp "com.hypergryph.arknights"
                Delay 10000
                RunApp "com.hypergryph.arknights"
                Delay 20000
                等待 开始游戏, 2000, 60, true
                Delay 10000
                等待 登录界面1, 2000, 30, false
                Call 登录(目前账号)
                Delay 2000
                Call 选图(图)
                Delay 2500
            End If	
        End If
        
        
        If 等待(开始, 1500, 5, false) = true Then 
            KeepCapture 
            If 判断(开始1) = true Then 
        		
        	
                If CmpColor(53, 570, "FFFFFF", 0.95) > -1 and CmpColor(81,76, "3028F3", 0.9) > -1 Then
                    TracePrint "剿灭打完"
                    ShowMessage "剿灭打完"
                    Exit Do
                Else 
                    KeepCapture
                    If 判断(剿灭全权委托) = true Then 
                        点击 剿灭全权委托(0), 剿灭全权委托(1)
                        Delay 1000
                    ElseIf CmpColor(188,1601, "212121", 0.9) > -1 Then 
                        TracePrint "开启代理"
                        点击 194, 1601
                        Delay 1500
                    End If
                    点击 开始1(0),开始1(1)       
                End If
            ElseIf 判断(开始11) = true Then
        	
                If CmpColor(203,1627, "FFFFFF", 0.9) = -1 Then 
                    TracePrint "开启代理"
                    点击 203,1627
                    Delay 1500
                End If
                点击 开始11(0), 开始11(1)
            End If        
                    
        End If
        
       
        Delay 2500
        KeepCapture
        If 判断(理智用完) = true Then 
            Delay 1000
            If 碎石 = true Then 
                点击 222, 1630
                Delay 1000
                Goto 标记
            ElseIf 嗑药 = true and 判断(有药) = True Then
                TracePrint "嗑药"
                点击 222, 1630
                Delay 1000
                Goto 标记         
             
            else 
                点击 理智用完(0), 理智用完(1)
                TracePrint "理智用完"
                Exit Do
            End If
        ElseIf 图=43 and 判断(开始1) = true Then
            Exit Do 
        End If
        KeepCapture
        If 判断(源石用完) = true Then 
            TracePrint "源石用完"
            点击 926, 546
            Delay 1000
            Exit Do 
        End If
		
		
        等待 点击开始后, 1500, 6, false
        //        For 每局时间
        KeepCapture 
        If 判断(红色开始) = true Then 
            点击 红色开始(0),红色开始(1)
            Delay 30000
        ElseIf 判断(确认使用剿灭券) = true Then
            点击 确认使用剿灭券(0), 确认使用剿灭券(1)
            Delay 1500
        End If
        
        //        Next
        KeepCapture 
         
        If 判断(升级) = true Then 
            Delay 1000
            点击 升级(0),升级(1)
            Delay 1500
        End If
        KeepCapture
        If 判断(剿灭打完) = true Then 
            Delay 1000
            点击 90, 1217
            Delay 2000
            等待 剿灭结束, 1000, 3, true
            If 每轮一次 = true Then 
                Delay 10000
                Exit Do 
            End If
        Else 
            循环计数=0
            Do
                KeepCapture
                If 判断(战斗中) = true Then 
                    TracePrint "战斗中"
                    Delay 5000
                ElseIf 判断(开始1) = true or 判断(开始11) = true Then
                    Exit Do
                elseIf 判断(剿灭保存) = true Then 
                    点击 剿灭保存(0), 剿灭保存(1)
                    TracePrint "剿灭保存"
                    Delay 5000
                ElseIf 判断(确认使用剿灭券) = true Then
                    点击 确认使用剿灭券(0),确认使用剿灭券(1)
                ElseIf 判断(剿灭结束) = true Then
                    TracePrint "剿灭结束"
                    If 每轮一次 = true Then 
                        点击 剿灭结束(0), 剿灭结束(1)
                        Delay 10000
                        Exit Sub
                    Else 
                        点击 行动结束(0), 行动结束(1)
                        Delay 10000
                    End If
                Else
                    点击 行动结束(0), 行动结束(1)
                    Delay 5000
                    循环计数 = 循环计数 + 1
                    If 循环计数 > 240 Then 
                        Exit Sub
                    End If
                End If
                Delay 1000
            Loop
            //            For 60
            //            	KeepCapture 
            //            	If 判断(行动结束) = true or 判断(行动结束2) = true Then 
            //            		点击 行动结束(0), 行动结束(1)
            //            		Delay 2500
            //            		Exit For
            //            	End If            	
            //            Next
            //            点击 377, 1749
        End If
        KeepCapture  
        Delay 3000
    Loop
    Delay 1000
End Sub

Function 定图()
    星期 = DateTime.WeekDay()
    If DateTime.Hour() < 4 Then 
        星期 = 星期 - 1
        If 星期 = 0 Then 
            星期 = 7        	
        End If
    End If
    定图=cint(ReadUIConfig("周"&星期))-5
End Function



Sub 选图(a)
    Call 返回主页()
    TracePrint "选图"&a
    If a = -5 Then 
        ShowMessage "前往上次作战"
        每局时间 = 2
        点击 778, 1474
        Delay 1500
        点击 180,1536
        Delay 3500
    ElseIf a > -5 and a < 1 Then
    
        点击 778, 1474
        Delay 1500
        点击 74,1080
        Delay 1500
        If a = 0 Then 
            点击 564, 972
            Delay 2500
            点击 813, 1420
            Delay 1500
        Else 
            Swipe  554, 123, 585, 1661,100
            Delay 2500
            点击 526, 253 + (a + 4) * 312
            Delay 2500
            点击 813, 1420
            Delay 1500
        End If
        
    	
       
    ElseIf a > 26 and a<35 Then'芯片
        Dim ik=a-27
        点击 778, 1474
        Delay 1500
        点击 74,1080
        Delay 1500
        Swipe 585, 1661, 554, 123, 100
        Delay 2500
        TracePrint ik
        Dim ki=736 + (ik \ 2) * 312
        TracePrint ki
        点击 (605,ki)
        Delay 2500
        If ik mod 2 = 0 Then 
            点击 453,577
            Delay 1500
        ElseIf ik mod 2 = 1 Then 
            点击 701,1279
            Delay 1500
        End If
    ElseIf a > 34 and a < 38 Then
        点击 871, 1669
        ShowMessage "生于黑夜"
        Delay 6000
        点击 292, 1365
        Delay 3000
        If a = 35 Then 
            点击 291,1157
        ElseIf a = 36 Then
            点击 515,1393
        ElseIf a = 37 Then
            点击 738,1540
        End If
        Delay 1500
    ElseIf a > 37 and a < 41 Then
        点击 871, 1669
        ShowMessage "薄雾"
        Delay 6000
        点击 528,1713
        Delay 3000
        Swipe  420, 634,356, 1568, 50
        Delay 100
        Delay 1000
        点击 385,1656
        If a >38 Then 
            Delay 2000    	
            点击 532, 1116
        End if
        If a = 40 Then
            Delay 2000
            TracePrint "40"
            点击 539,1201
        End If
        Delay 1500
    ElseIf a > 40 and a < 44 Then
        点击 871, 1669
        TracePrint "火蓝之心"
        ShowMessage "火蓝之心"
        Delay 3000
        If a = 43 Then 
            点击 443, 1609
            Delay 2000
            TracePrint "42"
            点击 604, 1521
            Delay 1500
        Else 
            点击 561, 1585
            Delay 3000
            For 3
                Swipe 356, 1568,420, 634,  50
                Delay 100
                Delay 1000
            next
            
            点击 410, 58
            Delay 1500
            If a = 41 Then 
                点击 577, 7
                Delay 1500
            End If
        End If
    ElseIf a = 44 Then
        点击 738, 1765
        TracePrint "密林悍将"
        ShowMessage "密林悍将"
        Delay 5000
        点击 561, 1632
        Delay 2000
        For 3
            Swipe 356, 1568,420, 634,  50
            Delay 100
            Delay 1000
        next
        点击 468, 279
        Delay 1500
    ElseIf a > 44 and a<48 Then
        点击 871, 1669
        ShowMessage "孤岛风云"
        Delay 6000
        点击 838,1734
        Delay 3000
        Swipe  420, 634,356, 1568, 50
        Delay 100
        Delay 1000
        点击 385,1656
        If a =45 Then 
            Delay 2000    	
            点击 474,1262
        elseIf a = 46 Then
            Delay 2000
            点击 292,1260
        ElseIf a = 47 Then
            Delay 2000
            点击 292,1692
        End If
        Delay 1500
    ElseIf a > 47 and a<51 Then
        点击 871, 1669
        ShowMessage "画中人"
        Delay 6000
        点击 209,1728
        Delay 3000
        For 2
            Swipe  356, 1568,420, 634, 50
            Delay 100
        Next 
        Delay 1000
        点击 385,1656
        If a =48 Then 
            Delay 2000    	
            点击 499,81
        elseIf a = 49 Then
            Delay 2000
            点击 686,264
        ElseIf a = 50 Then
            Delay 2000
            点击 502,518
        End If
        Delay 1500
    ElseIf a = 51 or a=52 Then
        点击 486*1.5,1153*1.5
        TracePrint "源石尘行动"
        Delay 6000
        点击 404*1.5,146*1.5
        Delay 3000
        For 4
            Swipe  356, 1568,420, 634, 50
            Delay 100
        Next 
        Delay 1000
       
        If a =51 Then  	
            点击 312*1.5,404*1.5
        elseIf a = 52 Then
            点击 402*1.5,616*1.5
        
        End If
        Delay 1500
    ElseIf a = 53 or a=54 or a=55 Then
        点击 486*1.5,1153*1.5
        TracePrint "遗尘漫步"
        Delay 6000
        点击 254,1615
        Delay 3000
        For 4
            Swipe  356, 1568,420, 634, 50
            Delay 100
        Next 
        Delay 1000
       
        If a =53 Then  	
            点击 547,42
        elseIf a = 54 Then
            点击 373,267
        elseIf a = 55 Then
            点击 371,741        
        End If
        Delay 1500
    ElseIf a = 56 or a=57 or a=58 Then
        点击 881,1688
        TracePrint "覆潮之下"
        Delay 8000
        点击 414,1675
        Delay 3000
        For 4
            Swipe  356, 1568,420, 634, 50
            Delay 100
        Next 
        Delay 1000
       
        If a =56 Then  	
        elseIf a = 57 Then
            点击 394,170
        elseIf a = 58 Then
            点击 672,665        
        End If
        Delay 1500    
    ElseIf a = 59 or a=60 or a=61  Then
        点击 881,1688
        TracePrint "多索雷斯假日"
        Delay 6000
        点击 586,1569
        Delay 3000
        For 4
            Swipe  356, 1568,420, 634, 50
            Delay 100
        Next 
        Delay 1000
       
        If a = 59 Then 
            点击 599,160
        elseIf a = 60 Then
            点击 770,427
        elseIf a = 61 Then
            点击 783,902        
        End If
        Delay 1500        
    ElseIf a = 62 or a=63 or a=64 Then
        点击 881,1688
        TracePrint "长夜临光"
        Delay 6000
        点击 421,1635
        Delay 3000
        For 4
            Swipe  356, 1568,420, 634, 50
            Delay 100
        Next 
        Delay 1000
       
        If a = 62 Then 
            点击 564,377
        elseIf a = 63 Then
            点击 721,598
        elseIf a = 64 Then
            点击 332,750     
        End If
        Delay 1500
    ElseIf a = 65 or a=66 or a=67 Then
        点击 881,1688
        TracePrint "风雪过境"
        Delay 6000
        点击 591,1673
        Delay 3000
        For 4
            Swipe  356, 1568,420, 634, 50
            Delay 100
        Next 
        Delay 1000
       
        If a = 67 Then 
            点击 484,447
        elseIf a = 66 or a=65 Then
            点击 645,175
            If a = 65 Then 
                Delay 1500
                点击 771,23 
            End If
               
        End If
        Delay 1500
    ElseIf a = 68 or a=69 or a=70 Then
        点击 881,1688
        TracePrint "将进酒"
        Delay 6000
        点击 203,1514
        Delay 3000
        For 4
            Swipe  356, 1568,420, 634, 50
            Delay 100
        Next 
        Delay 1000
       
        If a = 68 or a=69 or a=70 Then 
            点击 534,106
            If a = 68 or a = 69 Then 
                Delay 1500
                点击 405,12
                If a = 68 Then 
                    Delay 1500
                    点击 278,7 
                End If
            End If
        End If
        Delay 1500
    ElseIf a = 71 or a=72 or a=73 Then
        点击 881,1688
        TracePrint "吾先导路"
        ShowMessage "吾先导路"
        Delay 6000
        点击 369,1684
        Delay 3000
        For 4
            Swipe  356, 1568,420, 634, 50
            Delay 100
        Next 
        Delay 1000
        If a = 71 Then 
            点击 568, 96
        ElseIf a = 72 Then
            点击 570,516
        ElseIf a = 73 Then
            点击 576,956
        End If
        Delay 1500
    ElseIf a = 74 or a=75 or a=76 Then
        点击 742,1733
        TracePrint "愚人号"
        ShowMessage "愚人号"
        Delay 6000
        If a = 74 Then 
            点击 351,394
            Delay 4000
            For 4
                Swipe  356, 1568,420, 634, 50
                Delay 100
            Next 
            Delay 1000
            点击 816,566
        Else 
            点击 222,523
            Delay 4000
            For 4
                Swipe  420, 634,356, 1568, 50
                Delay 100
            Next 
            Delay 1000
            If a = 75 Then 
                点击 455,1048
            Else 
                点击 618,1141
            End If
        End If       
        Delay 1500
    ElseIf a = 77 or a = 78 or a = 79 Then
        点击 742,1733
        TracePrint "尘影余音"
        ShowMessage "尘影余音"
        Delay 6000
        点击 237,1682
        Delay 2500
        For 4
            Swipe  356, 1568,420, 634, 50
            Delay 100
        Next
        Delay 800
        点击 476, 18 'LE7
        If a = 77 or a = 78 Then 
            Delay 1500
            点击 736,50'LE6
            If a = 77 Then 
                Delay 1500
                点击 586,72'LE5
            End If
        End If
        
        Delay 1500
    ElseIf a = 80 or a = 81  Then
        点击 742,1733
        TracePrint "绿野幻梦"
        ShowMessage "绿野幻梦"
        Delay 6000
        点击 666,1693
        Delay 2500
        For 4
            Swipe  356, 1568,420, 634, 50
            Delay 100
        Next
        Delay 800
        If a = 80  Then 
            点击 413,360
        elseIf a = 81 Then 
            Delay 1500
            点击 491,725
            
        End If
        
        Delay 1500
    ElseIf a = 82 or a = 83  Then
        点击 741,1743
        TracePrint "理想城"
        ShowMessage "理想城"
        Delay 6000
        点击 369,1642
        Delay 2500
        For 4
            Swipe  356, 1568,420, 634, 50
            Delay 100
        Next
        Delay 800
        If a = 82  Then 
            点击 643,138
        elseIf a = 83 Then 
            点击 387,380
            
        End If
        
        Delay 1500
    Else 
        
	
        
        If a = 9 Then
            ShowMessage "星期"&星期&"打绿石头_  1-  7"
            每局时间=1
            
	
            选章节(1)
            点击 401,1656
            Delay 1500
            点击 403,1259
            Delay 1500
            点击 404,1237
            Delay 1500
            点击 566,1122
            Delay 1500
            点击 559,1306
            Delay 1500
            点击 742,1122
            Delay 1500
            点击 738,1268
            Delay 1500
        ElseIf a = 2  or a = 6 or a = 11 or a = 12 or a = 18 or a = 22 Then
            选章节(4)
            If a = 22 Then 
                ShowMessage "星期"&星期&"打糖        _  4-  2"
                点击 402,1171
                Delay 1500
                每局时间=2
            Else 
            	
                点击 401,1764
                Delay 1500
                If a = 12 Then 
                    ShowMessage "星期" & 星期 & "铁        _S4-  1"
                    每局时间 = 2
                Else 
                    点击 397,1348's4-3
                    Delay 1500
                    点击 565, 1061
                    Delay 1500
                    If a = 18 Then 
                        ShowMessage "星期" & 星期 & "醇        _  4-  4"
                        每局时间 = 2
                    Else 
                        点击 700,1162
                        Delay 1500
                        If a = 11 Then 
                            ShowMessage "星期" & 星期 & "酮        _  4-  5"
                            每局时间 = 2
                        Else 
                            点击 427,1344's4-4
                            Delay 1500
                            点击 428,1188
                            Delay 1500
                            点击 428,1196'4-6
                            Delay 1500
                            点击 564,1082
                            Delay 1500
                            
                            点击 693,1143
                            Delay 1500
                            If a = 6 Then 
                                ShowMessage "星期" & 星期 & "研磨石_  4-  8"
                                每局时间 = 2
                            Elseif a=2 
                                点击 563,1084
                                Delay 1500
                                ShowMessage "星期" & 星期 & "海胆    _  4-  9"
                                每局时间 = 2
                            End If
                           
                        End If
                    End If
                End If	
            End If
        ElseIf a=3 Then
            选章节(2)
            For 4
                Swipe  356, 1568,420, 634, 50
                Delay 100
            Next
            Delay 900
            ShowMessage "星期" & 星期 & "海胆    _  2-10"
            每局时间 = 2
            点击 428,897
            Delay 1500
        ElseIf a=5 Then
            选章节(3)
            Delay 900
            ShowMessage "星期" & 星期 & "锰        _  3-  2"
            每局时间 = 2
            点击 572,1368
            Delay 1500
        
        ElseIf a = 4 or a = 10 or a = 17 or a = 23 or a = 24 or a = 25 Then
            选章节(8)
            点击 716,1410'r8-2
            Delay 1500
            If a = 17 Then 
                ShowMessage "星期" & 星期 & "酯_7-4"
                每局时间 = 2
            Else 
                点击 944,860
                Delay 1000
                点击 712,1908'r8-5
                Delay 1500
                点击 944,860
                Delay 1000
                点击 844,1393'r8-7
                Delay 1500
                If a = 24 Then 
                    ShowMessage "星期" & 星期 & "炽合金_R8-  7"
                    每局时间 = 2
                Else 
                    点击 944,860
                    Delay 1000
                    点击 722,1827'r8-10
                    Delay 1500
                    If a = 4 Then 
                        ShowMessage "星期" & 星期 & "锰_R8-10"
                        每局时间 = 2
                    Else 
                        点击 720, 1163
                        Delay 1500
                        If a = 25 Then 
                            ShowMessage "星期" & 星期 & "电路_R8-11"
                            每局时间 = 3
                        Else 
                            点击 944,860
                            Delay 1000
                            点击 550, 1723
                            Delay 1500
                            If a = 23 Then 
                                ShowMessage "星期" & 星期 & "凝胶_JT8-  2"
                                每局时间 = 3
                            Else 
                                点击 551, 1255
                                Delay 1500
                                ShowMessage "星期" & 星期 & "酮_JT8-  3"
                                每局时间 = 3
                       
                            End If
                    		
                        End If
                    End If
                End If
            End If
        ElseIf a=7 or a=15 or a=21 Then
            选章节(7)
            点击 386, 1782
            Delay 1500
            If a = 21 Then 
                ShowMessage "星期" & 星期 & "酯_7-4"
                每局时间 = 2
            Else 
                点击 904,1044
                Delay 1000
                点击 508,1754'7-6
                Delay 1500
                点击 904,1044
                Delay 1000
                点击 683,1753'7-9
                Delay 1500
                点击 904,1044
                Delay 1000
                点击 362,1863'7-12
                Delay 1500
                点击 904,1044
                Delay 1000
                点击 527,1675'7-15
                Delay 1500
                If a=15 Then 
            		
                    ShowMessage "星期" & 星期 & "装置_7-15"
            		
            		
                    每局时间 = 2
                Else 
                    点击 904,1044
                    Delay 1000
                    点击 372, 1853's7-2
                    Delay 1500
                    点击 561,1042'7-17
                    Delay 1500
                    If a = 7 Then 
                        点击 562, 1483
                        ShowMessage "星期" & 星期 & "研磨石_7-17"
                    End If
                End If
            	
            End If
            
            
            Delay 1500
        
        ElseIf a = 20 Then
            选章节(2)
            点击 561,1903
            Delay 1500
            点击 567,1203
            Delay 1500
            点击 563,1193
            Delay 1500
            点击 424,1107
            Delay 1500
            点击 428,1194
            Delay 1500
            点击 569,1367
            Delay 1500
            点击 572,1195
            Delay 1500
            点击 412,1083
            Delay 1500
            点击 428,1217
            Delay 1500
            点击 426,1360
            Delay 1500
            点击 430, 1231
            Delay 1500
            ShowMessage "星期" & 星期 & "酯        _  2-  6"
            每局时间 = 1
        End If
   		
    End If
    KeepCapture 
    If a = 74 or a = 75 or a = 76 Then 
        If CmpColor(206,1631, "FFFFFF", 0.9) = -1 Then 
            点击 205, 1683
            Delay 1500
        End If
    Else
        If CmpColor(184, 1601, "191919", 0.9) > -1 or CmpColor(184, 1601, "FFFFFF", 0.9) = -1 Then 
            点击 184, 1601
            Delay 1500
        End If
    End If
End Sub

Sub 选章节(a)
    返回主页 
    TracePrint "选择章节",a
    点击 778, 1474'终端
    Delay 1500
    点击 80,351'主题曲
    Delay 1500
    For 主题曲数量
        点击 870,94
        Delay 2000
    Next
    Delay 1500
    If a <= 3 Then 
        For 3
            Swipe 515,1408, 518,1885, 100
    		
            delay 1000
        Next
        Delay 1000
        点击 530,1418'章节0
        Delay 2500
        If a > 0 Then 
            For a
                点击 73, 1766
                Delay 2500 
            Next
        End If
    	
    ElseIf a <= 8 Then
        点击 255,98
        Delay 2500
        For 5
            Swipe 517,941, 531,1413, 100
            delay 1000
        Next
        Delay 1000
        点击 530,1418'章节4
        Delay 2500
        If a > 4 Then 
            For a-4
                点击 73, 1766
                Delay 2500 
            Next
        End If
    ElseIf a <= 10 Then
        点击 255,98
        Delay 2500
        点击 255,98
        Delay 2500
        For 5
            Swipe 517,941, 531,1413, 100
            delay 1000
        Next
        Delay 1000
        点击 530,1418'章节9
        Delay 2500
        If a > 8 Then 
            For a-8
                点击 73, 1766
                Delay 2500 
            Next
        End If
    End If
    For 4
        Swipe 420, 634, 356, 1568, 50
        Delay 100
    Next
    Delay 900
End Sub

Sub 登录(a)
    TracePrint "登录"&a
	
    Rem 标记1
    If 模式=0 or 模式 =3 or 模式=4 or 模式=5 or 模式=8 Then 
        If 等待(开始唤醒, 1000, 30, false) = true Then 
            点击 317,952
        End If
    Else
        If 等待(开始唤醒, 1000, 30, false) = true Then 
            点击(开始唤醒(0),开始唤醒(1))
        End If
	
        Delay 2000
        If 等待(账号登录, 1000, 30, false) = true Then 
            点击(账号登录(0),账号登录(1))
        End If
        Delay 3000
    
        点击 424, 852
        Delay 1500
        InputText 账号(a)
        Delay 700
        点击 62,1823
        Delay 1000
        ShowMessage "第" & a & "个号"
        TracePrint "第" & a & "个号"
        点击 350,828
        Delay 1000
        InputText 密码(a)
        Delay 700
        点击 62,1823
        Delay 700
    
        点击 198, 957
    End If
    Delay 10000
    
    
    If 等待(获得物资, 2000,15, true) = true Then 
        ShowMessage "检测签到"
        等待 签到, 1000, 5, true
        Delay 7000
       
        
        
        
        KeepCapture
        If 判断(活动签到) = true Then 
            ShowMessage "活动"
            点击 481,819
            点击 461,1088
            点击 428,1380
            点击 468,1645
            Delay 5000
            等待 获得物资, 1000, 5, true
            Delay 1000
            点击 933,1847
            Delay 2500
        ElseIf 判断(活动收集) = true Then
            ShowMessage "活动"
            点击 416,641
            点击 402,892
            点击 623,1099
            点击 607,1382
            点击 621,1642
            Delay 5000
            等待 获得物资, 1000, 5, true
            Delay 1000
            点击 活动收集(0), 活动收集(1)
            Delay 2000
        End If
        KeepCapture 
        If 判断(领红包) = true Then 
            ShowMessage "领红包"
            点击 478,684
            Delay 500
            点击 623,1010
            Delay 500
            点击 445,1322
            Delay 500
            点击 255,1695
            等待 获得物资, 1000, 5, true
            Delay 1000
            点击 领红包(0), 领红包(1)
            Delay 4000
        End If
        KeepCapture
        If 判断(开采许可) = true Then 
            ShowMessage "开采许可"
            点击 244,1588
            Delay 5000
            等待 获得物资, 2000, 10, true
            Delay 1000
            点击 1001,1831
            Delay 4000 
        End If
        KeepCapture 
        If 判断(惊奇墙) = true Then 
            ShowMessage "惊奇墙"
            点击 630, 847
            Delay 500
            点击 644, 1083
            Delay 500
            点击 643, 1256
            Delay 500
            点击 245, 1693
            等待 获得物资, 1000, 5, true
            Delay 1000
            点击 领红包(0), 领红包(1)
            Delay 4000
        End If
    End If	
    等待 (公告, 1000, 7, true)
    等待 主页, 1000, 100, false
    
    ShowMessage "领邮件"
    Delay 5000
    TracePrint "领邮件"
    点击 1020, 291
    Delay 4000
    点击 77, 1715
    等待 获得物资, 1000, 5, true
    Delay 1000
    点击 1014, 122
    Delay 2000
    等待 主页, 2000, 15, false
    KeepCapture
    If 判断(主页) = false Then 
        KillApp "com.hypergryph.arknights"
        Delay 5000
        RunApp "com.hypergryph.arknights"
        Delay 20000
        等待 开始游戏, 2000, 60, true
        Delay 10000
        等待 登录界面1, 2000, 30, false
        Goto 标记1
    End If
    TracePrint "主页"
End Sub

Sub 切换()
    Call 返回主页()
    TracePrint "切换"
    点击 主页(0),主页(1)
    Delay 2000
    //    Swipe 235, 1026, 742, 1038, 600
    //    Delay 1500
    //    点击 306, 939
    点击 172,1291
    Delay 1000
    
    
    点击 278,1461
    Delay 5000
    If 等待(开始唤醒, 1000, 5, false) = false Then 
        TracePrint "切换失败,重启游戏"
        KillApp "com.hypergryph.arknights"
        Delay 5000
        RunApp "com.hypergryph.arknights"
        Delay 20000
        等待 开始游戏, 2000, 60, true
        Delay 10000
        等待 登录界面1, 2000, 30, false
    End If
End Sub

Sub 宿舍换干员()
    TracePrint "宿舍换干员"
    Delay 1500
    If 等待(宿舍进驻, 1000, 4, false) = false Then 
        点击 670, 97
        Delay 4500
    End If
    点击 1032,1803
    Delay 1500
    点击 823,1569
    Delay 1500
    点击 724,726
    Delay 300
    点击 395,724
    Delay 300
    点击 732,939
    Delay 300
    点击 398,931
    Delay 300
    点击 745,1143
    Delay 500
    点击 60,1777
    Delay 1500
    KeepCapture 
    If CmpColorEx("66|1340|FFFFFF,28|1623|966A10,43|613|262626", 0.9) = 1 Then 
        点击 44,1622
        Delay 2500
    End If
    KeepCapture 
    If 判断(换工作) = true Then 
        Delay 500
        点击 换工作(0), 换工作(1)
        Delay 2500
    End If
    等待 宿舍进驻,1000,5,false
    点击 1010, 116
    Delay 2500
    回(基建)
End Sub

Sub 厂换干员()
    TracePrint "厂换干员"
    点击 113, 488
    Delay 2500
    点击 67, 766
    Delay 1000
    点击 62, 1773
    Delay 4000
    点击 113, 488
    Delay 1500
    点击 724,726
    Delay 500
    点击 395,724
    Delay 500
    点击 732,939
    Delay 1000
    点击 62, 1773
    Delay 2500
End Sub

Sub 会客厅()
    TracePrint "会客厅"
    Rem 会客
    回(基建)
    点击 712, 1689
    Delay 2000
    
    点击 135,713
    Delay 1500
    
    ShowMessage "检测party结束"
    等待 交流结束, 1000, 4, true
    Delay 200
    If 等待(会客厅界面, 1000, 5, false) = false Then 
        Goto 会客
    End If
    点击 658, 1804
    Delay 5000
    点击 48, 1652
    Delay 2500
    点击 211, 1148
    Delay 1000
	
	
	
    点击 819,1790
    Delay 1500
    点击 214,1213
    Delay 1500
    点击 924,1479
    Delay 1500
	
    If 自动送线索 = true Then 
        点击 494, 1795'fenxiang
        Delay 5000
        Call 给线索()	
    End If
	
	
    点击 695,570'1
    Delay 1500
    KeepCapture 
    If CmpColor(860,238,"0168FF",0.9) > -1 Then '1		
        点击 705, 1642
        Delay 2000
    End If
		
    
    If CmpColor(753,543,"0168FF",0.9) > -1 Then '2
        点击 627,460'2
        Delay 1500
        点击 705, 1642
        Delay 2000
    End If
	
    If CmpColor(889,848,"0168FF",0.9) > -1 Then '3
        点击 769,763
        Delay 1500
        点击 705, 1642
        Delay 2000
    End If
	
    If CmpColor(824,1170,"0168FF",0.9) > -1 Then '4
        点击 704,1088
        Delay 1500
        点击 705, 1642
        Delay 2000
    End If
	
    If CmpColor(427,662,"0168FF",0.9) > -1 Then '5
        点击 304,567
        Delay 1500
        点击 705, 1642
        Delay 2000
    End If
	
    If CmpColor(515,974,"0168FF",0.9) > -1 Then '6
        点击 395,887
        Delay 1500
        点击 705, 1642
        Delay 2000
    End If
	
    If CmpColor(479,322,"0168FF",0.9) > -1 Then '7
        点击 363,234
        Delay 1500
        点击 705, 1642
        Delay 2000
    End If
		
    点击 116, 1158
    Delay 2000
    
    
    
    点击 698,181
    Delay 1500
    点击 53,756
    Delay 500
    点击 738,727
    Delay 300
    点击 391,728
    Delay 300
    点击 54,1770
    Delay 2500
    KeepCapture
    If CmpColor(132,1205,"FFFFFF",0.9) > -1 Then '可以开party
        TracePrint "可以开party"
        点击 127, 1017
        Delay 2000
    Else 
        TracePrint "无法开party"
        点击 1010, 116
        Delay 1500
    End If	
		
    
    点击 1010, 116
    Delay 2500
    等待 基建,1000,5,false
End Sub

Sub 给线索()
    TracePrint "给线索"
    Dim 横,竖,页
    Dim 给出
    Do 
        KeepCapture 
        If CmpColor(632, 298, "EBEBEB", 0.9) > -1 Then 
            给出 = false
            TracePrint "选择线索"
            点击 632, 298
            Delay 1000
            For 好友页
                点击 59,1681
                Delay 300
            Next
           
            For 页 = 0 To 好友页
                KeepCapture 
                For 竖 = 0 To 3
                    For 横 = 0 To 6
                        If CmpColor(944-222*竖, 1269+64.5*横, "2A7BF4", 0.9) > -1 Then 
                            If 给(竖, 页, 横) = false Then 
                                给(竖, 页, 横) = true
                                TracePrint "线索 "&横+1&" 给第 "&页+1&" 页第 "&竖+1&" 个好友"
                                ShowMessage "线索 "&横+1&" 给第 "&页+1&" 页第 "&竖+1&" 个好友"
                                点击 886 - 222 * 竖, 1800
                                Delay 5000
                                给出 = true            					
                                Exit For            					
                            End If            				
                        End If
                    Next
                    If 给出 = true Then 
                        Exit For
                    End If
                Next
                If 给出 = true Then 
                    Exit For
                Else 
                    点击 62,1815
                    Delay 500
                End If
                
            Next
            If 给出 = False Then 
                TracePrint "线索 "&横+1&"全都有了"
                点击 886, 1800
                Delay 5000
            End If
        Else 
            点击 1027, 1866
            Delay 1000
            Exit Do 
        End If
    Loop
End Sub

Sub 好友交流()
    TracePrint "好友交流"
    Dim i=0
    点击 1022,401
    Delay 1500
    点击 1023,1795
    Delay 1500
    If 等待(退出基建, 1000, 5, false) = true Then 
        点击 312, 1263
    ElseIf 等待(十连, 1000, 5, false) = true Then
    
        TracePrint "退出基建错误,退出脚本"
        SnapShot "/sdcard/退出基建错误.png"
        EndScript
    End If
    
    Delay 9000
    回(好友界面) 
    点击 745, 191
    Delay 1500
    点击 836, 1496
    Delay 10000
    Do    	
        KeepCapture 
        If CmpColor(92, 1829, "0658D1", 0.9) > -1 Then 
            TracePrint "下一个好友"
            点击 92, 1829
            Delay 10000
            i=i+1
        Else 
            Exit Do 
        End If
    Loop until i>9
End Sub

Sub 基建每日()
    TracePrint "基建每日"
    返回主页 
    森蚺中枢=false
    夕中枢 = false
    迷迭香=false
    Delay 2500
    点击 216,1415
    Delay 10000
    回(基建)
    Delay 3000
    Call 识别基建左边()
    //    KeepCapture
    //    If CmpColor(941,1771,"DBA42B",0.9)>-1 Then 
    //    	点击 939, 1782
    //    	Delay 1000
    //    	点击 40, 382
    //   		Delay 1000
    //    	点击 40, 382
    //    	Delay 1000
    //    	点击 40, 382
    //    	Delay 1000
    //    	点击 32, 122
    //    	Delay 1000
    //    elseIf CmpColor(867,1777,"DBA42B",0.9)>-1 Then 
    //    	点击 860,1792
    //    	Delay 1000
    //    	点击 40, 382
    //   		Delay 1000
    //    	点击 40, 382
    //    	Delay 1000
    //    	点击 40, 382
    //    	Delay 1000
    //    	点击 32, 122
    //    	Delay 1000
    //    End If
    
    点击 884, 1887'蓝色
    Delay 2000
    TracePrint "点三下左下角收菜"
    点击 40, 382
    Delay 2500
    点击 40, 382
    Delay 2500
    点击 40, 382
    Delay 2500
    点击 32, 122
    Delay 1000
    点击 934,1853'红色
    Delay 2000
    TracePrint "点三下左下角收菜"
    点击 40, 382
    Delay 2500
    点击 40, 382
    Delay 2500
    点击 40, 382
    Delay 2500
    点击 32, 122
    Delay 1000
    /////////////////宿舍换干员
    TracePrint "基建宿舍"
    点击 616, 1184
    Delay 4000
    If 等待(宿舍进驻, 1500, 4, false) = false Then 
        点击 670, 97
        Delay 4500
    End If
    Call 宿舍换干员()
    点击 461, 1349
    
    等待 宿舍进驻,1500,10,false
    Call 宿舍换干员()
    点击 290,1201
    等待 宿舍进驻,1500,10,false
    Call 宿舍换干员()
    
    点击 143, 1356
    等待 宿舍进驻,1500,10,false
    Call 宿舍换干员()
    Delay 1000
    回 (基建)
    
    //////////////////贸易站
    If 换贸易站干员 = true Then 
        ShowMessage "贸易站"
        TracePrint "贸易站"
        Rem 贸易
        点击(房间(2*贸易站),房间(2*贸易站+1))
        Delay 1500
        
        TracePrint "防止新产生订单再点一次"
        点击(房间(2*贸易站),房间(2*贸易站+1))
        Delay 1500
        
        点击 176,115
        Delay 1500
        点击 176,115
        Delay 1500
        If 等待(贸易站界面, 1000, 5, false) = false Then 
            KeepCapture
            If 判断(基建) = true Then 
                Goto 贸易
                //            Else 
                //                TracePrint "进入贸易站错误,脚本结束"
                //                SnapShot "/sdcard/进入贸易站错误.png"
                //                EndScript
            End If
            
        End If
        For i = 0 To 4 
            If CmpColor(265+123*i, 125, "FFB100", 0.9) > -1 and CmpColor(264+123*i, 108, "242424", 0.9) > -1 Then 
                贸易站数量 =5- i
                Exit For
            End If
        Next
        TracePrint "贸易站数量"&贸易站数量
        Delay 1500
        For i= 1 to 贸易站数量
            点击 (775 + 123 - i * 123, 178)
		
            Delay 2000

            Call 贸易站选干员()
            Delay 1500
        Next 
	
        点击 1010, 116
        Delay 1500
        点击 1010, 116
        Delay 2500
        回(基建)
    End If
    ///////////////控制中心
    If 换中枢干员 = true Then 
        TracePrint "控制中心"
        点击 827,1270
        Delay 1500
        If 等待(宿舍进驻, 1000, 5, false) = false Then 
            TracePrint "点击进驻"
            点击 633,109
            Delay 1500
        End If
    
        
        KeepCapture 
        If 等待(十连, 1000, 5, false)=false Then 
            点击 305, 1258
            Delay 1500
        Else 
            TracePrint "错误十连"
            Delay 1500
        End If
    
    
        Call 控制中枢选干员()
        //	点击 1010, 116
        回(基建)
    End If
    
    
    ////////////////////////制造厂
    If 换建造站干员 = true Then 
        TracePrint "制造厂换干员"
        ShowMessage "制造厂换干员"
        Rem 制造
        点击(房间(2*建造站),房间(2*建造站+1))
        Delay 1500
        TracePrint "防止新产生狗粮再点一次"
        点击(房间(2*建造站),房间(2*建造站+1))
        Delay 1500
        点击 159, 121
        Delay 1500
        点击 159, 121
        If 等待(制造站界面, 1000, 3, false) = false Then 
            KeepCapture 
            If 判断(基建) = true Then 
                Goto 制造    
            End If    
        End If
        For i = 0 To 4 
            If CmpColor(265+123*i, 125, "00D8FF", 0.9) > -1 and CmpColor(264+123*i, 108, "242424", 0.9) > -1 Then 
                建造站数量 =5- i
                Exit For
            End If
        Next
        TracePrint "建造站数量"&建造站数量
        For i = 1 To 建造站数量
            Delay 1500
            点击 775 + 123 - i * 123, 178
            Delay 500
            点击 116, 1682
            Delay 2500
            KeepCapture 
            
            If 判断(制造赤金) = true Then 
                Call 制造站选干员2()
            Else 
                Call 制造站选干员1()
            End If
            //                Call 制造站选干员(9)
            If i = 建造站数量 - 1 Then 
                点击 271, 1843
                Delay 1500
                点击 572,1440
                Delay 500
                点击 202,1431
                Delay 1500
            End If
            
            点击 771, 1463
            Delay 1500
            点击 173,1433
            Delay 2500
        Next	
        点击 1010, 116
        Delay 1500
        点击 1010, 116
        Delay 2500
        回(基建)
    End If
	
	
    
	
    ////////会客厅
    //	点击 712, 1689
    //	Delay 300
    Call 会客厅()
	
    ///////////////////办公室
    ShowMessage "办公室"
    TracePrint "办公室"
    点击 465, 1888
    Delay 2000
    点击 164, 111
    Delay 1500
	
    点击 328,727
    Delay 300
    点击 731, 720
    Delay 500
    点击 731, 720
    Delay 500
    Call 办公室选干员()
    点击 54,1770
    Delay 3500
    点击 1010, 116
    Delay 2500
    回(基建)
    ///////////////////加工站
    ShowMessage "加工站"
    TracePrint "加工站"
    点击 575,1859
    Delay 2000
    点击 164, 111
    Delay 1500	
    点击 556,133
    Delay 1500
    
    
    点击 328,727
    Delay 300
    点击 731, 720
    Delay 500
    点击 54,1770
    Delay 3500
    点击 1010, 116
    Delay 1500
    点击 1010, 116
    Delay 2500
    回(基建)
    ///////////////发电厂
    If 换发电站干员 = true Then 
        TracePrint "发电站换干员"
        ShowMessage "发电站"
        For i = 1 To 发电站数量
            点击 房间(2 * 发电站(i - 1)), 房间(2 * 发电站(i - 1) + 1)
            Delay 1500
            If 等待(宿舍进驻, 1000, 5, false) = false Then 
                TracePrint "点击进驻"
                点击 633,109
                Delay 1000
            End If
            等待 宿舍进驻,1500,10,false
            点击 1033,1797
            Delay 1000
            点击 320,1744
            Delay 1500
            点击 843,1569
            Delay 1500
            Call 发电站选干员()
            Delay 300
            点击 69,1779
            Delay 2500
            点击 1010, 116
            Delay 2500
            回(基建)
        Next        
    End If
	
	
	
	
	
    
   
    ////////////////////好友交流
    If 轮次 < 3 or 模式=0 Then 
        Call 好友交流()
    End If
   
	
	
    /////////////////////////信用商店
    If 买信用商店 = true Then 
        TracePrint "信用商店"
        等待 返回,1000,5,false
        点击 1018, 400
        Delay 1500
        点击 683, 1797
        Delay 15000
        回(采购中心)
        Delay 3000
        点击 919,1802
        Delay 1500
        点击 1020, 1530
        If 等待(获得物资, 1000, 5, false) = true Then 
            点击 获得物资(0), 获得物资(1)
            Delay 1500
        	
        End If
        
        
        Delay 1000
        KeepCapture
        For i = 0 To 1
            For j = 0 To 4
                白票=((CmpColor(761 - 381 * i, 177 + 379.5 * j, "B7B7B7", 0.9) > -1) and (CmpColor(631 - 381 * i, 271 + 379.5 * j, "D5BDCE", 0.9) > -1)) 
                卷2 = (CmpColor(674 - 381 * i, 106 + 379.5 * j, "FBB300", 0.9) > -1) and (CmpColor(633 - 381 * i, 116 + 379.5 * j, "25705F", 0.9) > -1)
                If 卷2 = true or 白票=true Then 
                    点击 (663-381*i,207+380*j)
                    Delay 1500
                    点击 202,1377
                    Delay 2500
                    点击 919,1802
                    Delay 1500	
                End If
            Next
        Next

        KeepCapture
        For i = 0 To 1
            For j = 0 To 4
                If CmpColor(539 - 381 * i, 71 + 380.5 * j, "585858", 0.9) > -1 Then 
                    点击 (663-381*i,207+380*j)
                    Delay 1500
                    点击 202,1377
                    Delay 2500
                    点击 919,1802
                    Delay 1500	
                End If
            Next
        Next
    End If
	
	
	
	
	
    ////////////////////////日常
    点击 1018, 406
    Delay 1500
    点击 1024, 1634
    Delay 15000
    回(任务界面)
    TracePrint "收日常"
    点击 1024,1074'日常
    Delay 1500
    Dim iii=0
    Do
        点击 872, 1691
        Delay 2000
        KeepCapture 
        If CmpColor(866, 1691, "BA984C|313131|8F8F8F", 0.9) > -1  and 判断(返回)=true Then 
            Exit Do 
        End If
        iii = iii + 1
        If iii  > 10 Then 
            Exit Do 
        End If
    Loop
    Delay 2500
    iii=0
    点击 1028,1415
    Delay 2500
    TracePrint "收周常"
    Do
        点击 872, 1691
        Delay 1500
        KeepCapture 
        If CmpColor(866, 1691, "BA984C|313131|8F8F8F", 0.9) > -1 and 判断(返回)=true Then 
            Exit Do 
        End If
        iii = iii + 1
        If iii  > 10 Then 
            Exit Do 
        End If
    Loop
    Delay 1500
    返回主页()
End Sub

Sub 识别基建左边()
    TracePrint "识别基建左边房间"
    Dim 颜色
    贸易站数量 = 0
    建造站数量 = 0
    发电站数量 = 0
    KeepCapture 
    For i = 0 To 2'行
        For j = 0 To 2'列
            颜色 = CmpColor(583-i*159, 167+j*318-(i mod 2)*158, "FFCC33|00CCFF|66FFCC", 0.9)
            //            TracePrint i,j,颜色
            If 颜色 = 0 Then 
                If 贸易站数量 = 0 Then 
                    贸易站=3*i+j
                End If
                贸易站数量 = 贸易站数量+1
            ElseIf 颜色 = 1 Then
                If 建造站数量 = 0 Then 
                    建造站=3*i+j
                End If
                建造站数量 =建造站数量 +1
            ElseIf 颜色 = 2 Then
                发电站(发电站数量)=3*i+j
                发电站数量 = 发电站数量 +1
            End If
        Next
    Next
	
End Sub
Sub 基建干员翻页()
    If 宽 = 720 Then 
        TouchDown 534,1903,1    
        Delay 200
        TouchMove 534, 477, 1, 200
        Delay 100
        TouchMove 534, 477, 1, 200     
        Delay 400
        TouchUp 1
        Delay 200
    Else 
        TouchDown 534,1903,1    
        Delay 200
        TouchMove 534, 476, 1, 200
        Delay 100
        TouchMove 534, 476, 1, 200     
        Delay 400
        TouchUp 1
        Delay 200
    End If
	
End Sub

Sub 基建干员翻页左()
    Delay 300
    For 3
        //        TouchDown 534, 620,1    
        //        Delay 200
        //        TouchMove 534,1903, 1, 200
        //        Delay 100
        //        TouchMove 534,1903, 1, 200     
        //        Delay 400
        //        TouchUp 1
        Swipe 534, 620,534,1903,50
        Delay 200
    Next
    Delay 300
End Sub

Sub 基建选择干员(arr)
    Dim 循环次数=ubound(arr)
    Dim 干员
    Dim n=0
    Delay 500
    For Each i In arr
        干员 = i
        If 干员(1) < 6 Then 
            点击 776 - 421 * 干员(0), 739 + 216 * 干员(1)
            n = n + 1
            Delay 500
        End If
    Next
	
    If n <=循环次数 Then   
    
    
        Call 基建干员翻页()
        For Each i In arr
            干员 = i
            If 干员(1) >= 6 and 干员(1) < 12 Then 
                点击 776 - 421 * 干员(0), 739 + 216 * (干员(1)-6)
                n = n + 1
                Delay 500
            End If
        Next
    End If

    If n <=循环次数 Then 
        Call 基建干员翻页()
        For Each i In arr
            干员 = i
            If 干员(1) >= 12 and 干员(1) < 18 Then 
                点击 776 - 421 * 干员(0), 739 + 216 * (干员(1)-12)
                n = n + 1
                Delay 500
            End If
        Next
    End If
    Call 基建干员翻页左()
	
End Sub

Sub 自动公招()
    
    
    等待 主页, 1000, 5, false
    TracePrint "自动公招"
    点击 311, 1514
    等待 公开招募, 1000, 5, false
    Delay 1000
    
   
    
    
    KeepCapture 
    If CmpColorEx("523|358|D69407,910|223|0095ED,871|247|FFFFFF",0.9) =1 Then 
        点击 507, 718
        If 等待(公招skip, 1000, 10, false) = true Then 
            Call 收干员()   	        	
        End If
        点击 507, 718
        Delay 1000
        
        KeepCapture 
        If  等待(公招界面, 1000, 10, false) = true  Then 
            Call 公招()
        End If
    Else 
        //        公招信息=公招信息&"第"&目前账号&"号第1号公招未识别。"
    End If
    Delay 500
    KeepCapture
    If CmpColorex("506|1100|ECAA1E,909|659|0098F2,872|247|FFFFFF", 0.95) =1 Then 
        点击 502,1013
        Delay 6000
        If 等待(公招skip, 1000, 10, false) = true Then 
            Call 收干员()   	        	
        End If
        点击 502,1013
        Delay 1000
        If 等待(公招界面, 1000, 10, false) = true Then 
            Call 公招()
        End If
    Else 
        //        公招信息=公招信息&"第"&目前账号&"号第2号公招未识别。"
    End If
    Delay 500
    KeepCapture
    If CmpColorex("115|641|D99703,909|659|0098F2,871|246|FFFFFF", 0.95) =1 Then 
        点击 89,686
        Delay 6000
        If 等待(公招skip, 1000, 10, false) = true Then 
            Call 收干员()   	        	
        End If
        点击 89,686
        Delay 1000
        If  等待(公招界面, 1000, 10, false) = true  Then 
            Call 公招()
        End If
    Else 
        //        公招信息=公招信息&"第"&目前账号&"号第3号公招未识别。"
    End If
    Delay 500
    KeepCapture
    If CmpColorex("127|1138|DE9C08,909|659|0098F2,871|246|FFFFFF", 0.95) =1 Then 
        点击 92,1151
        Delay 6000
        If 等待(公招skip, 1000, 10, false) = true Then 
            Call 收干员()   	        	
        End If
        点击 89,1576
        Delay 1000
        If  等待(公招界面, 1000, 10, false) = true  Then 
            Call 公招()
        End If
    Else 
        //        公招信息=公招信息&"第"&目前账号&"号第4号公招未识别。"
    End If
    
    
    //    TracePrint 公招信息
    Delay 1000
    Call 返回主页()
    
End Sub

Sub 自动潜能()
	
    返回主页()
    KeepCapture 
    //	TracePrint CmpColor(619,1562, "0168FF", 0.9)
    If CmpColor(619,1562, "0168FF", 0.9) > -1 Then 
        TracePrint "自动潜能"
        点击 619,1562
        Delay 2500
        Call 潜能()
        点击 返回(0), 返回(1)
        Delay 1500
    End If
    //	TracePrint "11"
    返回主页()
End Sub

Sub 潜能()
    Dim 上黄点=array(947,59,949,1674,"0369FF","3|9|0168FF")
    Dim 下黄点=array(470,59,472,1674,"0369FF","3|9|0168FF")
    For 8
        Do
            KeepCapture 
            If 判断(上黄点) = true or 判断(下黄点)=true Then 
                点击 intX* 1080/GetScreenX(), intY* 1920/GetScreeny()
                Delay 2500
                点击 726, 1709
                Delay 2000
			
                Do
                    点击 240, 1485
                    Delay 2000
                    KeepCapture 
                    If CmpColor(441, 709, "FFAC39", 0.9) > -1 Then 
                        点击 232, 1089
                        Delay 3000
                    Else 
                        点击 214, 776
                        Delay 1500
                        Exit Do 
                    End If
                Loop
                点击 返回(0), 返回(1)
                Delay 1500
                点击 返回(0), 返回(1)
                Delay 1500
            Else 
                Exit Do 
            End If
        loop
        Swipe 512, 1684, 512, 253, 900
        Delay 1000
    Next
End Sub

Sub 公招()
    
    Delay 1000
    //    Rem 标记2
    
    If 识别方式 = 0 Then 
        KeepCapture 
        ret = zm.OcrBaiDuAll(360* GetScreenX()/1080 ,566* GetScreeny()/1920,537* GetScreenX()/1080,1278* GetScreeny()/1920)
    	   
        TracePrint "识别结果:",ret["words_result_num"]
        Delay 200    
        tags = ret["words_result"]
        //    TracePrint zm.VarInfo(tags) 	
        ub=0
        For Each i In tags
            t=i
            tag(ub) = t["words"]
            tag位置(ub * 2) = t["location"]["left"]* 1080/GetScreenX() + 360
            tag位置(ub * 2 + 1) = t["location"]["top"]* 1920/GetScreeny() + 566
            TracePrint tag(ub),tag位置(ub * 2),tag位置(ub * 2 + 1)
            If zm.arraysearch(标签, tag(ub)) = -1 Then 
            
                TracePrint ub, tag(ub) & "有标签未识别"
                //            Goto 标记2
                点击 返回(0), 返回(1)
                Delay 1000
                Exit sub
            End If            
            ub = ub + 1	
        Next
        If ret["words_result_num"] <> 5 Then 
            ShowMessage "有tag未识别" 	
            点击 返回(0), 返回(1)
            Delay 1000
            Exit Sub
        End If
    ElseIf 识别方式 = 1 Then
        Dim 完成识别
        Dim 公招字典="公招tag"&宽&".lib"
        TracePrint 公招字典
        TracePrint TURING.Lib_Load(临时目录 & 公招字典)
        
        完成识别=0
        For i = 0 To 4
            tag位置(i * 2) = (480-i\3*108)/ 1080*GetScreenX()
            tag位置(i * 2 + 1) = (572 + (i mod 3) * 250) / 1920* GetScreenY()
            For 3
                KeepCapture
                Call TURING.Pixel_FromScreen(tag位置(i * 2),tag位置(i * 2 + 1),tag位置(i * 2)+47/ 1080*GetScreenX(),tag位置(i * 2 + 1)+197/ 1920* GetScreenY())                
                Call TURING.Filter_Binaryzation("34-186")
                Call TURING.Incise_ScopeAisle(10,5)  
                tag(i) = TURING.OCR(80)            
                TracePrint tag(i),tag位置(i * 2),tag位置(i * 2 + 1)            
                If zm.arraysearch(标签, tag(i)) = -1 Then             
                    TracePrint i, tag(i) & "有标签未识别"
                    //            Goto 标记2                    
                    Delay 1000
                Else 
                    完成识别 = 完成识别 + 1
                    Exit For
                End If      
            Next
        Next
        TracePrint 完成识别  
        If 完成识别 < 5 Then 
            点击 返回(0), 返回(1)
            Exit Sub
        End If 
    End If
    dim akk= 选tag()
   
End Sub

Sub 肉鸽()
	
    TracePrint "肉鸽普通"
    If 肉鸽小队 = 0 Then 
        肉鸽队员 = Array("棘刺", "安赛尔", "梓兰")	
        招募棘刺 = 0
    ElseIf 肉鸽小队 = 3 Then
        肉鸽队员 = Array("令", "月见夜", "安赛尔")	
        招募棘刺 = -1
    End If
	
    //	已编队员 = 2
    Call 肉鸽开局()
    大锁 = false
    喉舌 = false
    不花钱=False
    到达层数=0
    点击 575, 1804
    Delay 1000
    肉鸽编队 
    Do
        KeepCapture 
        If 判断(肉鸽界面) = true Then 
            If 到达层数 = 5 Then 
                Delay 1000
            End If 
            节点类型 = 肉鸽选路()
            TracePrint 节点类型
            If 节点类型 = 0 or 节点类型 = 1 or 节点类型 = 3 Then 
                If 节点类型 = 1 And 肉鸽小队 = 2 Then 
                    肉鸽战斗结果 = False
                    肉鸽放弃
                Else 
                    肉鸽战斗结果 = 肉鸽战斗()
                End If
                
            ElseIf 节点类型 = 4 or 节点类型 = 2 Then
                肉鸽战斗结果= 肉鸽非战斗() 
            ElseIf 节点类型 = 5 Then
                肉鸽商店 
            ElseIf 节点类型 = -1 Then
                肉鸽战斗结果 = false
                肉鸽放弃
            End If
        ElseIf 判断(跳过) = true Then
            等待 跳过, 1000, 5, true
            等待 跳过确认, 1000, 5, true
            Delay 1000
        ElseIf 判断(凋零残响) = true Then
            肉鸽战斗结果 = false
        ElseIf 判断(肉鸽钟) = true Then
            点击 422, 1259
            Delay 2000
        End If
        Delay 500
        
    Loop Until 肉鸽战斗结果 = False 
    ShowMessage "失败返回"
    肉鸽结果
End Sub

Sub 肉鸽速刷()
    TracePrint "肉鸽速刷"
    Dim 选路结果()
	
    If 肉鸽速刷开局() = true Then 
        等待 肉鸽界面, 1000, 10, false
        选路结果 = 肉鸽速刷找路()
        zm.TracePrint "_3326",选路结果
        If 选路结果(0) < 5 Then 
        
            Tap 587, 597
            等待 肉鸽战斗进入, 1000, 3, false    
            Dim 地图名=识别肉鸽地图()
        
            ShowMessage "开始作战,地图:" & 地图名
            地图名=地图名&"-"&肉鸽小队
            点击 337,1716
            Delay 2000
            点击 1025,1553'快捷编队
            Delay 1500
            点击 859,840
            Delay 30
            点击 643,849
            Delay 30
            点击 448,867
            Delay 30
            点击 50,1700
            Delay 1500
            Call prts(地图名, false)
            Delay 5000
            KeepCapture 
            ShowMessage "等待成功通过"
            //      	
            Do
                KeepCapture 
                FindMultiColor (539,133,540,1807,"9B9B9B-101010","-144|111|DDDDDD,-128|-60|DDDDDD",8,0.9,intX,intY)	
            
                If CmpColor(279, 113, "58723A", 0.9) > -1 Then
                    //源石锭
                    点击 279, 113
                    Delay 2000
                elseIf intX >-1 Then
                    Tap IntX, IntY
                    Delay 100
                    Tap IntX-290, IntY+100
                    Exit Do
                ElseIf 判断(成功通过) = true Then
                    点击 200, 1650
                End If
                Delay 1000
            Loop
            等待 肉鸽界面,1000,5,false
            For i = 0 To 1
                Call 肉鸽速刷选路(选路结果(i))
                If 等待(肉鸽非战斗进入, 1000, 3, false) = true Then 
                    点击 肉鸽非战斗进入(0), 肉鸽非战斗进入(1)
                    Delay 1000
                    ShowMessage "非战斗节点,乱点一通"
                    For 3
                        点击 234,807
                        Delay 1000
                    Next
                    KeepCapture 
                    FindMultiColor 160, 1548, 967, 1549, "657E9F", "-1|-5|50637D,-2|-1|0C0F13", 0, 0.85, intX, intY
                    TracePrint "右下角坐标点",intX,intY
                    If IntX > -1 Then 
                        点击 IntX , 1798
                        Delay 1000
                        点击 IntX , 1798
                        Delay 1000
                        For 3
                            点击 234,807
                            Delay 1000
                        Next
                    End If
                    等待 肉鸽界面,1000,3,false
                Else 
                    ShowMessage "走错路遇到战斗,放弃"
                    Exit Sub
                End If
            Next
        
            Call 肉鸽速刷选路(2)
            等待 肉鸽商店进入, 1000, 5, true
            进商店次数=进商店次数+1
            Delay 2000
            SnapShot "/sdcard/Pictures/Screenshots/商店/"& Time() &".png"
            KeepCapture 
            If 判断(存钱按钮) = true Then 
                ShowMessage "我tm存爆"
                存钱次数=存钱次数+1
                点击 存钱按钮(0), 存钱按钮(1)
                Delay 2000
                点击 537, 1069
                Delay 2000
                Do
                    点击 348, 1403
                    Delay 500
                    存钱数=存钱数+1
                    KeepCapture 
                    If CmpColor(364, 1349, "3B4725", 0.9) > -1 Then 
                        Exit Do 
                    End If
                Loop
		
            End If
            If 进第二层 = true Then 
                TracePrint "进第二层"
                Delay 500
                点击 263, 1763
                Delay 500
                点击 263, 1763
                等待 肉鸽界面, 1000, 6, false
                Delay 500
            End If
        Else 
            ShowMessage "战斗超过1次,放弃"    	
        End If
    End If
    
End Sub


Sub 肉鸽开局()
    ShowMessage "开局"
    TracePrint "肉鸽开局"
    Rem 开局
    TracePrint 肉鸽小队
    等待 开始探索, 1000, 5, False
    If 肉鸽小队 = 0 or 肉鸽小队 = 2 or 肉鸽小队=3 Then 
    
        Dim 第二招募=array(283,835,"283|835|9F967F,372|419|FFFFFF,465|1099|3D3D3D")

        ShowMessage "已进入"&局数&"次肉鸽,进入"&进商店次数&"次商店,遇到"&存钱次数&"次可以存钱,存了"&存钱数&"源石锭,耗时"&(TickCount()-tt)\60000 &"分钟"
        TracePrint "已进入"&局数&"次肉鸽,进入"&进商店次数&"次商店,遇到"&存钱次数&"次可以存钱,存了"&存钱数&"源石锭,耗时"&(TickCount()-tt)\60000 &"分钟"
        Do
            KeepCapture 
            If 判断(开始探索) = true Then 
                Tap 51, 1429
                delay 50
                Tap 开始探索(0), 开始探索(1)
			
            ElseIf 判断(选择分队) = true Then
                //			TracePrint "112"
                If 肉鸽分队 < 5 Then 
                    点击 195,94+426*肉鸽分队
                    Delay 600
                    点击 195,94 + 426 * 肉鸽分队
                    Delay 600
                ElseIf 肉鸽分队 > 4 Then
                    For 3
                        Swipe  356, 1568,420, 634, 50
                        Delay 100
                    Next 
                    Delay 1400
                    点击 195,70+426*(肉鸽分队-5)
                    Delay 600
                    点击 195, 70 + 426 * (肉鸽分队-5)
                    Delay 600
                End If
			

            elseIf 判断(选择支援) = true Then 
            
           
                For i = 0 To 2
                    KeepCapture 
                    FindColor 289,357+426*i,310,705+426*i,"362AC8",0,0.9,intX,intY
                    If intX = -1 And intY = -1 Then
                        点击 203, 536 + 426 * i
                        Delay 800
                        点击 203, 536 + 426 * i
                        Delay 800
                        Exit For
                    End If
                Next
            ElseIf 判断(选择招募组合) = true Then
                Tap 选择招募组合(0), 选择招募组合(1)
                Delay 50
            ElseIf 判断(肉鸽先锋招募) = true Then
            ElseIf 判断(初始招募) = true Then
                If 肉鸽小队 = 0 or 肉鸽小队 = 2 Then 
                    Tap 初始招募(0), 初始招募(1)
                    Call 肉鸽招募(肉鸽初始队员(0))
                    Delay 1000
                    tap 260, 915
                    Call 肉鸽招募(肉鸽初始队员(1))
        	
                ElseIf 肉鸽小队 = 3 Then
                    tap 260, 915
                    Call 肉鸽招募(肉鸽初始队员(0))
                    Delay 1000
                    Tap 初始招募(0), 初始招募(1)
                    Call 肉鸽招募(肉鸽初始队员(1))        	
                End If
                Delay 1000
                tap 272,1394
                Call 肉鸽招募(肉鸽初始队员(2))
                Delay 300
                tap 575, 1804
                Delay 1000
                局数=局数+1
                Exit Do
            End If
            Delay 30
        Loop 
	
    ElseIf 肉鸽小队 = 1 Then
        TracePrint "月度小队"
        点击 41,1050'月度小队
        Delay 800
        点击 开始探索(0), 开始探索(1)
        Delay 1000
        等待 小队干员, 1000, 5, true
        Delay 1000
        点击 小队干员(0), 小队干员(1)
        Delay 1000
        KeepCapture 
        If  肉鸽分队=1 Then 
            点击 后勤分队(0), 后勤分队(1)
            Delay 1000
            点击 后勤分队(0), 后勤分队(1)
            Delay 1000
        Else 
            点击 选择分队(0), 选择分队(1)
            Delay 1000
            点击 选择分队(0), 选择分队(1)
            Delay 1000
        End If
        Delay 3000
        等待 跳过, 1000, 5, true
        等待 跳过确认, 1000, 5, true
        Delay 1000
        
    End If
	
	
End Sub

Function 肉鸽速刷开局()
    TracePrint "肉鸽速刷开局"
    Dim 第二招募=array(283,835,"283|835|9F967F,372|419|FFFFFF,465|1099|3D3D3D")

    ShowMessage "已进入"&局数&"次肉鸽,进入"&进商店次数&"次商店,遇到"&存钱次数&"次可以存钱,存了"&存钱数&"源石锭,耗时"&(TickCount()-tt)\60000 &"分钟"
    TracePrint "已进入"&局数&"次肉鸽,进入"&进商店次数&"次商店,遇到"&存钱次数&"次可以存钱,存了"&存钱数&"源石锭,耗时"&(TickCount()-tt)\60000 &"分钟"
    Do
        KeepCapture 
        If 判断(开始探索) = true Then 
            Tap 51, 1429
            delay 50
            Tap 开始探索(0), 开始探索(1)
			
        ElseIf 判断(选择分队) = true Then
            //			TracePrint "112"
            Tap 选择分队(0), 选择分队(1)
            Delay 500
        ElseIf 判断(选择指挥分队) = true Then
            //        	TracePrint "111"
            Tap 164,69
            Delay 600
        ElseIf 判断(选择招募组合) = true Then
            Tap 选择招募组合(0), 选择招募组合(1)
            Delay 50
        ElseIf 判断(肉鸽先锋招募) = true Then
            肉鸽速刷开局=false
            Exit Do 
        ElseIf 判断(初始招募) = true Then
            Tap 初始招募(0), 初始招募(1)
            Call 肉鸽招募(肉鸽初始队员(0))
            Delay 300
        ElseIf 判断(第二招募) = true Then
            tap 260, 915
            Call 肉鸽招募(肉鸽初始队员(1))
            Delay 300
        ElseIf 判断(第三招募) = true Then
            tap 272,1394
            Call 肉鸽招募(肉鸽初始队员(2))
            Delay 300
        ElseIf 判断(进入古堡) = true Then
            tap 575, 1804
            Delay 1000
            肉鸽速刷开局 = true
            局数=局数+1
            Exit Do
        End If
        Delay 30
    Loop	
End Function

Function 肉鸽速刷选路(a)
    肉鸽速刷选路 = False
    Tap 729 - 102 * a, 1224
    Delay 1000
End Function

Function 肉鸽速刷找路()
    Dim arr(1,4)
    dim 结果=array(5,5)
    Dim 颜色组
    KeepCapture
    For i = 0 To 1
        For j = 0 To 4
            //			TracePrint 732-102*j, 1789-675*i,"     ",727-102*j, 1803+675*i
            arr(i,j)=false
            If CmpColor(732-102*j, 1789-675*i, "CCCCCC", 0.9) >-1 and CmpColor(727-102*j, 1803-675*i, "DFDFDF", 0.9) >-1 Then 
                TracePrint i,j,"不期而遇"
                arr(i,j)=true		
            End If
        Next
    Next
    For j = 0 To 4
        If arr(0, j) = true Then 
            For k = j - 1 To j + 1
                If k < 0 Then 
                    k = 0
                ElseIf k > 4 Then
                    k = 4
                End If
                If arr(1, k) = true Then 
                    TracePrint k,j
					
                    If CmpColor(796 -j*102- (k - j) * 51, 1612, "FFFFFF", 0.9) > -1 Then 
						
                        结果 = Array(k, j)
                        Exit for
                    End if
					
                End If
            Next
            If 结果(0) < 5 Then 
                Exit For
            End If
        End If
    Next
    肉鸽速刷找路=结果
End Function

Function 肉鸽选路()
    TracePrint "肉鸽选路"
    Dim arr(),arr1()
    Dim 地图名
    Dim 有路=false	
    Delay 1000
    KeepCapture 
    For j = 1 To 0 Step -1
        If 有路 = false Then
            For i = 0 To 6
                arr(i)=CmpColor(818-102*i, 587+664*j, "054EDE|066AC7|C2C00B|0F98D0|D09404|789512", 0.95)'BOSS|紧急|不期而遇|战斗|安全的角落|商店
                If arr(i) > -1 Then 
                    TracePrint i,j
                    有路 = true
                    选路位置=j                    			
                End If
            Next
        End If	
    Next
    TracePrint "选路位置",选路位置
    If 选路位置 = 0 Then 
        到达层数 = 到达层数 + 1
        TracePrint 到达层数
    End If
    arr1 = Clone(arr)
    zm.ArraySort arr, true
    zm.TracePrint arr
    zm.TracePrint arr1
    肉鸽选路 = arr(0)

    ShowMessage "到达第" & 到达层数 & "层,选择节点" & 节点(arr(0))
    Delay 50
    For i = 0 To 6   
        If arr1(i) = arr(0) Then 
            点击 838 - 102 * i, 584 + 664 * 选路位置
            Delay 800
            Exit For
        End If        
    Next    
End Function

Function 肉鸽非战斗()
    肉鸽非战斗 = True
	
    Dim 进入=array(肉鸽非战斗进入,肉鸽安全角落进入)
    等待 进入, 1000, 3, false    
    点击 肉鸽非战斗进入(0), 肉鸽非战斗进入(1)
    Delay 1000
    ShowMessage "非战斗节点,乱点一通"
    TracePrint "肉鸽非战斗"
    For 3
        点击 234,807
        Delay 1000
    Next
    If 到达层数 > 3 Then 
        SnapShot "/sdcard/Pictures/Screenshots/不期而遇/"& Time() &".png"
    End If
        
    For 4
        KeepCapture 
        If 判断(鸭爵) = true or 判断(密室)=true or 判断(有关那位乌萨斯人)=true or 判断(被困的人)=true or 判断(暴殄天物)=true or 判断(微型舞台)=true or 判断(珍品处理者)=true Then 
            ShowMessage "鸭爵/密室/杜林,快溜"
            Exit For
        ElseIf 判断(幽影狂言) = true and 肉鸽分队 > 0 Then
            ShowMessage "骑士对决,溜"
            Exit For
        ElseIf 判断(复仇剧) = true Then
            If 剧作家开局 = true Then 
                EndScript
            Else 
                ShowMessage "剧作家,溜"
                Exit For
            End If
        ElseIf 判断(佝偻怪客) = true Then
            ShowMessage "佝偻怪客"
            点击 602,1811
            Delay 1000
            点击 602,1811
            Delay 500
        ElseIf 判断(保护玩偶) = true Then
            大锁 = true
        ElseIf 判断(解脱)=true Then
            If 大锁开局 = false Then 
                Exit For                	
            End If
        ElseIf 判断(赴宴) = true Then
            喉舌 = true
            If 喉舌开局 = false Then 
                Exit For                	
            End If
        End If
           
        FindMultiColor 160, 1548, 967, 1549, "657E9F", "-1|-5|50637D,-2|-1|0C0F13", 2, 0.85, intX, intY
        If IntX > -1 Then         	
            //                zm.KeyPressScreenShot 
            //                Delay 2000
            点击 IntX - 110, 1798
            Delay 1000
            点击 IntX - 110, 1798
            Delay 2000
            For 3
                If 等待(肉鸽招募界面,800,2,false) = true Then 
                    Call 肉鸽招募(null)
                End If	
            Next
                
            For 3
                点击 234,807
                Delay 1000
            Next
        End If
        Delay 1000
    Next
   
    KeepCapture 
    FindMultiColor 160, 1548, 967, 1549, "657E9F","-1|-5|50637D,-2|-1|0C0F13", 0, 0.85, intX, intY
    If IntX > -1 Then 
        //    	zm.KeyPressScreenShot 
        //    	Delay 2000
        点击 IntX,1798
        Delay 1000
        点击 IntX,1798
        Delay 1000
        If 等待(肉鸽招募界面,1000,3,false) = true Then 
            Call 肉鸽招募(null)
        End If
        For 3
            点击 234,807
            Delay 1000
        Next
    End If
    If 等待(肉鸽界面, 1000, 3, false) = false Then 
        肉鸽非战斗 = False
        肉鸽放弃 
        Exit Function
    End If
    
    KeepCapture 
    If 判断(肉鸽战斗进入)=true or 判断(肉鸽紧急作战进入)=true Then 
        //    	zm.KeyPressScreenShot
        ShowMessage "特殊战斗"
        肉鸽非战斗 = 肉鸽战斗()
    	
    End If
End Function

Sub 肉鸽放弃()
    等待 肉鸽界面, 1000, 5, false
    点击 1027, 61'左上角红色
    等待 肉鸽主页1, 1000, 5, false
    点击 592,1737'放弃
    等待 退出基建, 1000, 5, false
    点击 325, 1259
    Delay 2000
    点击 1046,1885'skip
    Delay 800
    点击 198,953'the end
    等待 凋零残响, 1000, 4, false
End Sub

Sub 肉鸽结果()

    Do 
        点击 115, 955
        Delay 300
        KeepCapture 
        If 判断(开始探索) = true Then 
            Exit Do
        End If
    Loop
    Delay 1000
    Do 
        点击 115, 955
        Delay 300
        KeepCapture 
        If 判断(开始探索) = true Then 
            Exit Do
        End If
    Loop
End Sub

Sub 肉鸽商店()
    Dim 商品1,商品2,商品排序
    dim 商品=array(0,0,0,0,0,0,0,0)
    等待 肉鸽商店进入, 1000, 5, true
    Delay 2500
    //    If 不花钱 = false Then 
    Dim item
    商品1 = zm.OcrBaiDuAll(875, 675, 916, 1816)
    Delay 1000
    商品2 = zm.OcrBaiDuAll(565, 652, 608, 1729)
    Dim a1=商品1["words_result"]
    Dim a2=商品2["words_result"]
    zm.TracePrint a1, a2
    For i = 0 To UBOUND(a1)
        item=a1(i)
        If isin(肉鸽商品评分, item["words"]) = true Then 
            商品(i)=肉鸽商品评分[item["words"]]
        End If
    Next
    For i = 0 To UBOUND(a2)
        item=a2(i)
        If isin(肉鸽商品评分, item["words"]) = true Then 
            商品(i+4)=肉鸽商品评分[item["words"]]
        End If
    Next
    zm.TracePrint 商品
    进商店次数 = 进商店次数 + 1
    Dim 商品生效
    SnapShot "/sdcard/Pictures/Screenshots/商店/"& Time() &".png"
	
    If ReadUIConfig("不存钱") = false Then 
        KeepCapture 
        If 判断(存钱按钮) = true Then 
            存钱次数=存钱次数+1
            ShowMessage "我tm存爆"
            Call 存钱()
            Delay 2000
        End If
    End If
    KeepCapture
    //    If 招募棘刺 = 1 and 精二棘刺=true Then 
    //        EndScript
    //    End If
    商品排序 = Clone(商品)
    dim 商品位置
    zm.ArraySort 商品排序, true		
    For i = 0 To 7
        If (商品排序(i) > 0 and 不花钱=false) or (商品排序(i)>=96 and 不花钱=true) Then 
            商品位置 = zm.ArraySearch(商品, 商品排序(i))
            KeepCapture 
            If CmpColor(671 - 317 * (商品位置 \ 4), 817 + 309 * (商品位置 mod 4), "A9CD02", 0.7) > -1 or CmpColor(671 - 317 * (商品位置 \ 4), 789 + 309 * (商品位置 mod 4), "A9CD02", 0.7) > -1 Then 
                点击 762 - 300 * (商品位置 \ 4), 756 + 300 * (商品位置 mod 4)
                Delay 2000
                KeepCapture
                If 判断(没有生效)=true Then 
                    点击 333,944'算了
                    Delay 1500
                Else
                    If 商品排序(i) >= 109 Then 
                        不花钱=true
                    End If
                
                    点击 340, 1447		
                    Delay 2000
                    KeepCapture 
                    If 判断(肉鸽招募界面) = true Then 
                        Call 肉鸽招募(null)
                    End If
                End If
            End If
        End If       	
    Next
    //    End If
    
    Delay 500
    点击 263, 1763
    Delay 1000
    点击 263, 1763
    Delay 5000
    
    
End Sub

Sub 存钱()
    点击 存钱按钮(0), 存钱按钮(1)
    Delay 2000
    点击 537, 1069
    Delay 2000
    Do
        点击 348, 1403
        Delay 1000
        存钱数=存钱数+1
        KeepCapture 
        If CmpColor(364, 1349, "3B4725", 0.9) > -1 Then 
            点击 340, 1052
            Delay 1000
            点击 340, 1052
            Delay 1000
            Exit Do 
        End If
    Loop
End Sub

Sub 肉鸽编队()
    等待 肉鸽界面, 1000, 5, false
    TracePrint "肉鸽编队"
    Dim arr= Array(0, 0, 0)
    If 肉鸽小队 = 1 Then
        arr = Array(1, 0, 1)
    End If
    点击 53, 1681
    Delay 1000
    点击 354, 1726
    Delay 2000
    点击 1025,1553'快捷编队
    Delay 1500
    点击 859,840
    Delay 30
    点击 643,849
    Delay 30
    点击 448,867
    Delay 30
    点击 50,1700
    Delay 1500
    For i = 0 To 2
        If arr(i) <> 0 Then 
            点击 818-i*186, 373 + arr(i) * 90
            Delay 300
        End If		
    next	
    点击 返回(0), 返回(1)
    Delay 2000	
End Sub

Sub 肉鸽上干员(n)
    If n < 4 Then 
        点击 817-185*n,333
    ElseIf n < 9 Then
        点击 916-185*(n-4),929
    Else
        点击 817-185*(n-9),1525
    End If
    Call 肉鸽招募(肉鸽队员(n))
End Sub

Sub 肉鸽下干员(n)
    If n < 4 Then 
        点击 817-185*n,333
    ElseIf n < 9 Then
        点击 916-185*(n-4),929
    Else
        点击 817-185*(n-9),1525
    End If
    Delay 1500
    点击 862, 808
    Delay 300
    点击 60, 1739
    Delay 800
    zm.ArrayRemove(肉鸽队员,n)
End Sub

Sub 肉鸽点技能(n,m)
    If n < 4 Then 
        点击 817-185*n,457+86*(m-2)
    ElseIf n < 9 Then
        点击 916-185*(n-4),1053+86*(m-2)
    Else
        点击 817-185*(n-9),1697+86*(m-2)
    End If
    Delay 100
End Sub

Function 肉鸽战斗()
    Dim 进入=array(肉鸽战斗进入,肉鸽紧急作战进入,肉鸽boss作战进入)	
    等待(进入, 1000, 3, false)     
    Dim 地图名=识别肉鸽地图()
    Dim boss收藏,收藏1,ix,iy
    If IsNull(地图名) = true Then 
        SnapShot "/sdcard/Pictures/Screenshots/战斗/" & Time() & ".png"
        //        zm.KeyPressScreenShot 
        If 第三层boss = true Then 
            If (大锁开局 = false and 喉舌开局 = false) or (大锁开局 = true and 大锁 = true) or (喉舌开局 = true and 喉舌 = true) Then 
                EndScript
            End If        	
        End If
        肉鸽战斗 = False
        肉鸽放弃 
        Exit Function

    End If
    If 到达层数 = 4 and 攻速开局 = true Then 
        If 不花钱 = false Then 
            肉鸽战斗 = False
            肉鸽放弃
            Exit Function    		
        End If
    End If
    ShowMessage "开始作战,地图:" & 地图名
    地图名=地图名&"-"&肉鸽小队
    点击 354, 1726
    
    If 到达层数 >= 5 and 第五层暂停=true Then 
        UI.NewLayout ("第五层确认")
        UI.AddTextView "第五层确认", "文本1", "点继续脚本继续打,点退出自己继续打"
        ui.Show("第五层确认")
    End If
    Delay 2000
    等待 肉鸽开始行动, 1000, 2, false
    zm.TracePrint 肉鸽队员
    ReleaseCapture 
    Dim 已编,上限
    Do
    	
        已编=CInt(SmartOcr(35, 257, 69, 287))
        上限=CInt(SmartOcr(40, 299, 67, 340))
        TracePrint 已编&"/"&上限
        If 已编 < 10 and 上限 > 13 Then 
            已编=CInt(SmartOcr(35, 266, 69, 304))
            上限=CInt(SmartOcr(40, 316, 67, 352))
        End If
    Loop Until (已编 <= 上限 and 已编 >= 上限 - 6 and 上限 <= 13)
    If 已编 = 上限 and 到达层数>=4 Then 
        If UBOUND(肉鸽队员) >= 已编 Then 
            If zm.ArraySearch(肉鸽队员, "梓兰") > -1 Then 
                肉鸽下干员 (zm.ArraySearch(肉鸽队员, "梓兰"))
                已编 = 已编 - 1
                zm.TracePrint 肉鸽队员
                TracePrint 已编
            ElseIf zm.ArraySearch(肉鸽队员, "史都华德") > -1 and zm.ArraySearch(肉鸽队员, "艾雅法拉") > -1 Then
                肉鸽下干员 (zm.ArraySearch(肉鸽队员, "史都华德"))
                已编 = 已编 - 1
                zm.TracePrint 肉鸽队员
                TracePrint 已编
            ElseIf zm.ArraySearch(肉鸽队员, "芬") > -1 and zm.ArraySearch(肉鸽队员, "桃金娘") > -1 Then
    		
                肉鸽下干员 (zm.ArraySearch(肉鸽队员, "芬"))
                已编 = 已编 - 1
                zm.TracePrint 肉鸽队员
                TracePrint 已编
            ElseIf zm.ArraySearch(肉鸽队员, "芙蓉") > -1 and zm.ArraySearch(肉鸽队员, "凯尔希") > -1 Then
    		
                肉鸽下干员 (zm.ArraySearch(肉鸽队员, "芙蓉"))
                已编 = 已编 - 1
                zm.TracePrint 肉鸽队员
                TracePrint 已编
            ElseIf zm.ArraySearch(肉鸽队员, "斑点") > -1 and zm.ArraySearch(肉鸽队员, "塞雷娅") > -1 Then
    		
                肉鸽下干员 (zm.ArraySearch(肉鸽队员, "斑点"))
                已编 = 已编 - 1
                zm.TracePrint 肉鸽队员
                TracePrint 已编
            ElseIf zm.ArraySearch(肉鸽队员, "红") > -1 and zm.ArraySearch(肉鸽队员, "银灰") > -1 and zm.ArraySearch(肉鸽队员, "史尔特尔") > -1 Then
    		
                肉鸽下干员 (zm.ArraySearch(肉鸽队员, "红"))
                已编 = 已编 - 1
                zm.TracePrint 肉鸽队员
                TracePrint 已编
            End If
    		
        End If
    End If
    If  已编<上限  Then     
        For 上限-已编        
            If UBOUND(肉鸽队员) >= 已编 Then 
                肉鸽上干员 (已编)
                已编 = 已编+ 1
                等待 肉鸽开始行动, 1000, 2, false
            End If       
        Next
    End If
    zm.TracePrint 肉鸽队员
    zm.TracePrint 队员技能
    For i = 0 To 已编-1 	
        If  isin(队员技能, 肉鸽队员(i))=true Then 
            肉鸽点技能(i,队员技能[肉鸽队员(i)])
        End If
    Next
    Call prts(地图名, false)
    Delay 5000
    KeepCapture 
    If 判断(联系中断) = true or 判断(凋零残响) or 判断(肉鸽钟)=true Then
        点击 联系中断(0), 联系中断(1)
        Delay 2000
        肉鸽战斗 = False
        Exit function
    End If
    ShowMessage "等待成功通过"
    等待 成功通过, 2500, 6, false
	
    点击 200, 1650
    肉鸽战斗 = True
    等待(战斗奖励, 1000, 5, false)
    dim n=0	
    Do
        KeepCapture 
        FindMultiColor (539,133,540,1807,"9B9B9B-101010","-144|111|DDDDDD,-128|-60|DDDDDD",8,0.9,intX,intY)		
        If CmpColor(279, 113, "58723A", 0.95) > -1 Then
            TracePrint "源石锭"
            点击 279, 113
            Delay 2000
        elseIf CmpColor(279, 113, "216A9D", 0.95) > -1 Then
            TracePrint "收藏品"
            FindMultiColor 288, 83, 296, 106, "1E689B", "212|204|DDDDDD,415|243|0C4CBF,431|161|477BCB,388|109|FCFCFF", 0, 0.9, ix, iy
            If ix > -1 Then 
                TracePrint "金杯"
                不花钱 = true
            Else 
                FindMultiColor 288, 83, 296, 106, "1E689B","206|192|DDDDDD,468|227|0059BB,361|104|5476F0,380|126|0091DB", 0, 0.9, ix, iy
                If ix > -1 Then 
                    TracePrint "戒律"
                    不花钱 = true
                Else 
                    TracePrint "无"
                End If
            End If
            点击 279, 113
            Delay 2000
        ElseIf CmpColor(279, 113, "296379", 0.95) > -1 Then
            TracePrint "未知剧目"
            点击 279, 113
            Delay 500
            KeepCapture
            If CmpColor(198,326, "1E3D51", 0.9) > -1 Then 
                点击 210,343
            End If            
            Delay 1500
            点击 91, 966
            Delay 1200
        ElseIf CmpColor(279, 113, "9F967F", 0.9) > -1 Then
            TracePrint "招募"
            点击 279, 113  
            Call 肉鸽招募(Null)
        ElseIf 判断(招募选择) = True Then
            If 判断(选择第二近卫招募) = true or 判断(选择第二狙击招募)=true Then 
                点击 332, 1094
            Else 
                点击 招募选择(0), 招募选择(1)
            End If
            	
            Call 肉鸽招募(Null)
        ElseIf CmpColor(279, 113, "6F6F6F", 0.9) > -1 Then
            TracePrint "支援，收藏品"
            点击 279, 113
            Delay 1000
            KeepCapture 
            FindMultiColor 342, 340, 343, 1551, "1E689B", "-33|268|1E689B", 0, 0.9, intX, intY
            If intX > -1 Then 
                SnapShot "/sdcard/Pictures/Screenshots/boss奖励/"& Time() &".png"
                FindMultiColor 347, 56, 352, 1864, "1E689B", "212|204|DDDDDD,415|243|0C4CBF,431|161|477BCB,388|109|FCFCFF", 0, 0.9, ix, iy
                If ix > -1 Then 
                    TracePrint "金杯",ix,iy
                    不花钱 = true
                    点击 ix - 10, iy + 100
                Else 
                    FindMultiColor 347, 56, 353, 1864, "1E689B","206|192|DDDDDD,468|227|0059BB,361|104|5476F0,380|126|0091DB", 0, 0.9, ix, iy
                    If ix > -1 Then 
                        TracePrint "戒律",ix,iy
                        不花钱 = true
                        点击 ix - 10, iy + 100
                    Else 
                        TracePrint "无"
                        点击 intX, intY
                    End If
                End If     			
       			
                Delay 600
            End If
        elseIf intX >-1 and n > 30 Then
            Tap IntX, IntY
            Delay 100
            Tap IntX-290, IntY+100
            Exit Do
        ElseIf 判断(奖励全部领完) = true Then
            点击 奖励全部领完(0), 奖励全部领完(1)
            Delay 1000
            Exit Do
        ElseIf 判断(肉鸽招募界面) = true Then
            Call 肉鸽招募(null)
        ElseIf 判断(成功通过) = true Then
            点击 200, 1650
        ElseIf 判断(凋零残响) = true Then
            肉鸽战斗 = False
            Exit Do 
        End If
        n=n+1
        Delay 1000
    Loop
	
End Function

Sub 肉鸽招募(a)
    TracePrint "肉鸽招募",a
    Dim 干员=a
    Dim 招募到=false
    Dim arr1(),arr
    dim 被招募干员 
    Dim i
    等待 肉鸽招募界面, 600,5, false
    Delay 300
    If IsNull(干员) = true Then 
    	
        KeepCapture 
        If CmpColor(935, 686, "C4C4C4", 0.9) = -1 Then 
            TracePrint "111"
            Call TURING.Lib_Load(GetTempDir() & "肉鸽干员"&肉鸽小队&".lib")
            If 招募到 = False Then 
                For 5               
                    For i = 0 To 7
                        Call 肉鸽切割(i)
                        ' 识别字库路径可自行更换！！！
                        被招募干员 = TURING.OCR(80)
                        TracePrint i,被招募干员
                        If 被招募干员 <>null and 被招募干员 <> "预备干员" and 被招募干员 <> "安赛尔" Then 
                            点击 862 - 205 * (i mod 4), 905 + 585 * (i \ 4)
                          	
                            If zm.ArraySearch(肉鸽队员, 被招募干员) =-1 Then 
                                zm.ArrayInsert(肉鸽队员, 被招募干员)
                            ElseIf 被招募干员 = "棘刺" Then
                                招募棘刺 =1
                            End If	
                            Delay 300
                            招募到=true
                            Exit For
                        End If
                    Next
                    If 招募到 = true Then 
                        Exit For
                    End If
                    KeepCapture 
                    If CmpColor(922, 1015, "64542A", 0.9) > -1 or cmpcolor(222,1704,"E0E0E0",0.9)>-1 Then 
                        TracePrint "全是三星"
                        Exit For
                    End If
                    Call 肉鸽干员翻页()
                    Delay 500
                Next
        	
            End If
        
            If 招募到 = False Then 
                Call TURING.Lib_Load(GetTempDir() & "肉鸽干员"&肉鸽小队&".lib")
                For 5
               
                    For i = 0 To 7
                        Call 肉鸽切割(i)
                        ' 识别字库路径可自行更换！！！
                        被招募干员 = TURING.OCR(80)
                        TracePrint 被招募干员,i
                        If 被招募干员 = "预备干员" Then 
                            点击 862 - 205 * (i mod 4), 905 + 585 * (i \ 4)  
                            //                            If zm.ArraySearch(肉鸽队员, 被招募干员) =-1 Then 
                            //                                zm.ArrayInsert(肉鸽队员, 被招募干员)
                            //                            End If	
                            Delay 300
                            招募到=true
                            Exit For
                        End If
                    Next
                    If 招募到 = true Then 
                        Exit For
                    End If
                    TouchDown 534, 616,1    
                    Delay 200
                    TouchMove 534,1903, 1, 200
                    Delay 100
                    TouchMove 534,1903, 1, 200     
                    Delay 400
                    TouchUp 1
                    Delay 200
                    Delay 500
                Next
        	
            End If
        End if
		
    ElseIf IsNumeric(干员) = true Then
		
		
		 
        For i = 0 To 7
            点击 862 - 205 * (i mod 4), 905 + 585 * (i \ 4)
            Delay 300
            KeepCapture
            If CInt(SmartOcr(673, 400, 692, 413)) >= 干员 Then 
                ShowMessage "招募阻挡数大于"&干员
                Exit for
            End If
        Next
		
    Else 
        TracePrint "招募",干员,肉鸽小队
        TracePrint TURING.Lib_Load(GetTempDir() & "肉鸽干员"&肉鸽小队&".lib",干员)
        
        For i = 0 To 7
            Call 肉鸽切割(i)
            
            ' 识别字库路径可自行更换！！！
            TracePrint TURING.OCR(80),i
            If TURING.OCR(80) = 干员 Then 
                点击 862 - 205 * (i mod 4),905 + 585 * (i \ 4)
                Delay 300
                招募到=true
                Exit For
            End If
        Next
        If 招募到 = False Then 
            For 5
                Call 肉鸽干员翻页()
                For i = 0 To 7
                    Call 肉鸽切割(i)
                    ' 识别字库路径可自行更换！！！
                    TracePrint TURING.OCR(80),i
                    If TURING.OCR(80)=干员 Then 
                        点击 862 - 205 * (i mod 4), 905 + 585 * (i \ 4)
                        Delay 300
                        招募到=true
                        Exit For
                    End If
                Next
                If 招募到 = true Then 
                    Exit For
                End If
            Next        	
        End If
        KeepCapture
        If 招募到 = false and CmpColor(1020,1584,"FDFDFD",0.9)>-1  Then 
            点击 1027, 1757
            Delay 500
            arr=array(1,干员)
            Call 编入支援干员(arr, 1)  
        End If
    End If
    Delay 1500
    KeepCapture 
    If 判断(招募助战) = true Then 
        点击 招募助战(0),招募助战(1)
    Else 
        点击 肉鸽招募界面(0), 肉鸽招募界面(1)	
    End If
    Delay 1000
    KeepCapture 
    If 判断(退出基建) = true Then
        点击 退出基建(0), 退出基建(1)
        Delay 800
    ElseIf CmpColor(1012, 1824, "00007D", 0.9) = -1 Then 
        点击 1017, 1848
        Delay 800
        点击 1017, 1848
        Delay 1500
    End If
    
End Sub

Sub 肉鸽切割(i)
    Call TURING.Pixel_FromScreen(787-205*(i mod 4),937+585*(i\4),820-205*(i mod 4),1153+102+585*(i\4))    ' 需要修改的地方！
    Call TURING.Filter_Rotate(270)
    Call TURING.Filter_Binaryzation("0-180")
    Call TURING.Incise_ScopeAisle(10,10)
End Sub

Sub 肉鸽干员翻页()
    TouchDown 534,1903,1    
    Delay 200
    TouchMove 534, 616, 1, 200
    Delay 100
    TouchMove 534, 616, 1, 200     
    Delay 400
    TouchUp 1
    Delay 200
End Sub

Sub 联锁竞赛()
    TracePrint "联锁竞赛"
    返回主页 
    Dim 奖章数
    Delay 1500
    点击 778, 1474
    Delay 2500
    KeepCapture 
    奖章数=cint(SmartOcr(501, 665, 523, 715))
    If 奖章数 < 320 Then 
        ShowMessage "奖章数" & 奖章数 & ",继续挑战"
        TracePrint 奖章数
        点击 702, 1101
        Delay 2500
        KeepCapture 
        TracePrint smartocr(514,203,562,316)
        点击 472, 1610
        Delay 1500
        点击 581, 958
        Delay 2000
        KeepCapture
        If CmpColor(194, 1601, "3E3D3E", 0.9) > -1 Then 
            点击 194, 1601
            Delay 1500
        End If
        Call 重复战斗()		
    End If
    Delay 1500
    Call 返回主页()
End Sub


Sub 收干员()
    TracePrint "公招收干员"
    点击 1017, 1848
    Delay 5000
    点击 1017, 1848
    Delay 1500
    等待 公开招募, 1000, 10, false
    
End Sub

Sub 制造站选干员1()
    TracePrint "制造站选干员经验"
    Dim 干员列表
    Dim n=0
    Dim 选择(2)
    点击 113, 488
    Delay 2500
   
    //    点击 1011,1200
    //    Delay 1000
    //    点击 1011,1200
    //    Delay 1500
    点击 67, 766
    Delay 1000
    干员列表 = 识别干员()
    For k = 10 To 0 step -1
        If n < 3 Then 
            For j = 0 To 17
                For i = 0 To 1
                    If k = 10 Then 
                        If 干员列表(i, j) = 10 and n = 0 Then 
                            选择(n)=array(i,j)
                            n = n + 1
                            For p = 0 To 17
                                For o = 0 To 1 
                                    If 干员列表(o, p) = -4 Then 
                                        选择(n)=array(o,p)
                                        n = n + 1
                                    End If
                                    If n > 2 Then 
                                        Exit For
                                    End If
                                Next
                                If n > 2 Then 
                                    Exit For
                                End If
                            Next
                            //                            For p = 0 To 17
                            //                                For o = 0 To 1 
                            //                                    If 干员列表(o, p) = 1 Then 
                            //                                        选择(n)=array(o,p)
                            //                                        n = n + 1
                            //                                        Delay 500
                            //                                    End If
                            //                                    If n > 2 Then 
                            //                                        Exit For
                            //                                    End If
                            //                                Next
                            //                                If n > 2 Then 
                            //                                    Exit For
                            //                                End If
                            //                            Next
                            If n <= 2 Then 
                                //                                点击 776 - 421 * i, 739 + 216 * j
                                n = 0
                            End If
                        End If 
                    ElseIf k = 9 Then
                        If 干员列表(i, j) = 9 and n = 0 Then 
                            选择(n)=array(i,j)
                            n = n + 1
                             
                            For p = 0 To 17
                                For o = 0 To 1 
                                    If 干员列表(o, p) = -2 Then 
                                        选择(n)=array(o,p)
                                        n = n + 1
                                         
                                    End If
                                    If n > 1 Then 
                                        Exit For
                                    End If
                                Next
                                If n > 1 Then 
                                    Exit For
                                End If
                            Next
                            If n = 1 Then 
                                //                                
                                n = n - 1
                            Else 
                                For p = 0 To 17
                                    For o = 0 To 1 
                                        If 干员列表(o, p) = -3 Then 
                                            选择(n)=array(o,p)
                                            n = n + 1
                                         
                                        End If
                                        If n > 2 Then 
                                            Exit For
                                        End If
                                    Next
                                    If n > 2 Then 
                                        Exit For
                                    End If
                                Next
                            
                                
                                
                            End If
                            
                            
                            
                        End If
                    ElseIf 夕中枢 = true and 干员列表(i, j) = 5 and 迷迭香=false Then 
                        选择(n)=array(i,j)
                        n = n + 1
                        迷迭香=true
                    ElseIf 干员列表(i, j) = k Then
                        If k = 5 and 迷迭香 = true Then 
                        Else
                            选择(n)=array(i,j)
                            n = n + 1
                        End If
                    		
                    End If
                    If n > 2 Then 
                        Exit for
                    End If
                next
                If n > 2 Then 
                    Exit for
                End If
            next
        End If
    Next
    zm.TracePrint "_4248",选择
    Call 基建选择干员(选择)
    Delay 500
    点击 62, 1773
    Delay 2500
	
End Sub
Sub 制造站选干员2()
    
    Dim 干员列表
    Dim 选择(2)
    Dim n=0
    点击 113, 488
    Delay 2500
   
    //    点击 1011,1200
    //    Delay 1000
    //    点击 1011,1200
    //    Delay 1500
    点击 67, 766
    Delay 1000
    干员列表 = 识别干员1()
    TracePrint "造赤金选干员"
    For k = 10 To -1 step -1
        If n < 3 Then 
            For j = 0 To 17
                For i = 0 To 1
                    If k = 10 Then 
                        If 干员列表(i, j) = 10 and n = 0 Then 
                            选择(n)=array(i,j)
                            n = n + 1
                            For p = 0 To 17
                                For o = 0 To 1 
                                    If 干员列表(o, p) = -3 Then 
                                        选择(n)=array(o,p)
                                        n = n + 1
                                    End If
                                    If n > 1 Then 
                                        Exit For
                                    End If
                                Next
                                If n > 1 Then 
                                    Exit For
                                End If
                            Next
                            If n = 2 Then 
                                For p = 0 To 17
                                    For o = 0 To 1 
                                        If 干员列表(o, p) = -8 Then 
                                            选择(n)=array(o,p)
                                            n = n + 1                                         
                                        End If
                                        If n > 2 Then 
                                            Exit For
                                        End If
                                    Next
                                    If n > 2 Then 
                                        Exit For
                                    End If
                                Next                     
                                
                                
                            End If
                            If n = 2 and 森蚺中枢=false Then 
                                n = 1
                            ElseIf n = 2 Then                             
                                For p = 0 To 17
                                    For o = 0 To 1 
                                        If 干员列表(o, p) < 4 and 干员列表(o, p) >= 0 Then                                      
                                            选择(n)=array(o,p)
                                            n = n + 1                                         
                                        End If
                                        If n > 2 Then 
                                            Exit For
                                        End If
                                    Next
                                    If n > 2 Then 
                                        Exit For
                                    End If
                                Next  
                            End If
                            
                            If n = 1 and 贸易站数量<2 Then 
                                //                                点击 776 - 421 * i, 739 + 216 * j
                                n = n - 1
                            End If
                        End If 
                    ElseIf k = 9 Then
                        If 干员列表(i, j) = 9 and n = 0 Then 
                            选择(n)=array(i,j)
                            n = n + 1
                            For p = 0 To 17
                                For o = 0 To 1 
                                    If 干员列表(o, p) = -2 Then 
                                        选择(n)=array(o,p)
                                        n = n + 1
                                    End If
                                    If n > 1 Then 
                                        Exit For
                                    End If
                                Next
                                If n > 1 Then 
                                    Exit For
                                End If
                            Next
                            If n = 1 Then 
                                //                                
                                n = n - 1
                            Else 
                                For p = 0 To 17
                                    For o = 0 To 1 
                                        If 干员列表(o, p) = -4 Then 
                                            选择(n)=array(o,p)
                                            n = n + 1
                                         
                                        End If
                                        If n > 2 Then 
                                            Exit For
                                        End If
                                    Next
                                    If n > 2 Then 
                                        Exit For
                                    End If
                                Next
                            
                                
                                
                            End If
                            
                        End If
                    ElseIf 夕中枢 = true and 干员列表(i, j) = 5 and 迷迭香=false Then 
                        选择(n)=array(i,j)
                        n = n + 1
                        迷迭香=true
                    ElseIf 干员列表(i, j) = k Then
                        If k = 5 and 迷迭香 = true Then 
                        Else
                            选择(n)=array(i,j)
                            n = n + 1
                        End If
                    End If
                    If n > 2 Then 
                        Exit for
                    End If
                next
                If n > 2 Then 
                    Exit for
                End If
            next
        End If
    Next
    zm.TracePrint "_4399",选择
    Call 基建选择干员(选择)
   
    Delay 500
    点击 62, 1773
    Delay 2500
	
End Sub
Sub 贸易站选干员()
    TracePrint "贸易站选干员"
    Dim 干员列表
    Dim 选择(2)
    Dim n=0
    点击 113, 488
    Delay 2500
    //    点击 1011,1200
    //    Delay 1000
    //    点击 1011,1200
    //    Delay 1500
    点击 67, 766
    Delay 1000
    干员列表 = 识别干员2()
    For k = 10 To -1 step -1
        If n < 3 Then 
            For j = 0 To 17
                For i = 0 To 1
                    If k = 10 Then 
                		
                        If 干员列表(i, j) = 10 and n = 0 Then 
                            选择(n)=array(i,j)
                            n = n + 1
                            For p = 0 To 17
                                For o = 0 To 1 
                                    If 干员列表(o, p) = -3 Then 
                                        选择(n)=array(o,p)
                                        n = n + 1
                                    End If
                                    If n > 1 Then 
                                        Exit For
                                    End If
                                Next
                                If n > 1 Then 
                                    Exit For
                                End If
                            Next
                            For p = 0 To 17
                                For o = 0 To 1 
                                    If 干员列表(o, p) = -4 Then 
                                        选择(n)=array(o,p)
                                        n = n + 1
                                        Delay 500
                                    End If
                                    If n > 2 Then 
                                        Exit For
                                    End If
                                Next
                                If n > 2 Then 
                                    Exit For
                                End If
                            Next
                            For p = 0 To 17
                                For o = 0 To 1 
                                    If 干员列表(o, p) = -5 Then 
                                        选择(n)=array(o,p)
                                        n = n + 1
                                        Delay 500
                                    End If
                                    If n > 2 Then 
                                        Exit For
                                    End If
                                Next
                                If n > 2 Then 
                                    Exit For
                                End If
                            Next
                            If n = 1 Then 
                                //                                点击 776 - 421 * i, 739 + 216 * j
                                n = n - 1
                            End If
                        End If
                		
                		
                	
                    elseIf  k=9 Then 
                        
                        If 干员列表(i, j) = k and n = 0 Then 
                            选择(n)=array(i,j)
                            n = n + 1
                            TracePrint i,j
                            For p = 0 To 17
                                For o = 0 To 1
                                    If 干员列表(o, p) = -2 Then                             		
                                        选择(n)=array(o,p)
                                        n=n+1
                                        Exit For
                                    End If                            	
                                Next
                                If n > 1 Then 
                                    Exit For
                                End If
                            Next
                            If n = 1 Then 
                                //                                点击 776 - 421 * i, 739 + 216 * j
                                n = n - 1
                            End If
                        End If
                        
                    ElseIf 干员列表(i, j) = k Then
                    
                        选择(n)=array(i,j)
                        n = n + 1
                    End If  
                    
                    If n > 2 Then 
                        Exit for
                    End If
                Next
                If n > 2 Then 
                    Exit for
                End If
            next
        End If
    Next
    
    zm.TracePrint "_4523",选择
    Call 基建选择干员(选择)
    Delay 500
    点击 62, 1773
    Delay 2500
	
End Sub
Sub 控制中枢选干员()
    Dim 干员列表
    Dim 选择(4)
    Dim n=0
    TracePrint "控制中枢干员"
    Delay 1500
    点击 837,1556
    Delay 2500
    点击 63,769'清空
    Delay 500
    干员列表 = 识别干员3()
    
    For k = 10 To -1 Step -1
        For j = 0 To 17
            For i = 0 To 1
                If k = 10 Then 
                    if 干员列表(i, j) = 10 and n=0 Then 
                        选择(n)=array(i,j)
                        n = n + 1
                    End If
                    
                ElseIf 干员列表(i, j) = k Then
                    选择(n)=array(i,j)
                    n = n + 1
                    If k = 8 Then 
                        夕中枢 = true
                    ElseIf k = 7 Then
                        森蚺中枢 = true
                    End If
                End If
                If n > 4 Then 
                    Exit For
                End If
            Next
            If n > 4 Then 
                Exit For
            End If
        Next
        If n > 4 Then 
            Exit For
        End If
    Next
    
    
    zm.TracePrint "_4574",选择
    Call 基建选择干员(选择)
    Delay 500
    点击 62, 1773
    Delay 2500
    
    
    
    
    
    
    
    
    KeepCapture 
    If 判断(换工作) = true Then 
        Delay 500
        点击 换工作(0), 换工作(1)
        Delay 2500
    End If
    点击 1010, 116
    Delay 2500
    等待 基建,1500,10,false
    
   
End Sub

Sub 发电站选干员()
    Dim 干员列表
    Dim n=0
    干员列表 = 识别干员4()
    For k = 10 To -1 Step -1
        For j = 0 To 5
            For i = 0 To 1
                If 干员列表(i, j) = k Then 
                    点击 776 - 421 * i, 739 + 216 * j
                    n = n + 1            		
                End If
                If n > 0 Then 
                    Exit For
                End If
            Next
            If n > 0 Then 
                Exit For
            End If
        Next
        If n > 0 Then 
            Exit For
        End If
    Next
End Sub
Sub 办公室选干员()
    Dim 干员列表
    Dim n=0
    干员列表 = 识别干员5()
    For k = 10 To -1 Step -1
        For j = 0 To 5
            For i = 0 To 1
                If 干员列表(i, j) = k Then 
                    点击 776 - 421 * i, 739 + 216 * j
                    n = n + 1
                    Delay 500
                End If
                If n > 0 Then 
                    Exit For
                End If
            Next
            If n > 0 Then 
                Exit For
            End If
        Next
        If n > 0 Then 
            Exit For
        End If
    Next
End Sub
Sub 回(arr)
    Dim 页面=arr
    TracePrint "回"&页面(3)
    If 等待(页面, 1000, 5, false) = false Then 
        TracePrint "返回"&页面(3)&"失败,重启游戏"
        KillApp "com.hypergryph.arknights"
        Delay 5000
        RunApp "com.hypergryph.arknights"
        Delay 20000
        等待 开始游戏, 2000, 60, true
        Delay 10000
        等待 登录界面1, 2000, 30, false
        Call 登录(目前账号)
        点击 页面(4), 页面(5)
        If 等待(页面, 2000, 15, false) = false Then 
            SnapShot "/sdcard/"&页面(3)&".png"
            EndScript
        End If
    End If
End Sub

Sub 返回主页()
    TracePrint "返回主页"
    KeepCapture 
    If 判断(十连) = true Then 
        点击 320, 449
        Delay 1000
    End If
    KeepCapture 
    If 判断(开始11) = true Then 
        点击 1021, 400
        Delay 1000
    End If
    KeepCapture 
    If 判断(返回) = true Then 
        点击 1021, 400
        Delay 1000
        点击 665, 144
        Delay 1000
    End If
    If 等待(主页, 1000, 6, false) = False Then 
        TracePrint "返回主页失败,重启游戏"
        KillApp 包名
        Delay 5000
        RunApp 包名
        Delay 20000
        等待 开始游戏, 2000, 60, true
        Delay 10000
        If 包名 = "com.hypergryph.arknights" Then 
            等待 登录界面1, 2000, 30, false
            If 账号(0) = "" Then 
                点击 300, 1000
                Delay 5000
                等待(主页, 1000, 10, false)
            Else
                Call 登录(目前账号)
            End If
        Else 
            Delay 10000
            等待(主页, 1000, 10, false)
        End If
    End If
End Sub
Function 识别干员()
    TracePrint "识别制造站干员"
    Dim i,j,jj    
    Dim arr(1,17)
    Dim 点12,点5,点6,点11
    
    TracePrint "纵,横 12点 5点 6点 评级"
    
    For jj = 0 To 17
        j = jj mod 6
        If j = 0 Then 
            KeepCapture
        End If
        For i = 0 To 1
            点12 = CmpColor(679 - 421 * i, 661 + 216 * j, "3D3E3E|FEFFFF", 0.9)
            点5=CmpColor(630 - 421 * i, 666 + 216 * j, "626464|FEFFFF", 0.9)
            点6 = CmpColor(630 - 421 * i, 661 + 216 * j, "3D3E3E|FEFFFF", 0.85)
            点11=CmpColor(674 - 421 * i, 646 + 216 * j, "3D3E3E|FEFFFF", 0.85)
            //                        TracePrint i,j,点12,点5,点6,点11
			
            
            arr(i, jj) = -1
            
            If 点12 = 0 Then '黑
                If 点5 = 0 Then 
                    If CmpColor(649 - 421 * i, 667 + 216 * j, "202020", 0.9) > -1 Then 
                        If CmpColor(639 - 421 * i, 712 + 216 * j, "0ED8FF", 0.9) > -1 Then 
                            If CmpColor(640 - 421 * i, 725 + 216 * j, "00DAFD", 0.9) > -1 Then 
                                arr(i, jj) = -4
                                TracePrint "牛牛"
                            else
                                TracePrint "红云"
                                arr(i,jj)=10'红云
                            End If
                        Elseif CmpColor(654 - 421 * i, 750 + 216 * j, "FFFFFF", 0.9) > -1 Then  
                            arr(i, jj) = -4
                            TracePrint "小刻"
                        End If
                        
                    Else 
                        If 点6=-1 and CmpColor(646 - 421 * i, 662 + 216 * j, "13171A", 0.95) > -1 Then 
            			
                            TracePrint "清流"
                            arr(i, jj) =-5
                        ElseIf 点6 = -1 Then
                         
							
                            arr(i, jj) = 0
                        Else 
                            If CmpColor(662 - 421 * i, 648 + 216 * j, "000617", 0.9) > -1 Then 
                                arr(i, jj) = 6'exp25加成
                            ElseIf CmpColor(646 - 421 * i, 733 + 216 * j, "222020", 0.9) > -1 and CmpColor(662 - 421 * i, 731 + 216 * j, "02D7FD", 0.9) > -1 Then
                                arr(i, jj) = 1'豆苗
                            Else
                                arr(i, jj) = 3'15加成
                            End If
                        End If
                        
                    End If
                ElseIf 点5 = 1 Then
                    If 点6 = 0 Then'黑 
                    	
                        If CmpColor(647 - 421 * i, 658 + 216 * j, "02D8FF", 0.85) > -1 Then
                        	
                            If CmpColor(655- 421 * i, 646 + 216 * j, "002229", 0.9) > -1 Then 
                                If 点11 = 1 Then 
                                    TracePrint "火神2"
                        		 
                                    arr(i,jj)=-2'火神 
                                Else 
                                    arr(i,jj)=1
                                End If
                                
                        		                       		
                            Else
                                arr(i, jj) = -1
                            End If
                        Else 
                            arr(i,jj)=-1
                        End If
                    ElseIf 点6 = 1 Then'白	
                        If CmpColor(662 - 421 * i, 648 + 216 * j, "000617", 0.9) > -1 Then 
                            If 点11 = 1 Then
                            
                                arr(i, jj) = 8'经验35加成
                            Else 
                                arr(i, jj) = 7'经验30加成
                            End If
                        ElseIf CmpColor(649 - 421 * i, 667 + 216 * j, "02D8FF", 0.9) > -1 Then 
                            If 点11 = 1 Then 
                                TracePrint "点11白"
                                arr(i,jj)=7'30加成
                            Else 
                                arr(i,jj)=6'25加成
                            End If
                            
                        ElseIf CmpColor(661 - 421 * i, 669 + 216 * j, "02D8FF", 0.9) > -1 Then
                            if CmpColor(639 - 421 * i, 712 + 216 * j, "17DDFF", 0.9) > -1 Then
                                TracePrint "泡泡"
                                arr(i,jj)=9'泡泡
                            Else 
                                arr(i,jj)=-1'泡泡
                            End If
                        Else 
                            //                    	TracePrint "温蒂/森蚺"
                            //                    	If 清流 > 0 or 温蒂 > 1 Then 
                            //                    		arr(i, jj) = 5'温蒂
                            //                    	Else
                            TracePrint "温蒂"
                            arr(i, jj) = -5'温蒂
                            //                    	End If
                        
                        End if
                    End If
				
					
                End If
            ElseIf 点12 = 1 Then
                If CmpColor(670 - 421 * i, 656 + 216 * j, "010406", 0.9) > -1 Then 
                    //                    TracePrint "泡普卡/石棉"
                    arr(i, jj) = 6	'泡普卡/石棉
                elseIf CmpColor(663- 421 * i, 662+ 216 * j, "1A1D20", 0.9) > -1 and CmpColor(641- 421 * i, 650+ 216 * j, "0AD7FE", 0.9) >-1 Then 
            		
                    TracePrint "清流"
                    arr(i, jj) =-5    
                    
                elseIf CmpColor(661 - 421 * i, 649 + 216 * j, "01111E", 0.9) > -1  Then 
                    arr(i, jj) = 0
                    If CmpColor(649 - 421 * i, 664 + 216 * j, "000409", 0.9) > -1 Then 
                        //                        TracePrint "+10"
                        //                        If 红云 + 泡泡>=1 Then 
                        arr(i, jj) = 1
                        //                        End if
                    ElseIf CmpColor(651 - 421 * i, 728 + 216 * j, "03DAFF", 0.9) > -1 Then
                        TracePrint "水月"
                        arr(i, jj) = 7
                    ElseIf CmpColor(656 - 421 * i, 643 + 216 * j, "000001", 0.85) > -1 Then
                        TracePrint "贝娜"
                        arr(i,jj)=-3
                    End If
                   
                ElseIf CmpColor(654 - 421 * i, 750 + 216 * j, "FFFFFF", 0.9) > -1 Then
                    
                    If CmpColor(648 - 421 * i, 732 + 216 * j, "0BD7F8", 0.9) > -1 and CmpColor(668 - 421 * i, 716 + 216 * j, "00000F", 0.9) > -1 Then 
                        TracePrint "槐琥"
                        arr(i, jj) = 8
                    elseIf CmpColor(655 - 421 * i, 714 + 216 * j, "202020", 0.9) > -1 and CmpColor(668 - 421 * i, 716 + 216 * j, "02D8FF", 0.9) > -1 Then 
                        If CmpColor(640 - 421 * i, 649 + 216 * j, "000F0F", 0.9) > -1 Then 
                            TracePrint "稀音"
                            arr(i, jj) = -4
                        Else 
                            TracePrint "卡达"
                            arr(i, jj) = 1
                        	
                        End If
                        
                        
                      
                    Else 
                        TracePrint "2技能开"
                        arr(i, jj) = 4
                    End If
                    
            	
            	
            
                Else 
                    TracePrint "一圈白"
                    arr(i, jj) = 4	'
                End If
            ElseIf 点12 = -1 Then             
                If CmpColor(663- 421 * i, 662+ 216 * j, "1A1D20", 0.85) > -1 and CmpColor(641- 421 * i, 650+ 216 * j, "0AD7FE", 0.85) >-1 Then 
            		
                    TracePrint "清流"
                    arr(i, jj) = -5
                ElseIf 点5 = 0 Then
                    If CmpColor(676 - 421 * i, 717 + 216 * j, "F4FEFE", 0.85) > -1 and CmpColor(657 - 421 * i, 725 + 216 * j, "19E4F5", 0.85) > -1 Then 
                        TracePrint "迷迭香2"
                        arr(i, jj) = 5
                    Else 
                        TracePrint "111"
                        arr(i, jj) = 0
                    End If
                    
                End If
            End If
            TracePrint i&","&jj,点12,点5,点6,点11,arr(i, jj)
        Next
        If j mod 6 = 5 and jj<>17 Then 
            Call 基建干员翻页()
            KeepCapture
        End If
    
    Next
    Call 基建干员翻页左()
   
    
    识别干员=arr
End Function

Function 识别干员1()
    TracePrint "识别赤金干员"     
    Dim i,j ,jj   
    Dim arr(1,17)
    Dim 点12,点5,点6,点11
    KeepCapture 
    TracePrint "纵,横 12点 5点 6点 评级"
    For jj = 0 To 17
        j = jj mod 6
        If j = 0 Then 
            KeepCapture
        End If
    
        For i = 0 To 1
        
            点12 = CmpColor(679 - 421 * i, 661 + 216 * j, "3D3E3E|FEFFFF", 0.9)
            点5=CmpColor(630 - 421 * i, 666 + 216 * j, "626464|FEFFFF", 0.9)
            点6 = CmpColor(630 - 421 * i, 661 + 216 * j, "3D3E3E|FEFFFF", 0.85)
            点11=CmpColor(674 - 421 * i, 646 + 216 * j, "3D3E3E|FEFFFF", 0.85)
            //            TracePrint i,j,点12,点5,点6,点11
			
            
            arr(i, jj) = -1
            
            If 点12 = 0 Then '黑
                If 点5 = 0 Then 
                    If CmpColor(649 - 421 * i, 667 + 216 * j, "202020", 0.9) > -1 Then 
                        If CmpColor(639 - 421 * i, 712 + 216 * j, "0ED8FF", 0.9) > -1 Then 
                            TracePrint "红云"
                            arr(i,jj)=-5'红云
                        Elseif CmpColor(654 - 421 * i, 750 + 216 * j, "FFFFFF", 0.9) > -1 Then  
                            arr(i, jj) = -5
                            TracePrint "小刻"
                        End If
                        
                    Else 
                        //                        If 点6=-1 and CmpColor(646 - 421 * i, 662 + 216 * j, "13171A", 0.9) > -1 Then 
                        //            			
                        //                            //                            TracePrint "清流"
                        //                            arr(i, jj) =10
                        //                        Else 
                        //                        If 点6 = -1 Then
                        //                         
                        //
                        arr(i, jj) = 0
                        If CmpColor(649 - 421 * i, 667 + 216 * j, "02D8FF", 0.85) > -1 Then
                            arr(i, jj) = 3'15加成
                        Elseif CmpColor(662 - 421 * i, 648 + 216 * j, "000617", 0.9) > -1 Then 
                            arr(i, jj) = -5'exp25加成
                        Elseif CmpColor(637 - 421 * i, 662 + 216 * j, "002228", 0.9) > -1 Then 
                            TracePrint "刻师傅"
                            arr(i, jj) = -8
                        End If
                        
                    End If
                ElseIf 点5 = 1 Then
                    If 点6 = 0 Then'黑 
                    	
                        If CmpColor(647 - 421 * i, 663 + 216 * j, "0EE6FD", 0.85) > -1 Then
                        	
                            If CmpColor(234+421- 421 * i, 646 + 216 * j, "002229", 0.85) > -1 Then 
                        		
                                TracePrint "火神"
                        		 
                                arr(i, jj) = -2 '火神 
                        		                       		
                            ElseIf 点11 = 1 Then
                            
                                arr(i, jj) = 8'重金属35加成
                            Else 
                                arr(i, jj) = 7'重金属30加成
                            End If
                            //                      
                            //                        Else 
                            //                            arr(i, jj) = -1
                            //                            TracePrint "11"
                        End If
                    ElseIf 点6 = 1 Then'白	
                        If CmpColor(662 - 421 * i, 648 + 216 * j, "000617", 0.9) > -1 Then 
                            arr(i, jj) = -5'exp加成
                        ElseIf CmpColor(649 - 421 * i, 667 + 216 * j, "02D8FF", 0.85) > -1 Then 
                            If 点11 = 1 Then 
                                arr(i, jj)=7'30加成
                            Else 
                                arr(i, jj)=6'25加成
                            End If
                            
                        ElseIf CmpColor(661 - 421 * i, 669 + 216 * j, "02D8FF", 0.9) > -1 Then
                            if CmpColor(639 - 421 * i, 712 + 216 * j, "17DDFF", 0.9) > -1 Then
                                TracePrint "泡泡"
                                arr(i,jj)=9'泡泡
                            Else 
                                arr(i,jj)=-1'泡泡
                                
                            End If
                        Else 
                            //                    	TracePrint "温蒂/森蚺"
                            //                    	If 清流 > 0 or 温蒂 > 1 Then 
                            //                    		arr(i, jj) = 5'温蒂
                            //                    	Else 
                            arr(i, jj) = -3'温蒂
                            //                    	End If
                        
                        End if
                    End If
				
					
                End If
            ElseIf 点12 = 1 Then
                If CmpColor(670 - 421 * i, 656 + 216 * j, "010406", 0.9) > -1 Then 
                    TracePrint "泡普卡/石棉"
                    arr(i, jj) = 6	'泡普卡/石棉
                elseIf CmpColor(663- 421 * i, 662+ 216 * j, "1A1D20", 0.9) > -1 and CmpColor(641- 421 * i, 650+ 216 * j, "0AD7FE", 0.9) >-1 Then 
            		
                    //                    TracePrint "清流"
                    //                    arr(i, jj) = 10    
                    
                elseIf CmpColor(661 - 421 * i, 649 + 216 * j, "01111E", 0.9) > -1  Then 
                    arr(i, jj) = 0
                    
                    If CmpColor(649 - 421 * i, 664 + 216 * j, "000409", 0.9) > -1 Then 
                        //                        TracePrint "+10"
                        //                        If 红云 + 泡泡>=1 Then 
                        arr(i, jj) = 1
                        //                        End if
                    ElseIf CmpColor(651 - 421 * i, 728 + 216 * j, "03DAFF", 0.9) > -1 Then
                        TracePrint "水月"
                        arr(i, jj) = 7
                    ElseIf CmpColor(656 - 421 * i, 643 + 216 * j, "000001", 0.85) > -1 Then
                        TracePrint "贝娜"
                        arr(i,jj)=-4
                    End If
                   
                ElseIf CmpColor(654 - 421 * i, 750 + 216 * j, "FFFFFF", 0.9) > -1 Then
                    
                    If CmpColor(648 - 421 * i, 732 + 216 * j, "0BD7F8", 0.9) > -1 and CmpColor(668 - 421 * i, 716 + 216 * j, "00000F", 0.9) > -1 Then 
                        TracePrint "槐琥"
                        arr(i, jj) = 7
                    elseIf CmpColor(655 - 421 * i, 714 + 216 * j, "202020", 0.9) > -1 and CmpColor(668 - 421 * i, 716 + 216 * j, "02D8FF", 0.9) > -1 Then 
                        TracePrint "稀音"
                        arr(i, jj) = -5
                    Else 
                        TracePrint "2技能开"
                        arr(i, jj) = 4
                    End If
                    
            	
            	
            
                Else 
                    TracePrint "一圈白"
                    arr(i, jj) = 4	'
                End If
            ElseIf 点12 = -1 Then             
                If CmpColor(663- 421 * i, 662+ 216 * j, "1A1D20", 0.85) > -1 and CmpColor(641- 421 * i, 650+ 216 * j, "0AD7FE", 0.85) >-1 Then 
            		
                    TracePrint "清流"
                    arr(i, jj) = 10
                ElseIf 点5 = 0 Then
                    If CmpColor(676 - 421 * i, 717 + 216 * j, "F4FEFE", 0.85) > -1 and CmpColor(657 - 421 * i, 725 + 216 * j, "19E4F5", 0.85) > -1 Then 
                        TracePrint "迷迭香2"
                        arr(i, jj) = 5
                    Else 
                        arr(i, jj) = 0
                    End If
                    
                End If
            End If
            TracePrint i&","&jj,点12,点5,点6,点11,arr(i, jj)
        Next
        If j mod 6 = 5 and jj<>17 Then 
            Call 基建干员翻页()
        End If
    
    Next
    Call 基建干员翻页左()
    
    识别干员1=arr
End Function

Function 识别干员2()
    TracePrint "贸易站识别干员"
    Dim i,j
    Dim arr(1,5)
    Dim 点12,点5,点6,点11
    TracePrint "纵,横 评级"
   
    For jj = 0 To 17
        j = jj mod 6
        If j = 0 Then 
            KeepCapture
        End If
        For i = 0 To 1
            点12 = CmpColor(680 - 421 * i, 661 + 216 * j, "413F3C|FEFFFF", 0.85)
            点5=CmpColor(630 - 421 * i, 666 + 216 * j, "3D3E3E|FEFFFF", 0.9)
            点6 = CmpColor(630 - 421 * i, 661 + 216 * j, "3D3E3E|FEFFFF", 0.85)
            点11= CmpColor(677 - 421 * i, 650 + 216 * j, "3D3E3E|FEFFFF", 0.85)
            //                        TracePrint i,j,点12,点5,点6,点11
			
            
            arr(i, jj) = -1
            If 点11 = 1 Then 
                If 点12 = 0 and 点6=1 and 点5=1 Then 
                    arr(i, jj)=6'能天使
                    TracePrint "能天使2"
                ElseIf 点6 = 1 and CmpColor(643 - 421 * i, 662 + 216 * j, "B98E34", 0.85) > -1 and CmpColor(637 - 421 * i, 661 + 216 * j, "FFFFFF", 0.85) > -1 Then
                    arr(i, jj)=9'德狗
                    TracePrint "德狗"
                elseIf CmpColor(665 - 421 * i, 675 + 216 * j, "FFFFFF", 0.95) > -1 Then 
                    arr(i, jj)=-1'暗锁
                    TracePrint "暗锁"
                ElseIf 点6 = 0 Then
                    If CmpColor(652 - 421 * i, 677 + 216 * j, "FEFDE1", 0.9) > -1 Then
                        arr(i, jj)=-3'龙舌兰
                        TracePrint "龙舌兰2"
                    elseIf CmpColor(644 - 421 * i, 663 + 216 * j, "92620D", 0.85) > -1 Then 
                        arr(i, jj)=-2'拉狗
                        TracePrint "拉狗"
                    
                    elseIf CmpColor(647 - 421 * i, 657 + 216 * j, "FFFFFF", 0.85) > -1 Then 
                        arr(i, jj)=7'空弦
                        TracePrint "空弦2"
                    End If
                
                ElseIf 点6 = 1 and CmpColor(671 - 421 * i, 662 + 216 * j, "A87600", 0.85) > -1 Then
                    If CmpColor(663 - 421 * i, 710 + 216 * j, "202020", 0.85) > -1 Then 
                        arr(i, jj)=8'孑0
                        TracePrint "孑0"
                    Else 
                        arr(i, jj)=-1'孑1
                        TracePrint "孑1"
                    End If
                    
                    
                Else 
                    arr(i, jj)=3'
                    //            		TracePrint "圈白30加成"
                End If
            ElseIf 点5 = 1 Then
                If 点6 = 1 Then 
                    If CmpColor(658 - 421 * i, 668 + 216 * j, "92620D", 0.85) > -1 Then 
                        arr(i, jj)=3'30加成
                        //            			TracePrint "30加成"
                    Else 
                        arr(i, jj) = 2
                    End If
                    //            	Else
                    //            		TracePrint "11"
                elseIf 点6=0 and   CmpColor(652 - 421 * i, 677 + 216 * j, "FEFDE1", 0.9) > -1 Then
                    arr(i, jj)=-3'龙舌兰
                    TracePrint "龙舌兰2"    
                    
                End If
            ElseIf 点5 = -1 or 点5=0 Then 
                If 点11 = 0 Then 
                	
                    arr(i, jj) = 0
                    If CmpColor(663 - 421 * i, 710 + 216 * j, "FFFFF4", 0.85) > -1 Then 
                        arr(i, jj)=10'巫恋
                        TracePrint "巫恋"
                    elseIf CmpColor(669 - 421 * i, 659 + 216 * j, "F7F0E1", 0.85) > -1 and CmpColor(675 - 421 * i, 652 + 216 * j, "F9F9F4", 0.9) > -1 Then 
                        arr(i, jj)=-4'卡夫卡柏喙
                        TracePrint "卡夫卡柏喙2"	
                    elseIf CmpColor(669 - 421 * i, 659 + 216 * j, "F7F0E1", 0.85) > -1 Then 
                        arr(i, jj)=-5'卡夫卡柏喙
                        TracePrint "卡夫卡柏喙"
                    End If
                   
                Else 
                	
                    arr(i, jj) = 1
                    If CmpColor(669 - 421 * i, 659 + 216 * j, "F7F0E1", 0.85) > -1 Then 
                        arr(i, jj)=-4'卡夫卡柏喙2
                        TracePrint "卡夫卡柏喙2"
                    End If
                End If
            	
            End If
            //           
            TracePrint i&","&jj,点12,点5,点6,点11,arr(i, jj)
        Next
        If j mod 6 = 5 and jj<>17 Then 
            Call 基建干员翻页()
            KeepCapture
        End If
    
    Next
    Call 基建干员翻页左()
    识别干员2=arr
End Function

Function 识别干员3()'控制中枢
    TracePrint "控制中枢识别干员"
    Dim i,j,jj
    Dim arr(1,17)
    Dim 点12,点5,点6,点11
    //    TracePrint "纵,横 评级"
    KeepCapture 
    For jj = 0 To 17
        j = jj mod 6
        If j = 0 Then 
            KeepCapture
        End If
        For i = 0 To 1
        
            点12 = CmpColor(679 - 421 * i, 661 + 216 * j, "5A5A5A|FEFFFF", 0.9)
            //            点5=CmpColor(630 - 421 * i, 666 + 216 * j, "3D3E3E|FEFFFF", 0.9)
            //            点6 = CmpColor(630 - 421 * i, 661 + 216 * j, "3D3E3E|FEFFFF", 0.85)
            //            点11= CmpColor(677 - 421 * i, 650 + 216 * j, "3D3E3E|FEFFFF", 0.9)
            //                        TracePrint i,j,点12,点5,点6,点11
			
            
            arr(i, jj) = -1
            If 点12 = 1 Then 
                If CmpColor(680 - 421 * i, 724 + 216 * j, "3D3D3D", 0.9) > -1 and CmpColor(656 - 421 * i, 707 + 216 * j, "505800", 0.95) > -1 Then 
                    arr(i, jj) = -4
                    TracePrint "歌帝"
                ElseIf CmpColor(651 - 421 * i, 658 + 216 * j, "3B4B05", 0.95) > -1 Then
                    If CmpColor(642 - 421 * i, 672 + 216 * j, "F9F9EE", 0.9) > -1 Then 
                        arr(i, jj) = -2
                        TracePrint "阿"   
                    Else 
                        TracePrint "不识别"
                        arr(i, jj) = 1
                    End If
                    
                    //            		TracePrint "开心"
                ElseIf CmpColor(666 - 421 * i, 653 + 216 * j, "FFFFF5", 0.9) > -1 Then
                    If CmpColor(644 - 421 * i, 671 + 216 * j, "FFFFFF", 0.9) > -1 Then 
                        arr(i, jj) = 10
                        TracePrint "阿米娅"                    
                    End If
            		
                ElseIf CmpColor(644 - 421 * i, 660 + 216 * j, "FFFFFF", 0.9) > -1 Then
                    arr(i, jj) = 9
                    TracePrint "凯尔希"
                ElseIf CmpColor(666 - 421 * i, 653 + 216 * j, "4D5607", 0.9) > -1 Then
                    If CmpColor(666 - 421 * i, 657 + 216 * j, "505800", 0.9) > -1 Then 
                        If CmpColor(660 - 421 * i, 647 + 216 * j, "FFFFFF", 0.9) > -1 Then 
                            arr(i, jj) = 2
                            TracePrint "早露"
                        Else 
                            arr(i, jj) = -1
                            TracePrint "老鲤"
                        End If
                    	
                        
                    elseIf CmpColor(644 - 421 * i, 667 + 216 * j, "FFFFFF", 0.9) > -1 Then 
                        arr(i, jj) = 6
                        TracePrint "6号"
                    Else 
                        TracePrint "陈"
                    End If
                ElseIf CmpColor(657 - 421 * i, 649 + 216 * j, "FEFEFC", 0.9) > -1 Then
                    TracePrint "森蚺"
                    arr(i, jj) = 7
                End If
            ElseIf 点12 = 0 or (点12=-1 and 宽<>1080) Then
                If CmpColor(652 - 421 * i, 714 + 216 * j, "FFFFFF", 0.9) > -1 Then 
                    arr(i, jj) = 8
                    TracePrint "夕2" 
                End If
                //            Else 
                //                TracePrint "异格"
            End If    
            TracePrint i&","&jj,点12,arr(i, jj)
        Next
        If j mod 6 = 5 and jj<>17 Then 
            Call 基建干员翻页()
            KeepCapture
        End If
    
    Next
    Call 基建干员翻页左()
    识别干员3=arr
End Function

Function 识别干员4()'电厂
    TracePrint "发电站识别干员"
    Dim i,j
    Dim arr(1,5)
    Dim 点12,点5,点3,点11
    TracePrint "纵,横 评级"
    KeepCapture 
    For i = 0 To 1
        For j = 0 To 5
            //            点12 = CmpColor(679 - 421 * i, 661 + 216 * j, "5A5A5A|FEFFFF", 0.9)
            点5=CmpColor(630 - 421 * i, 666 + 216 * j, "3D3E3E|FEFFFF", 0.9)
            点3 = CmpColor(654 - 421 * i, 686 + 216 * j, "3D3E3E|FEFFFF", 0.85)
            点11= CmpColor(677 - 421 * i, 650 + 216 * j, "3D3E3E|FEFFFF", 0.9)
            //                        TracePrint i,j,点12,点5,点6,点11
			
            
            arr(i, j) = -1
            If 点11 = 1 Then 
                arr(i, j) = 4
            ElseIf 点5 = 1 Then
                If CmpColor(653 - 421 * i, 712 + 216 * j, "156A75", 0.9) > -1 and CmpColor(655 - 421 * i, 723 + 216 * j, "202020", 0.9) > -1 Then 
                    arr(i, j) = -3
                    TracePrint "清流"   
                Else 
                    arr(i, j) = 3
                End If
            	
            ElseIf 点3 = 1 Then
                If CmpColor(653 - 421 * i, 712 + 216 * j, "5B621E", 0.9) > -1 and CmpColor(566 - 421 * i, 690 + 216 * j, "F5F5F5", 0.9) > -1 Then 
                    If 森蚺中枢 = true Then 
                        arr(i, j) = 10
                    Else 
                        arr(i, j) = -2
                    End If
            		
                    TracePrint "L2"
                Else 
                    arr(i, j) = 2
                End If
            	
            
            End If    
            //            TracePrint i&","&j,点3,点5,点11,arr(i, j)
        Next
    Next
    识别干员4=arr
End Function

Function 识别干员5()'电厂
    TracePrint "办公室识别干员"
    Dim i,j
    Dim arr(1,5)
    Dim 点12,点9,点5,点3,点11
    TracePrint "纵,横 评级"
    KeepCapture 
    For i = 0 To 1
        For j = 0 To 5
            点12 = CmpColor(679 - 421 * i, 661 + 216 * j, "3D3D3D|FEFFFF", 0.9)
            点9 = CmpColor(654 - 421 * i, 637 + 216 * j, "5A5A5A|FEFFFF", 0.9)
            点5= CmpColor(630 - 421 * i, 666 + 216 * j, "3D3E3E|FEFFFF", 0.9)
            点3 = CmpColor(654 - 421 * i, 686 + 216 * j, "3D3E3E|FEFFFF", 0.85)
            点11= CmpColor(677 - 421 * i, 650 + 216 * j, "3D3E3E|FEFFFF", 0.9)
            //                        TracePrint i,j,点12,点5,点6,点11
			
            
            arr(i, j) = -1
            If 点12 = 0 and CmpColor(673 - 421 * i, 660 + 216 * j, "909090", 0.9)>-1 Then 
                If 点11 = 1 Then 
                    arr(i, j) = 9
                Elseif 点9=1 Then 
                    arr(i, j) = 8
                Elseif 点5=1 Then 
                    arr(i, j) = 7	
                Elseif 点3=1 Then 
                    arr(i, j) = 6
                Else            	
                    arr(i, j) = 5
                End If
            elseIf 点12 = 1 and CmpColor(673 - 421 * i, 660 + 216 * j, "909090", 0.9) > -1 Then 
                TracePrint "乌有"
            ElseIf 点9 = 0 Then
                If CmpColor(672 - 421 * i, 663 + 216 * j, "909090", 0.9) > -1 and  CmpColor(652 - 421 * i, 710 + 216 * j, "202020", 0.9) = -1 Then 
                    TracePrint "絮雨2"
                    If 迷迭香 = true Then 
                        arr(i, j) = 10
                    Else 
                        arr(i, j) = 1
                    End If
            		
                End If
            End If
                
            //            TracePrint i&","&j,点12,点3,点5,点9,点11,arr(i, j)
        Next
    Next
    识别干员5=arr
End Function

Sub 选tag()
    TracePrint "选tag"
    Dim result() ,re()
    
    result = rank()
    re=result(3)
    TracePrint zm.VarInfo(result)
    If result(0) > 5.5 Then 
        ShowMessage "有标签:" & tag(0) & "," & tag(1) & "," & tag(2) & "," & tag(3) & "," & tag(4) & "\n\n有资深标签,等待自己选择"
        点击 返回(0), 返回(1)
        delay 1500
    ElseIf result(0) = 4.2 Then
        ShowMessage "有标签:" & tag(0) &","& tag(1) &","& tag(2) &","& tag(3) &","& tag(4) & "\n\n赌小车"
        Delay 1000
        For 2
            点击 856, 680
            Delay 300
        Next
        For 5
            点击 860,917
            Delay 300
        Next
        For Each i In re
            If i>-1 Then 
                Tap tag位置(i * 2)/((宽/1080)^识别方式), tag位置(i * 2 + 1)/((高/1920)^识别方式)
                Delay 300
            End If    	
        Next
        点击 208,1459
        Delay 2500
    ElseIf result(0) < 4 Then
        If 判断(刷新标签) = true Then 
            ShowMessage "有标签:" & tag(0) &","& tag(1) &","& tag(2) &","& tag(3) &","& tag(4) & "\n\n无高级组合,刷新标签"
            点击 刷新标签(0), 刷新标签(1)
            Delay 1000
            点击 290, 1259
            Delay 3500
            zm.TableClear(result)
            Call 公招()
            Exit Sub
            
        ElseIf result(0) = 3 Then
            点击 631,670
            Delay 300
            ShowMessage "有标签:" & tag(0) &","& tag(1) &","& tag(2) &","& tag(3) &","& tag(4) & "\n\n无高级组合,选择三星"
            For Each i In re
                If i>-1 Then 
                    Tap tag位置(i * 2)/((宽/1080)^识别方式), tag位置(i * 2 + 1)/((高/1920)^识别方式)
                    Delay 300
                End If
    		
    	
            Next
            点击 208,1459
            Delay 2500
        Else 
            ShowMessage "有标签:" & tag(0) &","& tag(1) &","& tag(2) &","& tag(3) &","& tag(4) & "\n\ntag,欧皇出" & result(2)
            点击 631,670
            Delay 300
            For Each i In re
                If i>-1 Then 
                    Tap tag位置(i * 2)/((宽/1080)^识别方式), tag位置(i * 2 + 1)/((高/1920)^识别方式)
                    Delay 300
                End If
    		
    	
            Next
            点击 208,1459
            Delay 2500
        End If
    Else
        ShowMessage "有标签:" & tag(0) &","& tag(1) &","& tag(2) &","& tag(3) &","& tag(4) & "\n\n选择" & result(1) & "tag,有概率出" & result(2)
        点击 631,670
        Delay 300
        for Each i In re
            If i>-1 Then 
                Tap tag位置(i * 2)/((宽/1080)^识别方式), tag位置(i * 2 + 1)/((高/1920)^识别方式)
                Delay 300
            End If    	
        Next
        点击 208,1459
        Delay 2500
    End If    
End sub


Function rank()
    TracePrint "tag组合排序"
    Dim j,k
    Dim arr(),op(),num,arr1()
    Dim res,r()
    Dim n=0	
    
    For i = 0 To 4'5个标签
        If tag(i) = "高级资深干员" Then 
            TracePrint "资深",i
            r = {6, "高姿", "高姿", i}
            rank=r
            Exit function
        ElseIf tag(i) = "资深干员" Then
            TracePrint "高姿",i
            r = {5.9, "资深", "资深", i}
            rank=r
            Exit Function
        ElseIf tag(i) = "新手" Then
            TracePrint "新手",i
        Else 
            res=-1
            For Each 组合名 , 组合数组 In 保底["单tag"]		
                res=zm.ArraySearch(组合数组,tag(i))
                If res =1 Then 
                    TracePrint i,tag(i),组合数组(0),组合数组(2)	
                    arr(n) = 组合数组(0)
                    op = zm.ArrayInsert(op, Array(组合数组(0),组合名,组合数组(2),{i,-1,-1}))
                    n=n+1
                    Exit for 
                End If
            Next
            res=-1
            For Each 组合名 , 组合数组 In 保底["双tag"]
                res = zm.ArraySearch(组合数组, tag(i))
                If res = 1 Then 
                    //                	TracePrint UBound(tag)
                    j=zm.ArraySearch(tag, 组合数组(2))
                    If j > -1 Then 
                        TracePrint i,tag(i),j,tag(j),组合数组(0),组合数组(3)
                        arr(n) = 组合数组(0)        			
                        op = zm.ArrayInsert(op, Array(组合数组(0),组合名,组合数组(3),{i,j,-1}))
                        n=n+1
                    End If        	
                End If
            Next
            res=-1
            For Each 组合名 , 组合数组 In 保底["三tag"]
                res = zm.ArraySearch(组合数组, tag(i))
                If res = 1 Then 
                    j = zm.ArraySearch(tag, 组合数组(2))
                    k=zm.ArraySearch(tag, 组合数组(3))
                    If j > -1 and k > -1 Then 
                        TracePrint i,tag(i),j,tag(j),k,tag(k),组合数组(0),组合数组(4)
                        arr(n) = 组合数组(0)
                        op = zm.ArrayInsert(op, Array(组合数组(0),组合名,组合数组(4),{i,j,k}))
                        n=n+1
                    End If        	
                End If
            Next
        End If
    Next
    If arr(0) <> null Then 
        arr1 = Clone(arr)
        zm.ArraySort(arr,true)
        r = op(zm.arraysearch(arr1, arr(0)))
    Else 
        r={3,"三星","三星",{1,-1,-1}}
    End If
    rank=r
End Function


/////////////////////////////////////////////////
Sub 点击(a, b)
    dim x=a+5 * Rnd() -5
    dim y=b+5 * Rnd() -5
    TouchDown x,y,0
    Delay 75+Int(((20) * Rnd()) + 1)
    TouchUp 0
End Sub

Function del(table, b)
    Dim arr()
    For Each i , j In table
        If i <> b Then 
            arr[i]=j 
        End If		
    Next
    del=arr
End Function

Function isIn(table, b)
    isIn = False
    If table = null Then 
	
    Else 
        For Each i,j In table
            If b = i Then 
                isIn = true
                Exit For
            End If
        Next
    End If
	
End Function

Function 判断(数组)
    判断=False
    Dim arr()
    arr = 数组
    If IsNumeric(arr(2))= True Then     
        If InStr(1,Join(arr,","),"|") > 1 Then
            findMultiColor (arr(0), arr(1), arr(2), arr(3), arr(4), arr(5), 1,0.9,intX,intY)
            If intX > 0 Then 
                判断=true
            End If
        Else'否则为范围查找单色
            If FindColor(arr(0), arr(1), arr(2), arr(3), arr(4), 1, 0.9, intX, intY) = 1 Then 
                判断 = true
           	
            End If            
        End If
    ElseIf IsNumeric(arr(1))=True Then'数组特征第二个值为数字则为固定多点比色
        If CmpColorEx(arr(2), 0.9) = 1 Then 
            判断=true
        End If
    Else
        TracePrint "数组异常：" & Join(arr,"|")
    End If
End Function

Function 等待(数组, 搜索间隔, 超出次数,是否点击)
    Dim i
    i = 0
    等待=False
    dim res = False
    
    Do
        KeepCapture 
        If IsArray(数组(0)) = false Then 
            If 判断(数组)=true Then 
                等待 = true
                等待错误=0
                TracePrint "true,"&数组(3)
                If 是否点击 = true Then 
                    Delay 1000
                    点击 (数组(0), 数组(1))
                End If
                Exit Do		
            End If
        ElseIf IsArray(数组(0)) = true Then
            '判断多个
            等待数组=-1
            For Each ii In 数组
                等待数组=等待数组+1
                If 判断(ii) = true Then 
                    等待 = true
                    等待错误=0
                    TracePrint "true,"&ii(3)
                    If 是否点击 = true Then 
                        Delay 1000
                        点击 (ii(0), ii(1))
                    End If
                    Exit Do
                End If
            Next
        End If
        If res = False Then 
            Delay 搜索间隔
        End If
        i = i + 1
        If i > 超出次数 Then 
            //            TracePrint "false,"&数组(3)
            等待错误 = 等待错误 + 1
            TracePrint "等待错误积累次数"&等待错误
            If IsArray(数组(0)) = false Then 
                TracePrint "等待错误"&数组(3)
            End if
            If 等待错误 > 20 Then 
                TracePrint "连续等待界面出错,停止脚本"
                If IsArray(数组(0)) = false Then 
                    TracePrint 数组(3)
                    发送QQ通知 ("连续等待界面出错,停止脚本"&数组(3),false,0,0,0,0)
                end if 
                
                //                SnapShot "/sdcard/进入"&数组(3)&"错误.png"
                EndScript
            End If
            Exit Do 
        End If
        ReleaseCapture
    Loop
    Delay 1000
End Function

Function 字符串转数组(text,分隔符)
    Dim tex= text
    Dim arr()
    dim i,n,m	
    i = 0	
    n = 0
    m = InStr(n + 1, tex, 分隔符)
    //    TracePrint m
    If m <> null Then 
        If m = 0 Then 
            arr(i)=tex
        Else 
            Do
                m = InStr(n + 1, tex, 分隔符)
                If m = 0 Then 
                    arr(i) = Mid(tex, n + 1, Len(tex))
                Else
                    arr(i) = Mid(tex, n + 1, m - n - 1)
                End If        
                
                i = i + 1		
                n=m
            Loop Until  m=0	
    
        End If
    End If
    
    字符串转数组=arr	
End Function

Function 字符串去重(a)
    Dim 源字符串=a
    Dim 长度= UTF8.Len(源字符串)
    Dim 裁剪字符串,当前字符,结果字符串
    For i = 1 To 长度
        当前字符 = UTF8.StrGetAt(源字符串, i)
        //		TracePrint i,当前字符
        If UTF8.InStr(1, 源字符串, 当前字符) = i Then 
            结果字符串=结果字符串&当前字符
        End If
    Next
    //	TracePrint 结果字符串
    字符串去重=结果字符串
	
End Function

Function 计算变换矩阵(点)
    Dim 消元
    Dim A(7,8)
    Dim x(7)
    Dim freex(7)
    Dim equ=7
    Dim var=7
    dim max_r
    Dim temp,z()
    //Dim 点(3)
    //点(0)=array(265,637,275,804)
    //点(1)=array(858,709,806,844)
    //点(2)=array(858,1462,893,1552)
    //点(3)=array(265,1593,336,1701)

    For j = 0 To 3
        A(j,2) = 1
        z = 点(j)
        A(j,8)=z(2)
        For i = 0 To 1
            A(j,i)=z(i)
        Next
        For i = 3 To 5
            A(j,i)=0
        Next
        For i = 6 To 7
            A(j,i)=-A(j,i-6)*A(j,8)
        Next
    Next
    For j = 4 To 7
        A(j, 5) = 1
        z = 点(j - 4)
        A(j,8) = z(3)
        For i = 0 To 2
            A(j,i)=0
        Next
        For i = 3 To 4
            A(j,i)=z(i-3)
        Next
        For i = 6 To 7
            A(j,i)=-A(j,i-3)*A(j,8)
        Next
    Next
    //输出a 
    Import "zm.luae"


    For i = 0 To 7
        For j = 0 To 8
            a(i,j)=cdbl(a(i,j))
        Next
        x(i)=cdbl(x(i))
    Next

    'double A[][9], int equ, int var, double* ans) { //epu:A's row  var:A's col-1

    Dim xxx,yyy
    //初始化
    For i = 0 To var
        x(i) = 0
        freex(i)=true
    Next
    //转换为阶梯阵
    For col = 0 To var//当前处理的列
        //	TracePrint "处理第",col,"列"
        For row = col To equ//当前处理的行		
            max_r = row//当前列绝对值最大的行
            For i = row + 1 To equ//寻找当前列绝对值最大的行
                //            TracePrint i,col,A(i,col),max_r,col,A(max_r,col)
                If abs(A(i,col))>abs(A(max_r,col)) then
                    max_r = i                
                End If
            Next
            //        输出a         
            If max_r <> row Then //与第row行交换
                //    		TracePrint "交换行",max_r,row
                For j = 0 To var + 1
                    xxx =CDbl(A(row,j))
                    yyy =CDbl(A(max_r,j))
                    A(max_r, j) = xxx
                    A(row,j)=yyy
                    //                TracePrint A(row,j),A(max_r, j),xxx
                Next           	
        
                //        输出a 
            End If	
            For i= row + 1 To equ//枚举要消元的行
                //        	TracePrint i,col,A(i,col)
                If Abs(A(i, col)) > 10 ^ -17 Then 
                    //             	TracePrint "第",i,"行消元"
                    消元=true
                    temp = CDBL(A(i, col) / A(row, col))
                    //                TracePrint temp
                    For j = col To var + 1
                        A(i, j) = a(i, j) - a(row, j) * temp
                        //                    TracePrint i, j,a(i, j)
                    Next
                    a(i,col)=0
                    //			
                End If 
            Next
            //        If 消元 = true Then 
            //        	输出a	
            //        	消元 = false
            //        			
            //        End If
      	
        Next
    Next
    //    输出a
    For i = var To 0 Step -1
        temp = CDBL( A(i, var+1))
        //    	TracePrint i,var,temp
        For j = i + 1 To var
            //    		TracePrint i,j,A(i,j)
            temp=temp-A(i,j)*x(j)
        Next
        x(i) = temp / A(i, i)
    	
    Next
    //    zm.TracePrint "_5760",x
    计算变换矩阵=x
End Function

Function 计算变换坐标(x, y,c)
    Dim x1,y1,z
    x1=cint((x*c(0)+y*c(1)+c(2))/(x*c(6)+y*c(7)+1))
    y1=cint((x*c(3)+y*c(4)+c(5))/(x*c(6)+y*c(7)+1))
    计算变换坐标=array(x1,y1)
End Function

Function 发送QQ通知(通知内容, 是否截图,x1,y1,x2,y2)
    Dim postdata
    Dim b64
    If QQ通知 = true Then 
        If 是否截图 = true Then 
            SnapShot (临时目录 & "QQ.png",x1,y1,x2,y2)'截图过大post失败
            //b64 = ShanHai.ReadFileBase  (临时目录 & "QQ.png")
            b64 = zm.FileReadBinaryBase64(临时目录 & "QQ.png")
            b64 = zm.EncodeURL(b64)
            postdata = "to=" & QQ通知QQ & "&info=" & 通知内容 & "&image=" & b64
        Else 
            postdata = "to=" & QQ通知QQ & "&info=" & 通知内容
        End If
        zm.HttpPost(QQ通知服务器, postdata)
        TracePrint postdata
    End If
End Function
